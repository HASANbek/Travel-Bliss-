<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="pageTitle">Tour Details - Travel Bliss</title>
    <link rel="icon" href="assets/img/fav-icon.svg" type="image/svg+xml">

    <!-- CSS Files -->
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="assets/css/boxicons.min.css">
    <link rel="stylesheet" href="assets/css/swiper-bundle.min.css">
    <link rel="stylesheet" href="assets/css/slick.css">
    <link rel="stylesheet" href="assets/css/animate.min.css">
    <link rel="stylesheet" href="assets/css/jquery.fancybox.min.css">
    <link rel="stylesheet" href="assets/css/daterangepicker.css">
    <link rel="stylesheet" href="assets/css/jquery-ui.css">
    <link rel="stylesheet" href="assets/css/style.css">

    <style>
        .tour-details-banner {
            height: 550px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .tour-details-banner::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(to bottom, rgba(0,0,0,0.3) 0%, rgba(0,0,0,0.5) 100%);
            z-index: 1;
        }

        .tour-details-content {
            position: relative;
            z-index: 2;
            text-align: center;
        }

        .tour-badge {
            display: inline-block;
            padding: 8px 20px;
            background: rgba(255,255,255,0.2);
            border-radius: 30px;
            margin-bottom: 15px;
            backdrop-filter: blur(10px);
        }

        .tour-price {
            font-size: 48px;
            font-weight: 700;
            margin: 20px 0;
        }

        .tour-meta {
            display: flex;
            gap: 30px;
            justify-content: center;
            margin-top: 20px;
        }

        .tour-meta-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .itinerary-item {
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            margin-bottom: 15px;
            overflow: hidden;
            transition: all 0.3s;
        }

        .itinerary-item:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .itinerary-header {
            padding: 20px 25px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: #f9fafb;
            transition: all 0.3s;
        }

        .itinerary-header:hover {
            background: #f3f4f6;
        }

        .itinerary-header.active {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.05) 0%, rgba(139, 92, 246, 0.05) 100%);
        }

        .itinerary-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
            padding: 0 25px;
        }

        .itinerary-content.active {
            max-height: 1000px;
            padding: 20px 25px;
        }

        .expand-icon {
            transition: transform 0.3s ease;
            flex-shrink: 0;
        }

        .expand-icon.rotated {
            transform: rotate(180deg);
        }

        #expandAllIcon.rotated {
            transform: rotate(180deg);
        }

        #expandAllBtn:hover {
            background: #6366f1;
            color: white;
        }

        #expandAllBtn:hover svg {
            stroke: white;
        }

        .day-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 50%;
            font-weight: bold;
            font-size: 18px;
            margin-right: 15px;
        }

        .included-list, .excluded-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .included-list li, .excluded-list li {
            padding: 12px 0;
            display: flex;
            align-items: flex-start;
            gap: 12px;
            color: #4b5563;
            line-height: 1.6;
        }

        .included-list li:before {
            content: '';
            width: 20px;
            height: 20px;
            background-image: url("data:image/svg+xml,%3Csvg width='20' height='20' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Ccircle cx='12' cy='12' r='10' fill='%233b82f6'/%3E%3Cpath d='M8 12l2 2 4-4' stroke='white' stroke-width='2.5' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
            background-size: contain;
            flex-shrink: 0;
            margin-top: 2px;
        }

        .excluded-list li:before {
            content: '';
            width: 20px;
            height: 20px;
            background-image: url("data:image/svg+xml,%3Csvg width='20' height='20' viewBox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Ccircle cx='12' cy='12' r='10' fill='%23ef4444'/%3E%3Cpath d='M9 9l6 6M15 9l-6 6' stroke='white' stroke-width='2.5' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
            background-size: contain;
            flex-shrink: 0;
            margin-top: 2px;
        }

        .brochure-download-btn {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 15px 35px;
            border-radius: 50px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.4);
        }

        .brochure-download-btn:hover {
            background: #2563eb;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.6);
        }

        .brochure-download-btn:active {
            transform: translateY(0);
        }

        .brochure-download-btn-compact:hover {
            background: #2563eb !important;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.6) !important;
        }

        .brochure-download-btn-compact:active {
            transform: translateY(0) !important;
        }

        @media (max-width: 768px) {
            .tour-details-banner {
                height: 400px;
            }

            .tour-details-banner h1 {
                font-size: 32px !important;
            }

            .tour-details-banner .tour-meta {
                gap: 15px;
                flex-wrap: wrap;
                justify-content: center;
            }

            .tour-details-banner .tour-meta-item span {
                font-size: 14px;
            }

            .tour-details-banner div[style*="padding: 8px 20px"] {
                padding: 6px 15px !important;
            }

            .tour-details-banner div[style*="padding: 8px 20px"] span:nth-child(1) {
                font-size: 14px !important;
            }

            .tour-details-banner div[style*="padding: 8px 20px"] span:nth-child(2) {
                font-size: 22px !important;
            }

            .tour-details-banner div[style*="padding: 8px 20px"] span:nth-child(3) {
                font-size: 14px !important;
            }

            .brochure-banner {
                height: auto !important;
                padding: 30px 20px !important;
            }

            .brochure-banner > div:last-child {
                flex-direction: column !important;
                gap: 20px;
                text-align: center;
            }

            .brochure-banner h3 {
                font-size: 24px !important;
            }

            .brochure-banner p {
                font-size: 28px !important;
            }

            .brochure-banner-compact {
                padding: 15px 20px !important;
            }

            .brochure-banner-compact > div:last-child {
                flex-direction: column !important;
                gap: 15px !important;
                text-align: center;
            }

            .brochure-banner-compact h3 {
                font-size: 16px !important;
            }

            .brochure-banner-compact p {
                font-size: 12px !important;
            }

            .brochure-download-btn-compact {
                width: 100%;
                justify-content: center !important;
            }

            .location-nav-btn {
                display: none !important;
            }

            .location-card {
                min-width: 250px;
            }

            #reviewsSection .col-lg-8 {
                padding-left: 15px !important;
                margin-top: 20px;
            }
        }

        #locationsContainer::-webkit-scrollbar {
            display: none;
        }

        .location-card {
            min-width: 280px;
            border-radius: 16px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .location-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
        }

        .location-card:active {
            transform: translateY(-2px) scale(0.98);
            box-shadow: 0 4px 12px rgba(0,0,0,0.12);
        }

        .location-card-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }

        .location-card-content {
            padding: 20px;
            background: white;
            text-align: center;
        }

        .location-card-title {
            font-size: 18px;
            font-weight: 700;
            color: #1f2937;
            margin: 0 0 8px 0;
        }

        .location-card-duration {
            font-size: 14px;
            color: #6b7280;
            margin: 0;
        }

        .location-nav-btn:hover {
            background: #f3f4f6 !important;
            transform: translateY(-50%) scale(1.1) !important;
        }

        .review-btn {
            background: transparent;
            border: 2px solid #3b82f6;
            color: #3b82f6;
            padding: 12px 28px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 15px;
        }

        .review-btn:hover {
            background: #3b82f6;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }

        .booking-box {
            position: sticky;
            top: 100px;
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        .book-now-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .book-now-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .section-title {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 30px;
            color: #1f2937;
        }

        .highlight-card {
            background: #f9fafb;
            border-left: 4px solid #3b82f6;
            padding: 18px 20px;
            margin-bottom: 12px;
            border-radius: 8px;
            display: flex;
            align-items: flex-start;
            gap: 15px;
            line-height: 1.6;
            transition: all 0.2s;
        }

        .highlight-card:hover {
            background: #f3f4f6;
            border-left-color: #2563eb;
        }

        /* Modern Menu Styling - Consistent Background Color */
        .header-area .main-menu .menu-list > li > a {
            background: transparent !important;
            color: #1f2937 !important;
            padding: 8px 18px !important;
            border-radius: 8px !important;
            transition: all 0.3s ease !important;
            font-weight: 500 !important;
        }

        .header-area .main-menu .menu-list > li > a:hover,
        .header-area .main-menu .menu-list > li.active > a {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%) !important;
            color: white !important;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
        }

        /* Active menu item - Home */
        .header-area .main-menu .menu-list > li:first-child > a {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%) !important;
            color: white !important;
        }

        /* Hide search icon and sign in button */
        .header-area .search-btn,
        .header-area .eg-btn,
        .header-area .primary-btn1:not(.mobile-menu-btn),
        .header-area a[href*="sign"],
        .header-area a[href*="login"],
        .nav-right .eg-btn,
        .nav-right .primary-btn1,
        .sidebar-button:not(.mobile-menu-btn) {
            display: none !important;
        }

        /* Mobile menu contact area should be visible only on mobile */
        @media (max-width: 1199px) {
            .header-area .main-menu .contact-area {
                display: flex !important;
            }

            /* Modern mobile menu styling */
            .main-menu {
                background: white;
                padding: 20px;
            }

            .main-menu .menu-list {
                flex-direction: column !important;
                gap: 0 !important;
                padding: 20px 0 !important;
            }

            .main-menu .menu-list > li {
                width: 100% !important;
                border-bottom: 1px solid #f3f4f6;
            }

            .main-menu .menu-list > li:last-child {
                border-bottom: none;
            }

            .main-menu .menu-list > li > a {
                display: block !important;
                width: 100% !important;
                padding: 16px 20px !important;
                font-size: 16px !important;
                font-weight: 600 !important;
                color: #1f2937 !important;
                background: transparent !important;
                border-radius: 0 !important;
                text-align: left !important;
                position: relative;
                transition: all 0.3s ease;
            }

            .main-menu .menu-list > li > a:hover,
            .main-menu .menu-list > li.active > a {
                background: linear-gradient(90deg, rgba(99, 102, 241, 0.1) 0%, transparent 100%) !important;
                color: #6366f1 !important;
                padding-left: 30px !important;
                transform: none !important;
                box-shadow: none !important;
            }

            .main-menu .menu-list > li > a:before {
                content: '';
                position: absolute;
                left: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 0;
                height: 100%;
                background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
                transition: width 0.3s ease;
            }

            .main-menu .menu-list > li > a:hover:before,
            .main-menu .menu-list > li.active > a:before {
                width: 4px;
            }

            /* Contact area in mobile */
            .main-menu .contact-area {
                border-top: 2px solid #f3f4f6;
                border-bottom: 2px solid #f3f4f6;
                padding: 20px 0 !important;
                margin: 10px 0 !important;
                background: linear-gradient(135deg, rgba(99, 102, 241, 0.05) 0%, rgba(139, 92, 246, 0.05) 100%);
                border-radius: 12px;
            }

            .main-menu .contact-area > div:first-child {
                margin-bottom: 15px !important;
            }

            .main-menu .contact-area a[href^="tel"] {
                font-size: 18px !important;
                color: #6366f1 !important;
                font-weight: 700 !important;
            }

            /* Mobile dropdown for category menu */
            .main-menu .has-dropdown {
                position: relative;
            }

            .main-menu .submenu {
                list-style: none;
                padding-left: 20px !important;
                margin: 0;
                display: none;
                background: rgba(99, 102, 241, 0.05);
                border-left: 3px solid #6366f1;
            }

            .main-menu .has-dropdown.open .submenu {
                display: block;
            }

            .main-menu .submenu li {
                border-bottom: 1px solid rgba(99, 102, 241, 0.1);
            }

            .main-menu .submenu li:last-child {
                border-bottom: none;
            }

            .main-menu .submenu li a {
                padding: 12px 15px !important;
                font-size: 14px !important;
                font-weight: 300 !important;
                color: #4b5563 !important;
            }

            .main-menu .submenu li a:hover {
                color: #6366f1 !important;
                background: rgba(99, 102, 241, 0.1) !important;
                padding-left: 25px !important;
            }
        }

        /* Desktop dropdown for category menu */
        @media (min-width: 1200px) {
            .header-area .menu-list .has-dropdown {
                position: relative;
            }

            .header-area .menu-list .submenu {
                position: absolute;
                top: 100%;
                left: 0;
                min-width: 420px;
                background: #f5f1e8;
                padding: 15px 0;
                margin-top: 10px;
                list-style: none;
                opacity: 0;
                visibility: hidden;
                transform: translateY(-10px);
                transition: all 0.3s ease;
                z-index: 1000;
            }

            .header-area .menu-list .has-dropdown:hover .submenu {
                opacity: 1;
                visibility: visible;
                transform: translateY(0);
            }

            .header-area .menu-list .submenu li {
                border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            }

            .header-area .menu-list .submenu li:last-child {
                border-bottom: none;
            }

            .header-area .menu-list .submenu li a {
                display: block;
                padding: 12px 25px;
                color: #333333;
                font-size: 15px;
                font-weight: 300;
                transition: color 0.2s;
                text-decoration: none;
            }

            .header-area .menu-list .submenu li a:hover {
                color: #000000;
            }
        }

        /* Tour Package Cards - Fixed Design */
        .package-card {
            height: 100%;
            display: flex;
            flex-direction: column;
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
        }

        .package-card:hover {
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
            transform: translateY(-4px);
        }

        .package-img-wrap {
            position: relative;
            width: 100%;
            height: 280px;
            overflow: hidden;
        }

        .package-img {
            display: block;
            width: 100%;
            height: 100%;
        }

        .package-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center;
        }

        .package-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 20px;
        }

        .package-content h5 {
            margin-bottom: 12px;
            min-height: 50px;
        }

        .location-and-time {
            margin-bottom: auto;
        }

        .btn-and-price-area {
            margin-top: 15px;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header-area style-2 travel-agency3">
        <div class="container-fluid d-flex flex-nowrap align-items-center justify-content-between">
            <div class="logo-and-menu-area">
                <a href="travel-agency-03.html" class="header-logo">
                    <img src="assets/img/travel-bliss-logo.png" alt="Travel Bliss" style="height: 45px; width: auto; max-width: 200px; object-fit: contain;">
                </a>
                <div class="main-menu">
                    <div class="mobile-logo-area d-xl-none d-flex align-items-center justify-content-between">
                        <a href="travel-agency-03.html" class="mobile-logo-wrap">
                            <img src="assets/img/travel-bliss-logo.png" alt="Travel Bliss" style="height: 40px;">
                        </a>
                        <div class="menu-close-btn">
                            <i class="bi bi-x"></i>
                        </div>
                    </div>
                    <ul class="menu-list">
                        <li>
                            <a href="travel-agency-03.html">Home</a>
                        </li>
                        <li>
                            <a href="about.html">About</a>
                        </li>
                        <li>
                            <a href="contact.html">Contact Us</a>
                        </li>
                    </ul>
                    <div class="contact-area d-xl-none d-flex" style="gap: 15px; align-items: center; flex-direction: column; padding: 15px 0;">
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <div class="icon">
                                <svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
                                    <g>
                                        <path d="M15.5646 11.7424L13.3317 9.50954C12.5343 8.7121 11.1786 9.03111 10.8596 10.0678C10.6204 10.7855 9.82296 11.1842 9.10526 11.0247C7.51037 10.626 5.35726 8.55261 4.95854 6.87797C4.71931 6.16024 5.19778 5.36279 5.91548 5.12359C6.95216 4.80461 7.27113 3.44895 6.47369 2.65151L4.24084 0.418659C3.60288 -0.139553 2.64595 -0.139553 2.08774 0.418659L0.572591 1.93381C-0.942555 3.5287 0.73208 7.75516 4.48007 11.5032C8.22807 15.2512 12.4545 17.0056 14.0494 15.4106L15.5646 13.8955C16.1228 13.2575 16.1228 12.3006 15.5646 11.7424Z"/>
                                    </g>
                                </svg>
                            </div>
                            <a href="tel:998901234567" style="color: #1f2937; font-weight: 600; text-decoration: none; font-size: 16px;">+998 90 123 45 67</a>
                        </div>
                        <div class="language-selector-mobile" style="position: relative; width: 100%;">
                            <button class="language-btn-mobile" style="background: transparent; border: 1px solid #e5e7eb; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; font-weight: 600; color: #1f2937; padding: 10px 20px; border-radius: 8px; transition: all 0.3s; width: 100%;">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <circle cx="12" cy="12" r="10"></circle>
                                    <line x1="2" y1="12" x2="22" y2="12"></line>
                                    <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
                                </svg>
                                <span id="currentLangMobile">English</span>
                                <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="6 9 12 15 18 9"></polyline>
                                </svg>
                            </button>
                            <div class="language-dropdown-mobile" style="display: none; position: absolute; top: 100%; left: 0; right: 0; background: white; border: 1px solid #e5e7eb; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); margin-top: 5px; z-index: 1000;">
                                <a href="#" class="lang-option-mobile" data-lang="English" style="display: block; padding: 12px 15px; color: #1f2937; text-decoration: none; transition: all 0.2s; border-bottom: 1px solid #f3f4f6;">English</a>
                                <a href="#" class="lang-option-mobile" data-lang="O'zbekcha" style="display: block; padding: 12px 15px; color: #1f2937; text-decoration: none; transition: all 0.2s; border-bottom: 1px solid #f3f4f6;">O'zbekcha</a>
                                <a href="#" class="lang-option-mobile" data-lang="Русский" style="display: block; padding: 12px 15px; color: #1f2937; text-decoration: none; transition: all 0.2s;">Русский</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="nav-right">
                <div class="contact-and-search-area">
                    <div class="contact-area d-xl-flex d-none" style="gap: 20px; align-items: center;">
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <div class="icon">
                                <svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
                                    <g>
                                        <path d="M15.5646 11.7424L13.3317 9.50954C12.5343 8.7121 11.1786 9.03111 10.8596 10.0678C10.6204 10.7855 9.82296 11.1842 9.10526 11.0247C7.51037 10.626 5.35726 8.55261 4.95854 6.87797C4.71931 6.16024 5.19778 5.36279 5.91548 5.12359C6.95216 4.80461 7.27113 3.44895 6.47369 2.65151L4.24084 0.418659C3.60288 -0.139553 2.64595 -0.139553 2.08774 0.418659L0.572591 1.93381C-0.942555 3.5287 0.73208 7.75516 4.48007 11.5032C8.22807 15.2512 12.4545 17.0056 14.0494 15.4106L15.5646 13.8955C16.1228 13.2575 16.1228 12.3006 15.5646 11.7424Z"/>
                                    </g>
                                </svg>
                            </div>
                            <a href="tel:998901234567" style="color: #1f2937; font-weight: 600; text-decoration: none;">+998 90 123 45 67</a>
                        </div>
                        <div class="language-selector" style="position: relative;">
                            <button class="language-btn" style="background: transparent; border: none; cursor: pointer; display: flex; align-items: center; gap: 5px; font-weight: 600; color: #1f2937; padding: 5px 10px; border-radius: 6px; transition: all 0.3s;">
                                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50 30'%3E%3Cdefs%3E%3CclipPath id='a'%3E%3Crect width='50' height='30'/%3E%3C/clipPath%3E%3C/defs%3E%3Cg clip-path='url(%23a)'%3E%3Crect width='50' height='30' fill='%23012169'/%3E%3Cpath d='M0,0 L50,30 M50,0 L0,30' stroke='%23FFF' stroke-width='6'/%3E%3Cpath d='M0,0 L50,30 M50,0 L0,30' stroke='%23C8102E' stroke-width='4' clip-path='url(%23a)'/%3E%3Cpath d='M25,0 V30 M0,15 H50' stroke='%23FFF' stroke-width='10'/%3E%3Cpath d='M25,0 V30 M0,15 H50' stroke='%23C8102E' stroke-width='6'/%3E%3C/g%3E%3C/svg%3E" alt="UK Flag" width="24" height="16" style="border-radius: 2px; border: 1px solid rgba(0,0,0,0.1);">
                                <span id="currentLang">EN</span>
                                <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="6 9 12 15 18 9"></polyline>
                                </svg>
                            </button>
                            <div class="language-dropdown" style="display: none; position: absolute; top: 100%; right: 0; background: white; border: 1px solid #e5e7eb; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); margin-top: 5px; width: max-content; z-index: 1000;">
                                <a href="#" class="lang-option" data-lang="EN" style="display: flex; align-items: center; gap: 8px; padding: 8px 12px; color: #1f2937; text-decoration: none; transition: all 0.2s;">
                                    <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50 30'%3E%3Cdefs%3E%3CclipPath id='a'%3E%3Crect width='50' height='30'/%3E%3C/clipPath%3E%3C/defs%3E%3Cg clip-path='url(%23a)'%3E%3Crect width='50' height='30' fill='%23012169'/%3E%3Cpath d='M0,0 L50,30 M50,0 L0,30' stroke='%23FFF' stroke-width='6'/%3E%3Cpath d='M0,0 L50,30 M50,0 L0,30' stroke='%23C8102E' stroke-width='4' clip-path='url(%23a)'/%3E%3Cpath d='M25,0 V30 M0,15 H50' stroke='%23FFF' stroke-width='10'/%3E%3Cpath d='M25,0 V30 M0,15 H50' stroke='%23C8102E' stroke-width='6'/%3E%3C/g%3E%3C/svg%3E" alt="UK" width="24" height="16" style="border-radius: 2px; border: 1px solid rgba(0,0,0,0.1);">
                                    <span>English</span>
                                </a>
                                <a href="#" class="lang-option" data-lang="IT" style="display: flex; align-items: center; gap: 8px; padding: 8px 12px; color: #1f2937; text-decoration: none; transition: all 0.2s;">
                                    <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 3 2'%3E%3Crect width='1' height='2' fill='%23009246'/%3E%3Crect x='1' width='1' height='2' fill='%23fff'/%3E%3Crect x='2' width='1' height='2' fill='%23ce2b37'/%3E%3C/svg%3E" alt="Italy" width="24" height="16" style="border-radius: 2px;">
                                    <span>Italiano</span>
                                </a>
                                <a href="#" class="lang-option" data-lang="FR" style="display: flex; align-items: center; gap: 8px; padding: 8px 12px; color: #1f2937; text-decoration: none; transition: all 0.2s;">
                                    <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 3 2'%3E%3Crect width='1' height='2' fill='%23002395'/%3E%3Crect x='1' width='1' height='2' fill='%23fff'/%3E%3Crect x='2' width='1' height='2' fill='%23ED2939'/%3E%3C/svg%3E" alt="France" width="24" height="16" style="border-radius: 2px;">
                                    <span>Français</span>
                                </a>
                                <a href="#" class="lang-option" data-lang="DE" style="display: flex; align-items: center; gap: 8px; padding: 8px 12px; color: #1f2937; text-decoration: none; transition: all 0.2s;">
                                    <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 5 3'%3E%3Crect width='5' height='1' fill='%23000'/%3E%3Crect y='1' width='5' height='1' fill='%23D00'/%3E%3Crect y='2' width='5' height='1' fill='%23FFCE00'/%3E%3C/svg%3E" alt="Germany" width="24" height="16" style="border-radius: 2px;">
                                    <span>Deutsch</span>
                                </a>
                                <a href="#" class="lang-option" data-lang="ES" style="display: flex; align-items: center; gap: 8px; padding: 8px 12px; color: #1f2937; text-decoration: none; transition: all 0.2s;">
                                    <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 3 2'%3E%3Crect width='3' height='2' fill='%23c60b1e'/%3E%3Crect y='0.5' width='3' height='1' fill='%23ffc400'/%3E%3C/svg%3E" alt="Spain" width="24" height="16" style="border-radius: 2px;">
                                    <span>Español</span>
                                </a>
                                <a href="#" class="lang-option" data-lang="JP" style="display: flex; align-items: center; gap: 8px; padding: 8px 12px; color: #1f2937; text-decoration: none; transition: all 0.2s;">
                                    <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 3 2'%3E%3Crect width='3' height='2' fill='%23fff'/%3E%3Ccircle cx='1.5' cy='1' r='0.6' fill='%23bc002d'/%3E%3C/svg%3E" alt="Japan" width="24" height="16" style="border-radius: 2px;">
                                    <span>日本語</span>
                                </a>
                                <a href="#" class="lang-option" data-lang="RU" style="display: flex; align-items: center; gap: 8px; padding: 8px 12px; color: #1f2937; text-decoration: none; transition: all 0.2s;">
                                    <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 9 6'%3E%3Crect width='9' height='2' fill='%23fff'/%3E%3Crect y='2' width='9' height='2' fill='%230039a6'/%3E%3Crect y='4' width='9' height='2' fill='%23d52b1e'/%3E%3C/svg%3E" alt="Russia" width="24" height="16" style="border-radius: 2px;">
                                    <span>Русский</span>
                                </a>
                                <a href="#" class="lang-option" data-lang="UZ" style="display: flex; align-items: center; gap: 8px; padding: 8px 12px; color: #1f2937; text-decoration: none; transition: all 0.2s;">
                                    <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 500 250'%3E%3Crect width='500' height='80' fill='%231EB53A'/%3E%3Crect y='80' width='500' height='3' fill='%23FF0000'/%3E%3Crect y='83' width='500' height='84' fill='%23FFFFFF'/%3E%3Crect y='167' width='500' height='3' fill='%23FF0000'/%3E%3Crect y='170' width='500' height='80' fill='%230099B5'/%3E%3Ccircle cx='100' cy='40' r='25' fill='%23FFFFFF'/%3E%3Ccircle cx='110' cy='40' r='20' fill='%231EB53A'/%3E%3Cpolygon points='150,25 153,34 162,34 155,40 158,49 150,43 142,49 145,40 138,34 147,34' fill='%23FFFFFF'/%3E%3Cpolygon points='180,25 183,34 192,34 185,40 188,49 180,43 172,49 175,40 168,34 177,34' fill='%23FFFFFF'/%3E%3Cpolygon points='210,25 213,34 222,34 215,40 218,49 210,43 202,49 205,40 198,34 207,34' fill='%23FFFFFF'/%3E%3Cpolygon points='165,50 168,59 177,59 170,65 173,74 165,68 157,74 160,65 153,59 162,59' fill='%23FFFFFF'/%3E%3Cpolygon points='195,50 198,59 207,59 200,65 203,74 195,68 187,74 190,65 183,59 192,59' fill='%23FFFFFF'/%3E%3C/svg%3E" alt="Uzbekistan" width="24" height="16" style="border-radius: 2px;">
                                    <span>Uzbek</span>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="sidebar-button mobile-menu-btn">
                    <svg width="20" height="18" viewBox="0 0 20 18" xmlns="http://www.w3.org/2000/svg">
                        <path d="M1.29445 2.8421H10.5237C11.2389 2.8421 11.8182 2.2062 11.8182 1.42105C11.8182 0.635903 11.2389 0 10.5237 0H1.29445C0.579249 0 0 0.635903 0 1.42105C0 2.2062 0.579249 2.8421 1.29445 2.8421Z"></path>
                        <path d="M1.23002 10.421H18.77C19.4496 10.421 20 9.78506 20 8.99991C20 8.21476 19.4496 7.57886 18.77 7.57886H1.23002C0.550421 7.57886 0 8.21476 0 8.99991C0 9.78506 0.550421 10.421 1.23002 10.421Z"></path>
                        <path d="M18.8052 15.1579H10.2858C9.62563 15.1579 9.09094 15.7938 9.09094 16.5789C9.09094 17.3641 9.62563 18 10.2858 18H18.8052C19.4653 18 20 17.3641 20 16.5789C20 15.7938 19.4653 15.1579 18.8052 15.1579Z"></path>
                    </svg>
                </div>
            </div>
        </div>
    </header>

    <!-- Tour Details Banner -->
    <div class="tour-details-banner" id="tourBanner" style="background-image: url('https://images.unsplash.com/photo-1597212618440-806262de4f6b?w=1600'); background-size: cover; background-position: center;">
        <div class="tour-details-content">
            <div style="display: inline-block; padding: 8px 20px; background: rgba(255,255,255,0.25); border-radius: 25px; margin-bottom: 20px; backdrop-filter: blur(10px);">
                <span style="font-size: 16px; font-weight: 600;">Starting From</span>
                <span style="font-size: 28px; font-weight: 700; margin-left: 10px;" id="tourPriceBanner">$0</span>
                <span style="font-size: 16px; font-weight: 500;">/per person</span>
            </div>
            <h1 id="tourTitle" style="font-size: 56px; margin: 0; font-weight: 800; text-shadow: 0 4px 12px rgba(0,0,0,0.3);">Loading Tour...</h1>
            <div class="tour-meta" style="margin-top: 25px;">
                <div class="tour-meta-item">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                        <line x1="16" y1="2" x2="16" y2="6"></line>
                        <line x1="8" y1="2" x2="8" y2="6"></line>
                        <line x1="3" y1="10" x2="21" y2="10"></line>
                    </svg>
                    <span id="tourDuration">0 Days</span>
                </div>
                <div class="tour-meta-item">
                    <span style="font-weight: 700;">|</span>
                </div>
                <div class="tour-meta-item">
                    <span id="tourNights">0 Nights</span>
                </div>
                <div class="tour-meta-item">
                    <span style="font-weight: 700;">|</span>
                </div>
                <div class="tour-meta-item">
                    <span id="tourDestinations">3 Destinations</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Info Bar -->
    <div style="background: #f9fafb; border-top: 1px solid #e5e7eb; border-bottom: 1px solid #e5e7eb; padding: 20px 0;">
        <div class="container">
            <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 20px;">
                <div style="display: flex; align-items: center; gap: 8px;">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="2">
                        <polyline points="20 6 9 17 4 12"></polyline>
                    </svg>
                    <span style="color: #1f2937; font-weight: 500;">No Booking Fee</span>
                </div>
                <div style="display: flex; align-items: center; gap: 8px;">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="2">
                        <polyline points="20 6 9 17 4 12"></polyline>
                    </svg>
                    <span style="color: #1f2937; font-weight: 500;">Best Price Ever</span>
                </div>
                <div style="display: flex; align-items: center; gap: 10px;">
                    <!-- TripAdvisor Logo -->
                    <svg width="80" height="20" viewBox="0 0 200 50" fill="none">
                        <text x="0" y="35" font-family="Arial, sans-serif" font-size="30" font-weight="700" fill="#00AA6C">Tripadvisor</text>
                    </svg>
                    <div style="display: flex; gap: 2px;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="#10b981"><circle cx="12" cy="12" r="10"/></svg>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="#10b981"><circle cx="12" cy="12" r="10"/></svg>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="#10b981"><circle cx="12" cy="12" r="10"/></svg>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="#10b981"><circle cx="12" cy="12" r="10"/></svg>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="#d1d5db"><circle cx="12" cy="12" r="10"/></svg>
                    </div>
                    <span style="color: #1f2937; font-weight: 600;" id="infoBarRating">(4.5/5)</span>
                    <span style="color: #6b7280;">based on <span id="infoBarReviews">138</span> reviews</span>
                </div>
                <div style="display: flex; align-items: center; gap: 8px;">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="2">
                        <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
                        <path d="M2 17l10 5 10-5"></path>
                        <path d="M2 12l10 5 10-5"></path>
                    </svg>
                    <span style="color: #1f2937; font-weight: 500;">100% Carbon Neutral</span>
                </div>
                <div style="display: flex; align-items: center; gap: 12px;">
                    <a href="#" onclick="shareOnFacebook(event)" style="color: #6b7280; transition: color 0.3s;" onmouseover="this.style.color='#1877f2'" onmouseout="this.style.color='#6b7280'">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                        </svg>
                    </a>
                    <a href="#" onclick="shareOnLinkedIn(event)" style="color: #6b7280; transition: color 0.3s;" onmouseover="this.style.color='#0077b5'" onmouseout="this.style.color='#6b7280'">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                        </svg>
                    </a>
                    <a href="#" onclick="shareOnYouTube(event)" style="color: #6b7280; transition: color 0.3s;" onmouseover="this.style.color='#ff0000'" onmouseout="this.style.color='#6b7280'">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/>
                        </svg>
                    </a>
                    <a href="#" onclick="shareOnInstagram(event)" style="color: #6b7280; transition: color 0.3s;" onmouseover="this.style.color='#e4405f'" onmouseout="this.style.color='#6b7280'">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 0C8.74 0 8.333.015 7.053.072 5.775.132 4.905.333 4.14.63c-.789.306-1.459.717-2.126 1.384S.935 3.35.63 4.14C.333 4.905.131 5.775.072 7.053.012 8.333 0 8.74 0 12s.015 3.667.072 4.947c.06 1.277.261 2.148.558 2.913.306.788.717 1.459 1.384 2.126.667.666 1.336 1.079 2.126 1.384.766.296 1.636.499 2.913.558C8.333 23.988 8.74 24 12 24s3.667-.015 4.947-.072c1.277-.06 2.148-.262 2.913-.558.788-.306 1.459-.718 2.126-1.384.666-.667 1.079-1.335 1.384-2.126.296-.765.499-1.636.558-2.913.06-1.28.072-1.687.072-4.947s-.015-3.667-.072-4.947c-.06-1.277-.262-2.149-.558-2.913-.306-.789-.718-1.459-1.384-2.126C21.319 1.347 20.651.935 19.86.63c-.765-.297-1.636-.499-2.913-.558C15.667.012 15.26 0 12 0zm0 2.16c3.203 0 3.585.016 4.85.071 1.17.055 1.805.249 2.227.415.562.217.96.477 1.382.896.419.42.679.819.896 1.381.164.422.36 1.057.413 2.227.057 1.266.07 1.646.07 4.85s-.015 3.585-.074 4.85c-.061 1.17-.256 1.805-.421 2.227-.224.562-.479.96-.899 1.382-.419.419-.824.679-1.38.896-.42.164-1.065.36-2.235.413-1.274.057-1.649.07-4.859.07-3.211 0-3.586-.015-4.859-.074-1.171-.061-1.816-.256-2.236-.421-.569-.224-.96-.479-1.379-.899-.421-.419-.69-.824-.9-1.38-.165-.42-.359-1.065-.42-2.235-.045-1.26-.061-1.649-.061-4.844 0-3.196.016-3.586.061-4.861.061-1.17.255-1.814.42-2.234.21-.57.479-.96.9-1.381.419-.419.81-.689 1.379-.898.42-.166 1.051-.361 2.221-.421 1.275-.045 1.65-.06 4.859-.06l.045.03zm0 3.678c-3.405 0-6.162 2.76-6.162 6.162 0 3.405 2.76 6.162 6.162 6.162 3.405 0 6.162-2.76 6.162-6.162 0-3.405-2.76-6.162-6.162-6.162zM12 16c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4zm7.846-10.405c0 .795-.646 1.44-1.44 1.44-.795 0-1.44-.646-1.44-1.44 0-.794.646-1.439 1.44-1.439.793-.001 1.44.645 1.44 1.439z"/>
                        </svg>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Tour Details Content -->
    <div class="container" style="margin-top: 50px; margin-bottom: 80px;">
        <div class="row">
            <!-- Main Content -->
            <div class="col-lg-8">
                <!-- Overview -->
                <div class="mb-5">
                    <h2 class="section-title">Overview</h2>
                    <p id="tourDescription" style="font-size: 16px; line-height: 1.8; color: #4b5563;">
                        Loading tour description...
                    </p>
                </div>

                <!-- Highlights -->
                <div class="mb-5" id="highlightsSection">
                    <h2 class="section-title">Tour Highlights</h2>
                    <div id="highlightsList"></div>
                </div>

                <!-- Tour Itinerary Summary -->
                <div class="mb-5" id="tourItinerarySummary">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h2 class="section-title" style="margin-bottom: 0;">Tour Itinerary</h2>
                        <button id="expandAllBtn" onclick="toggleExpandAll()" style="background: transparent; border: 2px solid #6366f1; color: #6366f1; padding: 10px 20px; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.3s; display: flex; align-items: center; gap: 8px;">
                            <span id="expandAllText">Expand All</span>
                            <svg id="expandAllIcon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="transition: transform 0.3s;">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </button>
                    </div>
                    <div style="background: white; border: 1px solid #e5e7eb; border-radius: 12px; padding: 30px;">
                        <!-- Main Destination -->
                        <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 30px;">
                            <div style="width: 48px; height: 48px; border-radius: 50%; background: #3b82f6; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="white">
                                    <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
                                </svg>
                            </div>
                            <div>
                                <h3 style="font-size: 20px; font-weight: 700; margin: 0 0 5px 0; color: #1f2937;" id="itineraryDestination">Loading...</h3>
                                <p style="margin: 0; color: #6b7280; font-size: 14px;" id="itineraryDepartureTime">( Departure: <span id="departureTime">TBD</span> )</p>
                            </div>
                        </div>

                        <!-- Days List -->
                        <div id="itineraryDaysList" style="display: flex; flex-direction: column; gap: 15px;">
                            <!-- Days will be inserted here -->
                        </div>
                    </div>
                </div>

                <!-- Itinerary -->
                <div class="mb-5" id="itinerarySection" style="display: none;">
                    <div id="itineraryList"></div>
                </div>

                <!-- Package Features List -->
                <div class="mb-5">
                    <h2 class="section-title">Package Features List</h2>
                    <div class="row">
                        <div class="col-md-6 mb-4">
                            <h3 style="font-size: 20px; font-weight: 600; margin-bottom: 25px;">Include Features</h3>
                            <ul class="included-list" id="includedList"></ul>
                        </div>
                        <div class="col-md-6 mb-4">
                            <h3 style="font-size: 20px; font-weight: 600; margin-bottom: 25px;">Exclude Features</h3>
                            <ul class="excluded-list" id="excludedList"></ul>
                        </div>
                    </div>
                </div>

                <!-- Download Brochure - Compact -->
                <div class="mb-4">
                    <div class="brochure-banner-compact" style="background: linear-gradient(135deg, #1f2937 0%, #111827 100%); border-radius: 12px; overflow: hidden; position: relative; display: flex; align-items: center; padding: 20px 30px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                        <!-- Background Image Overlay -->
                        <div style="position: absolute; right: 0; top: 0; bottom: 0; width: 50%; background-image: url('https://images.unsplash.com/photo-1476514525535-07fb3b4ae5f1?w=600'); background-size: cover; background-position: center; opacity: 0.2;"></div>

                        <!-- Content -->
                        <div style="position: relative; z-index: 2; display: flex; align-items: center; justify-content: space-between; width: 100%; gap: 20px;">
                            <!-- Left: Text and Image -->
                            <div style="display: flex; align-items: center; gap: 20px; flex: 1;">
                                <div style="width: 70px; height: 70px; border-radius: 50%; overflow: hidden; border: 3px solid white; box-shadow: 0 2px 10px rgba(0,0,0,0.2); flex-shrink: 0;">
                                    <img id="brochureImage" src="https://images.unsplash.com/photo-1469854523086-cc02fe5d8800?w=200" alt="Tour" style="width: 100%; height: 100%; object-fit: cover;">
                                </div>
                                <div>
                                    <h3 style="color: white; font-size: 20px; font-weight: 700; margin: 0; line-height: 1.2;">
                                        Download Tour <span style="font-style: italic; font-weight: 300;">Brochure!</span>
                                    </h3>
                                    <p style="color: rgba(255,255,255,0.8); font-size: 13px; margin: 5px 0 0 0;">
                                        Get complete tour details in PDF format
                                    </p>
                                </div>
                            </div>

                            <!-- Right: Download Button -->
                            <div style="flex-shrink: 0;">
                                <button onclick="downloadBrochure()" class="brochure-download-btn-compact" style="background: #3b82f6; color: white; border: none; padding: 12px 25px; border-radius: 8px; font-size: 15px; font-weight: 600; cursor: pointer; transition: all 0.3s; display: flex; align-items: center; gap: 8px; box-shadow: 0 2px 10px rgba(59, 130, 246, 0.4);">
                                    Download
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                        <polyline points="7 10 12 15 17 10"></polyline>
                                        <line x1="12" y1="15" x2="12" y2="3"></line>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Additional Info -->
                <div class="mb-5" id="additionalInfoSection">
                    <h2 class="section-title">Additional Information</h2>
                    <div style="background: white; border: 1px solid #e5e7eb; border-radius: 12px; padding: 35px;">
                        <div class="row g-4">
                            <!-- Accommodation -->
                            <div class="col-md-4">
                                <div style="display: flex; gap: 15px; align-items: flex-start;">
                                    <div style="flex-shrink: 0;">
                                        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#667eea" stroke-width="1.5">
                                            <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                                            <polyline points="9 22 9 12 15 12 15 22"></polyline>
                                        </svg>
                                    </div>
                                    <div>
                                        <div style="font-size: 14px; color: #6b7280; margin-bottom: 5px;">Accommodation</div>
                                        <div style="font-size: 16px; font-weight: 600; color: #1f2937;" id="tourAccommodation">3-4 Star Hotel</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Meals -->
                            <div class="col-md-4">
                                <div style="display: flex; gap: 15px; align-items: flex-start;">
                                    <div style="flex-shrink: 0;">
                                        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#667eea" stroke-width="1.5">
                                            <path d="M18 8h1a4 4 0 0 1 0 8h-1"></path>
                                            <path d="M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"></path>
                                            <line x1="6" y1="1" x2="6" y2="4"></line>
                                            <line x1="10" y1="1" x2="10" y2="4"></line>
                                            <line x1="14" y1="1" x2="14" y2="4"></line>
                                        </svg>
                                    </div>
                                    <div>
                                        <div style="font-size: 14px; color: #6b7280; margin-bottom: 5px;">Meals</div>
                                        <div style="font-size: 16px; font-weight: 600; color: #1f2937;" id="tourMeals">Breakfast & Dinner</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Transportation -->
                            <div class="col-md-4">
                                <div style="display: flex; gap: 15px; align-items: flex-start;">
                                    <div style="flex-shrink: 0;">
                                        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#667eea" stroke-width="1.5">
                                            <rect x="1" y="3" width="15" height="13"></rect>
                                            <polygon points="16 8 20 8 23 11 23 16 16 16 16 8"></polygon>
                                            <circle cx="5.5" cy="18.5" r="2.5"></circle>
                                            <circle cx="18.5" cy="18.5" r="2.5"></circle>
                                        </svg>
                                    </div>
                                    <div>
                                        <div style="font-size: 14px; color: #6b7280; margin-bottom: 5px;">Transportation</div>
                                        <div style="font-size: 16px; font-weight: 600; color: #1f2937;" id="tourTransport">Car, Bus</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Group Size -->
                            <div class="col-md-4">
                                <div style="display: flex; gap: 15px; align-items: flex-start;">
                                    <div style="flex-shrink: 0;">
                                        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#667eea" stroke-width="1.5">
                                            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                                            <circle cx="9" cy="7" r="4"></circle>
                                            <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                                            <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                                        </svg>
                                    </div>
                                    <div>
                                        <div style="font-size: 14px; color: #6b7280; margin-bottom: 5px;">Group Size</div>
                                        <div style="font-size: 16px; font-weight: 600; color: #1f2937;" id="tourGroupSizeInfo">2-15 People</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Language -->
                            <div class="col-md-4">
                                <div style="display: flex; gap: 15px; align-items: flex-start;">
                                    <div style="flex-shrink: 0;">
                                        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#667eea" stroke-width="1.5">
                                            <circle cx="12" cy="12" r="10"></circle>
                                            <line x1="2" y1="12" x2="22" y2="12"></line>
                                            <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
                                        </svg>
                                    </div>
                                    <div>
                                        <div style="font-size: 14px; color: #6b7280; margin-bottom: 5px;">Language</div>
                                        <div style="font-size: 16px; font-weight: 600; color: #1f2937;" id="tourLanguage">English, Russian</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Age Range -->
                            <div class="col-md-4">
                                <div style="display: flex; gap: 15px; align-items: flex-start;">
                                    <div style="flex-shrink: 0;">
                                        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#667eea" stroke-width="1.5">
                                            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                                            <line x1="16" y1="2" x2="16" y2="6"></line>
                                            <line x1="8" y1="2" x2="8" y2="6"></line>
                                            <line x1="3" y1="10" x2="21" y2="10"></line>
                                        </svg>
                                    </div>
                                    <div>
                                        <div style="font-size: 14px; color: #6b7280; margin-bottom: 5px;">Age Range</div>
                                        <div style="font-size: 16px; font-weight: 600; color: #1f2937;" id="tourAgeRange">12-70 Years</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Season -->
                            <div class="col-md-4">
                                <div style="display: flex; gap: 15px; align-items: flex-start;">
                                    <div style="flex-shrink: 0;">
                                        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#667eea" stroke-width="1.5">
                                            <circle cx="12" cy="12" r="5"></circle>
                                            <line x1="12" y1="1" x2="12" y2="3"></line>
                                            <line x1="12" y1="21" x2="12" y2="23"></line>
                                            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                                            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                                            <line x1="1" y1="12" x2="3" y2="12"></line>
                                            <line x1="21" y1="12" x2="23" y2="12"></line>
                                            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                                            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                                        </svg>
                                    </div>
                                    <div>
                                        <div style="font-size: 14px; color: #6b7280; margin-bottom: 5px;">Season</div>
                                        <div style="font-size: 16px; font-weight: 600; color: #1f2937;" id="tourSeason">All Year Round</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Difficulty Level -->
                            <div class="col-md-4">
                                <div style="display: flex; gap: 15px; align-items: flex-start;">
                                    <div style="flex-shrink: 0;">
                                        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#667eea" stroke-width="1.5">
                                            <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
                                        </svg>
                                    </div>
                                    <div>
                                        <div style="font-size: 14px; color: #6b7280; margin-bottom: 5px;">Difficulty Level</div>
                                        <div style="font-size: 16px; font-weight: 600; color: #1f2937;" id="tourDifficulty">Moderate</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Category -->
                            <div class="col-md-4">
                                <div style="display: flex; gap: 15px; align-items: flex-start;">
                                    <div style="flex-shrink: 0;">
                                        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#667eea" stroke-width="1.5">
                                            <line x1="8" y1="6" x2="21" y2="6"></line>
                                            <line x1="8" y1="12" x2="21" y2="12"></line>
                                            <line x1="8" y1="18" x2="21" y2="18"></line>
                                            <line x1="3" y1="6" x2="3.01" y2="6"></line>
                                            <line x1="3" y1="12" x2="3.01" y2="12"></line>
                                            <line x1="3" y1="18" x2="3.01" y2="18"></line>
                                        </svg>
                                    </div>
                                    <div>
                                        <div style="font-size: 14px; color: #6b7280; margin-bottom: 5px;">Category</div>
                                        <div style="font-size: 16px; font-weight: 600; color: #1f2937;" id="tourCategoryInfo">Cultural Tour</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Additional Info with Checkmarks -->
                <div class="mb-5">
                    <h2 class="section-title">Additional Info</h2>
                    <div style="display: flex; flex-direction: column; gap: 15px;">
                        <div style="display: flex; align-items: flex-start; gap: 12px;">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="flex-shrink: 0; margin-top: 2px;">
                                <circle cx="12" cy="12" r="10" fill="#3b82f6"/>
                                <path d="M8 12l2 2 4-4" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            <div>
                                <strong style="color: #1f2937;">Free Cancellation</strong>
                                <span style="color: #6b7280;"> – Some tours offer free cancellation up to a certain period (e.g., 24-48 hours before departure).</span>
                            </div>
                        </div>
                        <div style="display: flex; align-items: flex-start; gap: 12px;">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="flex-shrink: 0; margin-top: 2px;">
                                <circle cx="12" cy="12" r="10" fill="#3b82f6"/>
                                <path d="M8 12l2 2 4-4" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            <div>
                                <strong style="color: #1f2937;">Health & Safety Guidelines</strong>
                                <span style="color: #6b7280;"> – COVID-19 regulations, vaccinations, or travel restrictions.</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Explore Locations -->
                <div class="mb-5" id="exploreLocationsSection">
                    <h2 class="section-title">Explore Locations</h2>
                    <div class="position-relative">
                        <!-- Navigation Arrows -->
                        <button class="location-nav-btn location-nav-prev" onclick="scrollLocations('prev')" style="position: absolute; left: -20px; top: 50%; transform: translateY(-50%); z-index: 10; width: 40px; height: 40px; border-radius: 50%; border: none; background: white; box-shadow: 0 2px 8px rgba(0,0,0,0.15); cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.3s;">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#1f2937" stroke-width="2">
                                <polyline points="15 18 9 12 15 6"></polyline>
                            </svg>
                        </button>
                        <button class="location-nav-btn location-nav-next" onclick="scrollLocations('next')" style="position: absolute; right: -20px; top: 50%; transform: translateY(-50%); z-index: 10; width: 40px; height: 40px; border-radius: 50%; border: none; background: white; box-shadow: 0 2px 8px rgba(0,0,0,0.15); cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.3s;">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#1f2937" stroke-width="2">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>

                        <!-- Locations Container -->
                        <div id="locationsContainer" style="display: flex; gap: 20px; overflow-x: auto; scroll-behavior: smooth; padding: 10px 0; scrollbar-width: none; -ms-overflow-style: none;">
                            <!-- Location cards will be inserted here by JavaScript -->
                        </div>
                    </div>
                </div>

                <!-- Location Map Modal -->
                <div id="locationMapModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0); z-index: 9999; align-items: center; justify-content: center; transition: background 0.2s ease;">
                    <div id="locationModalContent" style="background: white; border-radius: 16px; width: 90%; max-width: 900px; max-height: 90vh; overflow: hidden; position: relative; box-shadow: 0 20px 60px rgba(0,0,0,0.3); transform: scale(0.7) translateY(-30px); opacity: 0; transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);">
                        <!-- Modal Header -->
                        <div style="padding: 20px 24px; border-bottom: 1px solid #e5e7eb; display: flex; justify-content: space-between; align-items: center;">
                            <h3 id="modalLocationTitle" style="margin: 0; font-size: 20px; font-weight: 600; color: #1f2937;"></h3>
                            <button onclick="closeLocationModal()" style="width: 32px; height: 32px; border: none; background: #f3f4f6; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.2s;">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#6b7280" stroke-width="2">
                                    <line x1="18" y1="6" x2="6" y2="18"></line>
                                    <line x1="6" y1="6" x2="18" y2="18"></line>
                                </svg>
                            </button>
                        </div>
                        <!-- Modal Body -->
                        <div style="height: 600px; background: #f3f4f6;">
                            <iframe id="mapIframe" width="100%" height="100%" frameborder="0" style="border:0" allowfullscreen=""></iframe>
                        </div>
                    </div>
                </div>

                <!-- FAQ Section -->
                <div class="mb-5" id="faqSection">
                    <h2 class="section-title">Frequently Asked Questions</h2>
                    <div class="accordion" id="faqAccordion"></div>
                </div>

                <!-- Reviews Section -->
                <div class="mb-5" id="reviewsSection">
                    <h2 class="section-title">Customer Review & Rating</h2>

                    <!-- Rating Summary Box - Compact & Modern Design -->
                    <div class="mb-4" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 30px; border-radius: 16px; box-shadow: 0 8px 20px rgba(102, 126, 234, 0.25);">
                        <div class="row align-items-center">
                            <!-- Left: Overall Rating -->
                            <div class="col-lg-4">
                                <div class="text-center text-white">
                                    <div style="font-size: 48px; font-weight: 800; line-height: 1; margin-bottom: 8px;" id="overallRating">4.5</div>
                                    <div class="mb-2" style="display: flex; justify-content: center; gap: 4px;">
                                        <svg width="18" height="18" viewBox="0 0 24 24" fill="#fbbf24">
                                            <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                                        </svg>
                                        <svg width="18" height="18" viewBox="0 0 24 24" fill="#fbbf24">
                                            <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                                        </svg>
                                        <svg width="18" height="18" viewBox="0 0 24 24" fill="#fbbf24">
                                            <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                                        </svg>
                                        <svg width="18" height="18" viewBox="0 0 24 24" fill="#fbbf24">
                                            <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                                        </svg>
                                        <svg width="18" height="18" viewBox="0 0 24 24" fill="rgba(255,255,255,0.3)">
                                            <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                                        </svg>
                                    </div>
                                    <p style="margin: 0 0 15px 0; font-size: 13px; opacity: 0.85;">Based on <span id="reviewCount">125</span> reviews</p>
                                    <button onclick="alert('Review submission feature coming soon!')" style="background: white; color: #667eea; border: none; padding: 10px 24px; border-radius: 25px; font-weight: 600; cursor: pointer; transition: all 0.3s; font-size: 14px; box-shadow: 0 3px 10px rgba(0,0,0,0.15);">
                                        Write a Review
                                    </button>
                                </div>
                            </div>

                            <!-- Right: Category Ratings with Stars -->
                            <div class="col-lg-8" style="padding-left: 40px;">
                                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;">
                                    <!-- Transport -->
                                    <div style="background: rgba(255,255,255,0.15); backdrop-filter: blur(10px); padding: 15px; border-radius: 10px; border: 1px solid rgba(255,255,255,0.2);">
                                        <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 6px;">
                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                                                <path d="M5 17h14v2H5v-2zm7-12l-7 7h4v4h6v-4h4l-7-7z"/>
                                            </svg>
                                            <span style="color: white; font-weight: 600; font-size: 13px;">Transport</span>
                                        </div>
                                        <div style="display: flex; gap: 3px;">
                                            <svg width="14" height="14" viewBox="0 0 24 24" fill="#fbbf24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                            <svg width="14" height="14" viewBox="0 0 24 24" fill="#fbbf24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                            <svg width="14" height="14" viewBox="0 0 24 24" fill="#fbbf24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                            <svg width="14" height="14" viewBox="0 0 24 24" fill="#fbbf24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                            <svg width="14" height="14" viewBox="0 0 24 24" fill="#fbbf24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                        </div>
                                    </div>

                                    <!-- Food -->
                                    <div style="background: rgba(255,255,255,0.15); backdrop-filter: blur(10px); padding: 15px; border-radius: 10px; border: 1px solid rgba(255,255,255,0.2);">
                                        <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 6px;">
                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                                                <path d="M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8zM6 1v3M10 1v3M14 1v3"/>
                                            </svg>
                                            <span style="color: white; font-weight: 600; font-size: 13px;">Food</span>
                                        </div>
                                        <div style="display: flex; gap: 3px;">
                                            <svg width="14" height="14" viewBox="0 0 24 24" fill="#fbbf24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                            <svg width="14" height="14" viewBox="0 0 24 24" fill="#fbbf24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                            <svg width="14" height="14" viewBox="0 0 24 24" fill="#fbbf24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                            <svg width="14" height="14" viewBox="0 0 24 24" fill="#fbbf24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                            <svg width="14" height="14" viewBox="0 0 24 24" fill="rgba(255,255,255,0.3)"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                        </div>
                                    </div>

                                    <!-- Accommodation -->
                                    <div style="background: rgba(255,255,255,0.15); backdrop-filter: blur(10px); padding: 15px; border-radius: 10px; border: 1px solid rgba(255,255,255,0.2);">
                                        <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 6px;">
                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                                                <path d="M3 10h18M3 14h18m-9-4v8m-7-8v8m14-8v8"/>
                                            </svg>
                                            <span style="color: white; font-weight: 600; font-size: 13px;">Accommodation</span>
                                        </div>
                                        <div style="display: flex; gap: 3px;">
                                            <svg width="14" height="14" viewBox="0 0 24 24" fill="#fbbf24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                            <svg width="14" height="14" viewBox="0 0 24 24" fill="#fbbf24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                            <svg width="14" height="14" viewBox="0 0 24 24" fill="#fbbf24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                            <svg width="14" height="14" viewBox="0 0 24 24" fill="#fbbf24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                            <svg width="14" height="14" viewBox="0 0 24 24" fill="#fbbf24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                        </div>
                                    </div>

                                    <!-- Tour Guide -->
                                    <div style="background: rgba(255,255,255,0.15); backdrop-filter: blur(10px); padding: 15px; border-radius: 10px; border: 1px solid rgba(255,255,255,0.2);">
                                        <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 6px;">
                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                                                <circle cx="12" cy="8" r="5"/><path d="M20 21a8 8 0 1 0-16 0"/>
                                            </svg>
                                            <span style="color: white; font-weight: 600; font-size: 13px;">Tour Guide</span>
                                        </div>
                                        <div style="display: flex; gap: 3px;">
                                            <svg width="14" height="14" viewBox="0 0 24 24" fill="#fbbf24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                            <svg width="14" height="14" viewBox="0 0 24 24" fill="#fbbf24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                            <svg width="14" height="14" viewBox="0 0 24 24" fill="#fbbf24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                            <svg width="14" height="14" viewBox="0 0 24 24" fill="#fbbf24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                            <svg width="14" height="14" viewBox="0 0 24 24" fill="rgba(255,255,255,0.3)"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Individual Reviews -->
                    <div id="reviewsList">
                        <!-- Review 1 -->
                        <div style="background: white; border: 1px solid #e5e7eb; padding: 30px; border-radius: 12px; margin-bottom: 20px;">
                            <div style="display: flex; gap: 20px;">
                                <img src="https://ui-avatars.com/api/?name=Bowmik+Haldar&background=3b82f6&color=fff&size=60" alt="User" style="width: 60px; height: 60px; border-radius: 50%; flex-shrink: 0;">
                                <div style="flex: 1;">
                                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 10px;">
                                        <div>
                                            <h4 style="margin: 0; font-size: 18px; font-weight: 700; color: #1f2937;">Mr. Bowmik Haldar</h4>
                                            <p style="margin: 5px 0 0 0; color: #6b7280; font-size: 14px;">05 June, 2024</p>
                                        </div>
                                    </div>
                                    <p style="color: #4b5563; line-height: 1.6; margin-bottom: 15px;">Organization decides to seek consulting services to address a particular issue or to achieve specific objectives.</p>

                                    <!-- Category Ratings -->
                                    <div style="display: flex; flex-wrap: wrap; gap: 20px; margin-bottom: 15px;">
                                        <div style="display: flex; align-items: center; gap: 8px;">
                                            <span style="color: #6b7280; font-size: 14px; font-weight: 500;">Overall</span>
                                            <div style="display: flex; gap: 2px;">
                                                <svg width="16" height="16" viewBox="0 0 24 24" fill="#fbbf24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                                <svg width="16" height="16" viewBox="0 0 24 24" fill="#fbbf24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                                <svg width="16" height="16" viewBox="0 0 24 24" fill="#fbbf24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                                <svg width="16" height="16" viewBox="0 0 24 24" fill="#fbbf24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                                <svg width="16" height="16" viewBox="0 0 24 24" fill="#e5e7eb"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                            </div>
                                        </div>
                                        <div style="display: flex; align-items: center; gap: 8px;">
                                            <span style="color: #6b7280; font-size: 14px; font-weight: 500;">Transport</span>
                                            <div style="display: flex; gap: 2px;">
                                                <svg width="16" height="16" viewBox="0 0 24 24" fill="#fbbf24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                                <svg width="16" height="16" viewBox="0 0 24 24" fill="#fbbf24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                                <svg width="16" height="16" viewBox="0 0 24 24" fill="#fbbf24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                                <svg width="16" height="16" viewBox="0 0 24 24" fill="#fbbf24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                                <svg width="16" height="16" viewBox="0 0 24 24" fill="#e5e7eb"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                            </div>
                                        </div>
                                        <div style="display: flex; align-items: center; gap: 8px;">
                                            <span style="color: #6b7280; font-size: 14px; font-weight: 500;">Food</span>
                                            <div style="display: flex; gap: 2px;">
                                                <svg width="16" height="16" viewBox="0 0 24 24" fill="#fbbf24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                                <svg width="16" height="16" viewBox="0 0 24 24" fill="#fbbf24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                                <svg width="16" height="16" viewBox="0 0 24 24" fill="#fbbf24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                                <svg width="16" height="16" viewBox="0 0 24 24" fill="#fbbf24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                                <svg width="16" height="16" viewBox="0 0 24 24" fill="#e5e7eb"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                            </div>
                                        </div>
                                        <div style="display: flex; align-items: center; gap: 8px;">
                                            <span style="color: #6b7280; font-size: 14px; font-weight: 500;">Destination</span>
                                            <div style="display: flex; gap: 2px;">
                                                <svg width="16" height="16" viewBox="0 0 24 24" fill="#fbbf24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                                <svg width="16" height="16" viewBox="0 0 24 24" fill="#fbbf24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                                <svg width="16" height="16" viewBox="0 0 24 24" fill="#fbbf24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                                <svg width="16" height="16" viewBox="0 0 24 24" fill="#fbbf24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                                <svg width="16" height="16" viewBox="0 0 24 24" fill="#e5e7eb"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                            </div>
                                        </div>
                                        <div style="display: flex; align-items: center; gap: 8px;">
                                            <span style="color: #6b7280; font-size: 14px; font-weight: 500;">Hospitality</span>
                                            <div style="display: flex; gap: 2px;">
                                                <svg width="16" height="16" viewBox="0 0 24 24" fill="#fbbf24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                                <svg width="16" height="16" viewBox="0 0 24 24" fill="#fbbf24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                                <svg width="16" height="16" viewBox="0 0 24 24" fill="#fbbf24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                                <svg width="16" height="16" viewBox="0 0 24 24" fill="#fbbf24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                                <svg width="16" height="16" viewBox="0 0 24 24" fill="#e5e7eb"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                                            </div>
                                        </div>
                                    </div>

                                    <button onclick="alert('Reply feature coming soon!')" style="background: transparent; border: none; color: #6b7280; cursor: pointer; font-size: 14px; padding: 0; display: flex; align-items: center; gap: 5px;">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path>
                                        </svg>
                                        Reply (01)
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Review 2 -->
                        <div style="background: white; border: 1px solid #e5e7eb; padding: 30px; border-radius: 12px; margin-bottom: 20px;">
                            <div style="display: flex; gap: 20px;">
                                <img src="https://ui-avatars.com/api/?name=Jacoline+Juie&background=8b5cf6&color=fff&size=60" alt="User" style="width: 60px; height: 60px; border-radius: 50%; flex-shrink: 0;">
                                <div style="flex: 1;">
                                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 10px;">
                                        <div>
                                            <h4 style="margin: 0; font-size: 18px; font-weight: 700; color: #1f2937;">Jacoline Juie</h4>
                                            <p style="margin: 5px 0 0 0; color: #6b7280; font-size: 14px;">05 June, 2023</p>
                                        </div>
                                    </div>
                                    <p style="color: #4b5563; line-height: 1.6; margin-bottom: 15px;">However, here are some well-regarded car dealerships known for their customer service, inventory, and overall reputation. It's always a good idea to research and read reviews specific...</p>

                                    <button onclick="alert('Reply feature coming soon!')" style="background: transparent; border: none; color: #6b7280; cursor: pointer; font-size: 14px; padding: 0; display: flex; align-items: center; gap: 5px;">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path>
                                        </svg>
                                        Reply
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sidebar - Booking Box -->
            <div class="col-lg-4">
                <div class="booking-box">
                    <h3 style="font-size: 24px; margin-bottom: 25px;">Book This Tour</h3>

                    <div style="background: #f9fafb; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 15px;">
                            <span>Price per person:</span>
                            <strong id="pricePerPerson" style="font-size: 24px; color: #667eea;">$0</strong>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 15px;" id="discountSection">
                            <span>Discount:</span>
                            <strong id="discountPrice" style="color: #10b981;">-$0</strong>
                        </div>
                    </div>

                    <div class="mb-3">
                        <label style="display: block; margin-bottom: 10px; font-weight: 600;">Number of Travelers</label>
                        <select class="form-select" id="travelers" style="padding: 12px; border-radius: 8px;">
                            <option value="1">1 Person</option>
                            <option value="2">2 People</option>
                            <option value="3">3 People</option>
                            <option value="4">4 People</option>
                            <option value="5">5 People</option>
                            <option value="6">6 People</option>
                            <option value="7">7 People</option>
                            <option value="8">8 People</option>
                        </select>
                    </div>

                    <div class="mb-3">
                        <label style="display: block; margin-bottom: 10px; font-weight: 600;">Select Date</label>
                        <input type="date" class="form-control" id="tourDate" style="padding: 12px; border-radius: 8px;">
                    </div>

                    <div style="background: #f9fafb; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                        <div style="display: flex; justify-content: space-between; font-size: 18px;">
                            <strong>Total:</strong>
                            <strong id="totalPrice" style="color: #667eea; font-size: 28px;">$0</strong>
                        </div>
                    </div>

                    <button class="book-now-btn" onclick="bookNow()">
                        <i class="bi bi-calendar-check me-2"></i> Book Now
                    </button>

                    <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #e5e7eb;">
                        <p style="font-size: 14px; color: #6b7280; margin: 0;">
                            <i class="bi bi-shield-check" style="color: #10b981;"></i>
                            Free cancellation up to 24 hours before
                        </p>
                    </div>
                </div>

                <!-- Contact Info -->
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; border-radius: 15px; margin-top: 30px;">
                    <h4 style="margin-bottom: 20px;">Need Help?</h4>
                    <p style="margin-bottom: 15px;">
                        <i class="bi bi-telephone-fill"></i> +998 90 123 45 67
                    </p>
                    <p style="margin-bottom: 15px;">
                        <i class="bi bi-envelope-fill"></i> info@travelbliss.uz
                    </p>
                    <a href="contact.html" style="display: inline-block; background: white; color: #667eea; padding: 12px 25px; border-radius: 8px; text-decoration: none; font-weight: 600; margin-top: 10px;">
                        Contact Us
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer-area">
        <div class="container">
            <div class="footer-content" style="text-align: center; padding: 40px 0;">
                <p style="color: #6b7280; margin: 0;">
                    © 2025 Travel Bliss. All rights reserved.
                </p>
            </div>
        </div>
    </footer>

    <!-- JavaScript -->
    <script src="assets/js/jquery-3.7.1.min.js"></script>
    <script src="assets/js/bootstrap.min.js"></script>
    <script src="assets/js/popper.min.js"></script>
    <script src="assets/js/swiper-bundle.min.js"></script>
    <script src="assets/js/slick.js"></script>
    <script src="assets/js/waypoints.min.js"></script>
    <script src="assets/js/wow.min.js"></script>
    <script src="assets/js/jquery-ui.js"></script>
    <script src="assets/js/moment.min.js"></script>
    <script src="assets/js/daterangepicker.min.js"></script>
    <script src="assets/js/jquery.counterup.min.js"></script>
    <script src="assets/js/jquery.fancybox.min.js"></script>
    <script src="assets/js/gsap.min.js"></script>
    <script src="assets/js/ScrollTrigger.min.js"></script>
    <script src="assets/js/select-dropdown.js"></script>
    <script src="assets/js/custom.js"></script>
    <!-- jsPDF for PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <script>
        const API_BASE = 'http://localhost:4000';
        let currentTour = null;

        // Helper function to get correct image path
        function getImagePath(image) {
            if (!image) return null;

            // If image starts with /uploads, it's an uploaded image - add base URL
            if (image.startsWith('/uploads/')) {
                return `http://localhost:4000${image}`;
            }

            // If image starts with http:// or https://, it's an external URL
            if (image.startsWith('http://') || image.startsWith('https://')) {
                return image;
            }

            // Otherwise, it's a legacy local asset
            return `assets/img/home1/${image}`;
        }

        // Get tour ID from URL
        const urlParams = new URLSearchParams(window.location.search);
        const tourId = urlParams.get('id');

        // Load tour when page loads
        document.addEventListener('DOMContentLoaded', async function() {
            if (!tourId) {
                alert('Tour ID not found!');
                window.location.href = 'travel-agency-03.html';
                return;
            }

            await loadTour(tourId);
            setupPriceCalculator();
            setMinDate();
        });

        // Social Media Sharing Functions
        function shareOnFacebook(event) {
            event.preventDefault();
            const url = encodeURIComponent(window.location.href);
            window.open(`https://www.facebook.com/sharer/sharer.php?u=${url}`, '_blank', 'width=600,height=400');
        }

        function shareOnLinkedIn(event) {
            event.preventDefault();
            const url = encodeURIComponent(window.location.href);
            const title = encodeURIComponent(document.getElementById('tourTitle').textContent);
            window.open(`https://www.linkedin.com/shareArticle?mini=true&url=${url}&title=${title}`, '_blank', 'width=600,height=400');
        }

        function shareOnYouTube(event) {
            event.preventDefault();
            // YouTube doesn't have direct sharing, so we'll copy the link
            const url = window.location.href;
            navigator.clipboard.writeText(url).then(() => {
                alert('Link copied to clipboard! Share it on YouTube.');
            }).catch(() => {
                alert('Please copy this link: ' + url);
            });
        }

        function shareOnInstagram(event) {
            event.preventDefault();
            // Instagram doesn't have direct sharing from web, so we'll copy the link
            const url = window.location.href;
            navigator.clipboard.writeText(url).then(() => {
                alert('Link copied to clipboard! Share it on Instagram.');
            }).catch(() => {
                alert('Please copy this link: ' + url);
            });
        }

        async function loadTour(id) {
            try {
                const response = await fetch(`${API_BASE}/api/tours/${id}`);
                const data = await response.json();

                console.log('Loaded tour data:', data);

                if (data.success && data.data && data.data.tour) {
                    currentTour = data.data.tour;
                    console.log('Current tour:', currentTour);

                    try {
                        displayTour(currentTour);
                    } catch (displayError) {
                        console.error('Error displaying tour:', displayError);
                        // Don't redirect, just log the error
                    }
                } else {
                    console.error('Invalid tour data:', data);
                    alert('Tour not found!');
                    window.location.href = 'travel-agency-03.html';
                }
            } catch (error) {
                console.error('Error loading tour:', error);
                alert('Error loading tour details');
                window.location.href = 'travel-agency-03.html';
            }
        }

        function displayTour(tour) {
            console.log('✅✅✅ YANGI KOD ISHLAYAPTI - VERSION 2.0 ✅✅✅');
            console.log('✅ displayTour called with:', JSON.stringify(tour, null, 2));

            // Extra safety check
            if (!tour) {
                console.error('❌ ERROR: Tour is undefined!');
                return;
            }

            console.log('✅ Tour object is valid, starting display...');

            // Title and Basic Info
            const title = tour.title || tour.name;
            const location = tour.destination || tour.location;

            document.getElementById('pageTitle').textContent = `${title} - Travel Bliss`;
            document.getElementById('tourTitle').textContent = title;

            // Price in banner
            const price = tour.discountPrice || tour.price;
            document.getElementById('tourPriceBanner').textContent = `$${price}`;
            document.getElementById('pricePerPerson').textContent = `$${price}`;

            // Discount
            if (tour.discountPrice && tour.discountPrice < tour.price) {
                document.getElementById('discountPrice').textContent = `-$${tour.price - tour.discountPrice}`;
            } else {
                document.getElementById('discountSection').style.display = 'none';
            }

            // Meta Info in banner
            const duration = tour.duration || 3;
            const nights = tour.nights || (duration - 1);
            const destinations = tour.destinations || 3;

            document.getElementById('tourDuration').textContent = `${duration} Days`;
            document.getElementById('tourNights').textContent = `${nights} Nights`;
            document.getElementById('tourDestinations').textContent = `${destinations} Destinations`;

            // Info bar
            const rating = (tour.rating || 4.5).toFixed(1);
            const reviewCount = tour.ratingsCount || tour.reviewCount || 138;
            document.getElementById('infoBarRating').textContent = `(${rating}/5)`;
            document.getElementById('infoBarReviews').textContent = reviewCount;

            // Update banner background image
            const bannerEl = document.getElementById('tourBanner');
            let bgImage;

            // Use uploaded image if available, otherwise use location-based default
            const tourImage = tour.imageCover || tour.image;
            if (tourImage) {
                bgImage = getImagePath(tourImage);
            } else {
                // Fallback to location-based defaults
                bgImage = 'https://images.unsplash.com/photo-1597212618440-806262de4f6b?w=1600'; // Default Samarkand

                if (location.toLowerCase().includes('bukhara')) {
                    bgImage = 'https://images.unsplash.com/photo-1564507592333-c60657eea523?w=1600';
                } else if (location.toLowerCase().includes('chimgan')) {
                    bgImage = 'https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=1600';
                } else if (title.toLowerCase().includes('bukhara')) {
                    bgImage = 'https://images.unsplash.com/photo-1564507592333-c60657eea523?w=1600';
                } else if (title.toLowerCase().includes('chimgan')) {
                    bgImage = 'https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=1600';
                }
            }

            bannerEl.style.backgroundImage = `url('${bgImage}')`;

            // Description
            document.getElementById('tourDescription').textContent = tour.description || tour.summary || 'No description available.';

            // Highlights
            if (tour.highlights && Array.isArray(tour.highlights) && tour.highlights.length > 0) {
                const highlightsList = document.getElementById('highlightsList');
                highlightsList.innerHTML = tour.highlights.map(h =>
                    `<div class="highlight-card">
                        <svg width="22" height="22" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="flex-shrink: 0;">
                            <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" fill="#fbbf24" stroke="#fbbf24" stroke-width="0.5"/>
                        </svg>
                        <span style="color: #4b5563; line-height: 1.6;">${h}</span>
                    </div>`
                ).join('');
            } else {
                document.getElementById('highlightsSection').style.display = 'none';
            }

            // Tour Itinerary Summary
            if (tour.itinerary && Array.isArray(tour.itinerary) && tour.itinerary.length > 0) {
                // Set destination
                document.getElementById('itineraryDestination').textContent = tour.destination || tour.location || 'Uzbekistan';

                // Set departure time (default if not available)
                const departureTime = tour.departureTime || '8:00 am - 8:30am';
                document.getElementById('departureTime').textContent = departureTime;

                // Create days list
                const itineraryDaysList = document.getElementById('itineraryDaysList');
                itineraryDaysList.innerHTML = tour.itinerary.map((day, index) => {
                    const dayTitle = day.title || `Day ${day.day || index + 1}`;
                    const description = day.description || '';
                    const activities = day.activities || [];

                    return `
                        <div class="itinerary-item">
                            <div class="itinerary-header" onclick="toggleItineraryDay(${index})">
                                <div style="display: flex; align-items: center; gap: 15px;">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#1f2937" stroke-width="2" style="flex-shrink: 0;">
                                        <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                                        <circle cx="12" cy="10" r="3"></circle>
                                    </svg>
                                    <div>
                                        <span style="font-weight: 600; color: #1f2937;">Day-${String(day.day || index + 1).padStart(2, '0')}</span>
                                        <span style="color: #6b7280; margin-left: 15px;">${dayTitle}</span>
                                    </div>
                                </div>
                                <svg class="expand-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#6366f1" stroke-width="2">
                                    <polyline points="6 9 12 15 18 9"></polyline>
                                </svg>
                            </div>
                            <div class="itinerary-content">
                                ${description ? `<p style="color: #4b5563; line-height: 1.8; margin-bottom: 20px;">${description}</p>` : ''}
                                ${activities.length > 0 ? `
                                    <div>
                                        <h4 style="font-size: 16px; font-weight: 700; color: #1f2937; margin-bottom: 15px;">Activities:</h4>
                                        <ul style="list-style: none; padding: 0; margin: 0;">
                                            ${activities.map(activity => `
                                                <li style="padding: 8px 0; display: flex; align-items: flex-start; gap: 10px;">
                                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" style="flex-shrink: 0; margin-top: 2px;">
                                                        <circle cx="12" cy="12" r="10" fill="#3b82f6"/>
                                                        <path d="M8 12l2 2 4-4" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
                                                    </svg>
                                                    <span style="color: #4b5563; line-height: 1.6;">${activity}</span>
                                                </li>
                                            `).join('')}
                                        </ul>
                                    </div>
                                ` : ''}
                            </div>
                        </div>
                    `;
                }).join('');
            } else {
                document.getElementById('tourItinerarySummary').style.display = 'none';
            }

            // Itinerary
            if (tour.itinerary && Array.isArray(tour.itinerary) && tour.itinerary.length > 0) {
                const itineraryList = document.getElementById('itineraryList');
                itineraryList.innerHTML = tour.itinerary.map((day, index) => {
                    let activitiesHTML = '';
                    if (day.activities && Array.isArray(day.activities)) {
                        activitiesHTML = `
                            <div style="margin-top: 15px;">
                                <strong style="color: #1f2937;">Activities:</strong>
                                <ul style="margin: 10px 0; padding-left: 25px; color: #6b7280;">
                                    ${day.activities.map(act => `<li>${act}</li>`).join('')}
                                </ul>
                            </div>`;
                    }

                    let transportHTML = '';
                    if (day.transport && Array.isArray(day.transport)) {
                        transportHTML = `
                            <div style="display: inline-block; margin-right: 20px; margin-top: 10px;">
                                <i class="bi bi-car-front-fill" style="color: #667eea;"></i>
                                <span style="color: #6b7280; margin-left: 5px;">${day.transport.join(', ')}</span>
                            </div>`;
                    }

                    let mealsHTML = '';
                    if (day.meals) {
                        mealsHTML = `
                            <div style="display: inline-block; margin-right: 20px; margin-top: 10px;">
                                <i class="bi bi-cup-hot-fill" style="color: #667eea;"></i>
                                <span style="color: #6b7280; margin-left: 5px;">${day.meals}</span>
                            </div>`;
                    }

                    let accommodationHTML = '';
                    if (day.accommodation) {
                        accommodationHTML = `
                            <div style="display: inline-block; margin-top: 10px;">
                                <i class="bi bi-house-fill" style="color: #667eea;"></i>
                                <span style="color: #6b7280; margin-left: 5px;">${day.accommodation}</span>
                            </div>`;
                    }

                    return `<div class="itinerary-item">
                        <div class="itinerary-header" onclick="toggleItinerary(${index})">
                            <div style="display: flex; align-items: center; gap: 15px;">
                                <div class="day-number">${day.day || index + 1}</div>
                                <div>
                                    <h4 style="font-size: 18px; font-weight: 600; margin: 0;">
                                        ${day.title || `Day ${day.day || index + 1}`}
                                    </h4>
                                </div>
                            </div>
                            <svg class="expand-icon" id="icon-${index}" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#6366f1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </div>
                        <div class="itinerary-content" id="content-${index}">
                            <p style="color: #6b7280; line-height: 1.8; margin-bottom: 15px;">
                                ${day.description || 'No description available'}
                            </p>
                            ${activitiesHTML}
                            <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #e5e7eb;">
                                ${mealsHTML}
                                ${transportHTML}
                                ${accommodationHTML}
                            </div>
                        </div>
                    </div>`;
                }).join('');
            } else {
                document.getElementById('itinerarySection').style.display = 'none';
            }

            // Included
            const included = tour.includes || tour.included || [];
            if (Array.isArray(included) && included.length > 0) {
                document.getElementById('includedList').innerHTML = included.map(item =>
                    `<li>${item}</li>`
                ).join('');
            } else {
                document.getElementById('includedList').innerHTML = '<li>Not specified</li>';
            }

            // Excluded
            const excluded = tour.excludes || tour.excluded || [];
            if (Array.isArray(excluded) && excluded.length > 0) {
                document.getElementById('excludedList').innerHTML = excluded.map(item =>
                    `<li>${item}</li>`
                ).join('');
            } else {
                document.getElementById('excludedList').innerHTML = '<li>Not specified</li>';
            }

            // Additional Info
            document.getElementById('tourDifficulty').textContent = tour.difficulty || 'Moderate';
            document.getElementById('tourAccommodation').textContent = tour.accommodation || '3-4 Star Hotel';
            document.getElementById('tourMeals').textContent = tour.meals || 'Breakfast & Dinner';
            document.getElementById('tourTransport').textContent = tour.transportation || 'Car, Bus';
            document.getElementById('tourGroupSizeInfo').textContent = tour.maxGroupSize ? `2-${tour.maxGroupSize} People` : '2-15 People';
            document.getElementById('tourLanguage').textContent = (tour.languages && Array.isArray(tour.languages) && tour.languages.length > 0) ? tour.languages.join(', ') : (tour.language || 'English, Russian');

            // Fix ageRange - it could be an object or string
            const ageRangeText = tour.ageRange ?
                (typeof tour.ageRange === 'object' ? `${tour.ageRange.min || 0}-${tour.ageRange.max || 99} Years` : tour.ageRange)
                : '12-70 Years';
            document.getElementById('tourAgeRange').textContent = ageRangeText;
            document.getElementById('tourSeason').textContent = tour.season || 'All Year Round';

            // Category
            const categoryMap = {
                'cultural': 'Cultural Tour',
                'adventure': 'Adventure Tour',
                'hiking': 'Hiking Tour',
                'day-trip': 'Day Trip'
            };
            document.getElementById('tourCategoryInfo').textContent = categoryMap[tour.category] || 'Cultural Tour';

            // FAQ Section
            if (tour.faq && Array.isArray(tour.faq) && tour.faq.length > 0) {
                const faqAccordion = document.getElementById('faqAccordion');
                faqAccordion.innerHTML = tour.faq.map((item, index) =>
                    `<div class="accordion-item" style="border: 1px solid #e5e7eb; border-radius: 8px; margin-bottom: 10px; overflow: hidden;">
                        <h2 class="accordion-header" id="faqHeading${index}">
                            <button class="accordion-button ${index !== 0 ? 'collapsed' : ''}" type="button" data-bs-toggle="collapse" data-bs-target="#faqCollapse${index}" aria-expanded="${index === 0 ? 'true' : 'false'}" aria-controls="faqCollapse${index}" style="font-weight: 600; padding: 20px;">
                                ${item.question}
                            </button>
                        </h2>
                        <div id="faqCollapse${index}" class="accordion-collapse collapse ${index === 0 ? 'show' : ''}" aria-labelledby="faqHeading${index}" data-bs-parent="#faqAccordion">
                            <div class="accordion-body" style="padding: 20px; color: #6b7280; line-height: 1.8;">
                                ${item.answer}
                            </div>
                        </div>
                    </div>`
                ).join('');
            } else {
                document.getElementById('faqSection').style.display = 'none';
            }

            // Reviews
            const tourRating = (tour.rating || 4.5).toFixed(1);
            document.getElementById('overallRating').textContent = tourRating;
            document.getElementById('reviewCount').textContent = tour.ratingsCount || tour.reviewCount || '3,545';

            // Update Brochure Image
            updateBrochureImage(tour);

            // Map removed - initializeMap(tour);

            // Load Explore Locations
            console.log('✅ Calling loadExploreLocations...');
            loadExploreLocations(tour);
            console.log('✅ displayTour completed successfully!');
        }

        function updateBrochureImage(tour) {
            const brochureImg = document.getElementById('brochureImage');

            // Set tour-specific image based on uploaded image or location
            const location = (tour.destination || tour.location || '').toLowerCase();
            const title = (tour.title || tour.name || '').toLowerCase();

            // Helper function to get correct image path
            // Use uploaded image if available
            const tourImage = tour.imageCover || tour.image;
            if (tourImage) {
                brochureImg.src = getImagePath(tourImage);
            } else {
                // Fallback to location-based defaults
                if (location.includes('samarkand') || title.includes('samarkand')) {
                    brochureImg.src = 'https://images.unsplash.com/photo-1597212618440-806262de4f6b?w=300';
                } else if (location.includes('bukhara') || title.includes('bukhara')) {
                    brochureImg.src = 'https://images.unsplash.com/photo-1564507592333-c60657eea523?w=300';
                } else if (location.includes('chimgan') || title.includes('chimgan')) {
                    brochureImg.src = 'https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=300';
                } else {
                    brochureImg.src = 'https://images.unsplash.com/photo-1469854523086-cc02fe5d8800?w=300';
                }
            }
        }

        function downloadBrochure() {
            if (!currentTour) {
                alert('Tour information not loaded');
                return;
            }

            try {
                generateBrochurePDF();
            } catch (error) {
                console.error('Error generating PDF:', error);
                alert('Error generating PDF brochure. Please try again.');
            }
        }

        function generateBrochurePDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            const tour = currentTour;
            const pageWidth = doc.internal.pageSize.getWidth();
            const pageHeight = doc.internal.pageSize.getHeight();
            let yPos = 20;

            // Header - Purple gradient background (simulated)
            doc.setFillColor(102, 126, 234);
            doc.rect(0, 0, pageWidth, 50, 'F');

            // Company Name
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(24);
            doc.setFont('helvetica', 'bold');
            doc.text('TRAVEL BLISS', pageWidth / 2, 20, { align: 'center' });

            doc.setFontSize(12);
            doc.setFont('helvetica', 'normal');
            doc.text('Discover Uzbekistan', pageWidth / 2, 30, { align: 'center' });

            // Tour Title
            yPos = 60;
            doc.setTextColor(0, 0, 0);
            doc.setFontSize(20);
            doc.setFont('helvetica', 'bold');
            doc.text(tour.title || tour.name, 20, yPos);

            // Location
            yPos += 10;
            doc.setFontSize(12);
            doc.setFont('helvetica', 'italic');
            doc.setTextColor(107, 114, 128);
            doc.text(tour.destination || tour.location, 20, yPos);

            // Price Box
            yPos += 15;
            doc.setFillColor(249, 250, 251);
            doc.rect(20, yPos - 5, 60, 20, 'F');
            doc.setTextColor(102, 126, 234);
            doc.setFontSize(24);
            doc.setFont('helvetica', 'bold');
            doc.text(`$${tour.discountPrice || tour.price}`, 25, yPos + 8);
            doc.setFontSize(10);
            doc.setTextColor(107, 114, 128);
            doc.text('per person', 25, yPos + 15);

            // Duration, Group Size, Rating
            doc.setFontSize(10);
            doc.setTextColor(0, 0, 0);
            doc.setFont('helvetica', 'normal');
            doc.text(`Duration: ${tour.duration} Days`, 100, yPos + 5);
            doc.text(`Group Size: Max ${tour.maxGroupSize} People`, 100, yPos + 12);
            doc.text(`Rating: ${(tour.rating || 4.5).toFixed(1)} / 5.0`, 100, yPos + 19);

            // Overview
            yPos += 35;
            doc.setFontSize(14);
            doc.setFont('helvetica', 'bold');
            doc.setTextColor(0, 0, 0);
            doc.text('Overview', 20, yPos);

            yPos += 7;
            doc.setFontSize(10);
            doc.setFont('helvetica', 'normal');
            doc.setTextColor(75, 85, 99);
            const description = tour.description || tour.summary || 'No description available.';
            const descLines = doc.splitTextToSize(description, pageWidth - 40);
            doc.text(descLines, 20, yPos);
            yPos += descLines.length * 5 + 10;

            // Tour Highlights
            if (tour.highlights && Array.isArray(tour.highlights) && tour.highlights.length > 0) {
                doc.setFontSize(14);
                doc.setFont('helvetica', 'bold');
                doc.setTextColor(0, 0, 0);
                doc.text('Tour Highlights', 20, yPos);
                yPos += 7;

                doc.setFontSize(10);
                doc.setFont('helvetica', 'normal');
                tour.highlights.forEach((highlight, index) => {
                    if (yPos > pageHeight - 30) {
                        doc.addPage();
                        yPos = 20;
                    }
                    doc.setTextColor(251, 191, 36);
                    doc.text('★', 20, yPos);
                    doc.setTextColor(75, 85, 99);
                    const highlightLines = doc.splitTextToSize(highlight, pageWidth - 50);
                    doc.text(highlightLines, 27, yPos);
                    yPos += highlightLines.length * 5 + 3;
                });
                yPos += 5;
            }

            // What's Included
            if (yPos > pageHeight - 60) {
                doc.addPage();
                yPos = 20;
            }

            const included = tour.includes || tour.included || [];
            if (Array.isArray(included) && included.length > 0) {
                doc.setFontSize(14);
                doc.setFont('helvetica', 'bold');
                doc.setTextColor(0, 0, 0);
                doc.text("What's Included", 20, yPos);
                yPos += 7;

                doc.setFontSize(10);
                doc.setFont('helvetica', 'normal');
                included.forEach(item => {
                    if (yPos > pageHeight - 30) {
                        doc.addPage();
                        yPos = 20;
                    }
                    doc.setTextColor(16, 185, 129);
                    doc.text('✓', 20, yPos);
                    doc.setTextColor(75, 85, 99);
                    const itemLines = doc.splitTextToSize(item, pageWidth - 50);
                    doc.text(itemLines, 27, yPos);
                    yPos += itemLines.length * 5 + 3;
                });
                yPos += 5;
            }

            // What's Excluded
            const excluded = tour.excludes || tour.excluded || [];
            if (Array.isArray(excluded) && excluded.length > 0) {
                if (yPos > pageHeight - 60) {
                    doc.addPage();
                    yPos = 20;
                }

                doc.setFontSize(14);
                doc.setFont('helvetica', 'bold');
                doc.setTextColor(0, 0, 0);
                doc.text("What's Excluded", 20, yPos);
                yPos += 7;

                doc.setFontSize(10);
                doc.setFont('helvetica', 'normal');
                excluded.forEach(item => {
                    if (yPos > pageHeight - 30) {
                        doc.addPage();
                        yPos = 20;
                    }
                    doc.setTextColor(239, 68, 68);
                    doc.text('✗', 20, yPos);
                    doc.setTextColor(75, 85, 99);
                    const itemLines = doc.splitTextToSize(item, pageWidth - 50);
                    doc.text(itemLines, 27, yPos);
                    yPos += itemLines.length * 5 + 3;
                });
                yPos += 10;
            }

            // Contact Information - Footer
            if (yPos > pageHeight - 50) {
                doc.addPage();
                yPos = 20;
            } else {
                yPos = pageHeight - 40;
            }

            doc.setFillColor(102, 126, 234);
            doc.rect(0, yPos - 5, pageWidth, 50, 'F');

            doc.setTextColor(255, 255, 255);
            doc.setFontSize(12);
            doc.setFont('helvetica', 'bold');
            doc.text('Contact Us', 20, yPos + 5);

            doc.setFontSize(10);
            doc.setFont('helvetica', 'normal');
            doc.text('Phone: +998 90 123 45 67', 20, yPos + 13);
            doc.text('Email: info@travelbliss.uz', 20, yPos + 20);
            doc.text('Website: www.travelbliss.uz', 20, yPos + 27);

            doc.setFontSize(8);
            doc.setTextColor(255, 255, 255);
            doc.text('© 2025 Travel Bliss. All rights reserved.', pageWidth / 2, yPos + 35, { align: 'center' });

            // Save the PDF
            const fileName = `${(tour.title || tour.name).replace(/[^a-z0-9]/gi, '_')}_Brochure.pdf`;
            doc.save(fileName);
        }

        function loadExploreLocations(tour) {
            console.log('🔵 loadExploreLocations started');
            const locationsContainer = document.getElementById('locationsContainer');

            // Safety check
            if (!tour) {
                console.error('❌ Tour data is undefined in loadExploreLocations');
                return;
            }

            console.log('🔵 Tour data:', {
                hasImages: !!tour.images,
                imagesType: typeof tour.images,
                isArray: Array.isArray(tour.images),
                imagesLength: tour.images ? tour.images.length : 0,
                images: tour.images
            });

            // Define locations array
            const locations = [];

            // Priority 1: Use uploaded images with location names
            if (tour.images && Array.isArray(tour.images) && tour.images.length > 0) {
                console.log('🔵 Checking for named images...');
                // Check if images have the new object format with names
                const hasNamedImages = tour.images.some(img =>
                    typeof img === 'object' && img.name && img.name.trim() !== ''
                );

                console.log('🔵 hasNamedImages:', hasNamedImages);

                console.log('🔵 Processing ALL images...');
                // Use ALL uploaded images - even without names
                tour.images.forEach((imageData, index) => {
                    console.log(`🔵 Processing image ${index}:`, imageData);
                    if (typeof imageData === 'object' && imageData.url) {
                        const imagePath = getImagePath(imageData.url);
                        const imageName = (imageData.name && imageData.name.trim()) ? imageData.name : `Location ${index + 1}`;
                        console.log(`🔵 Adding location: ${imageName}, path: ${imagePath}`);
                        locations.push({
                            name: imageName,
                            location: imageData.location || '',
                            image: imagePath
                        });
                    } else {
                        console.log(`🔵 Skipping image ${index} - invalid format`);
                    }
                });
                console.log('🔵 Total locations added:', locations.length);
            }

            // Priority 2: If no named images, use itinerary data
            if (locations.length === 0 && tour.itinerary && Array.isArray(tour.itinerary) && tour.itinerary.length > 0) {
                // Create location cards from itinerary
                tour.itinerary.forEach((day, index) => {
                    const locationName = day.title || `Day ${day.day || index + 1}`;

                    // Get image based on location
                    let imageUrl = 'https://images.unsplash.com/photo-1469854523086-cc02fe5d8800?w=400';

                    if (locationName.toLowerCase().includes('registan')) {
                        imageUrl = 'https://images.unsplash.com/photo-1597212618440-806262de4f6b?w=400';
                    } else if (locationName.toLowerCase().includes('gur-e-amir') || locationName.toLowerCase().includes('mausoleum')) {
                        imageUrl = 'https://images.unsplash.com/photo-1588417659248-df8cbb59e1a5?w=400';
                    } else if (locationName.toLowerCase().includes('ulugbek') || locationName.toLowerCase().includes('observatory')) {
                        imageUrl = 'https://images.unsplash.com/photo-1534131707746-25d604851a7f?w=400';
                    } else if (locationName.toLowerCase().includes('bukhara') || locationName.toLowerCase().includes('ark')) {
                        imageUrl = 'https://images.unsplash.com/photo-1564507592333-c60657eea523?w=400';
                    } else if (locationName.toLowerCase().includes('chimgan') || locationName.toLowerCase().includes('mountain')) {
                        imageUrl = 'https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=400';
                    }

                    locations.push({
                        name: locationName,
                        duration: `(Day ${day.day || index + 1})`,
                        image: imageUrl
                    });
                });
            }

            // Priority 3: Fallback to popular destinations
            if (locations.length === 0) {
                locations.push(
                    {
                        name: 'Registan Square',
                        duration: '(Half Day)',
                        image: 'https://images.unsplash.com/photo-1597212618440-806262de4f6b?w=400'
                    },
                    {
                        name: 'Gur-e-Amir Mausoleum',
                        duration: '(2 Hours)',
                        image: 'https://images.unsplash.com/photo-1588417659248-df8cbb59e1a5?w=400'
                    },
                    {
                        name: 'Ark Fortress',
                        duration: '(3 Hours)',
                        image: 'https://images.unsplash.com/photo-1564507592333-c60657eea523?w=400'
                    }
                );
            }

            // Generate HTML for location cards
            console.log('🔵 Generating HTML for', locations.length, 'locations');
            console.log('🔵 Locations array:', locations);
            locationsContainer.innerHTML = locations.map(location => {
                // Create clickable card that opens Google Maps modal if location exists
                let cardHTML = '';
                const locationEscaped = (location.location || '').replace(/'/g, "\\'");
                const nameEscaped = (location.name || '').replace(/'/g, "\\'");

                if (location.location && location.location.trim() !== '') {
                    // Make entire card clickable to open modal
                    cardHTML = `
                        <div class="location-card" onclick="openLocationModal('${nameEscaped}', '${locationEscaped}')" style="cursor: pointer; position: relative;">
                            <img src="${location.image}" alt="${location.name}" class="location-card-image">
                            <div style="position: absolute; top: 12px; right: 12px; background: rgba(255,255,255,0.95); width: 36px; height: 36px; border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 8px rgba(0,0,0,0.15);">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#6366f1" stroke-width="2">
                                    <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                                    <circle cx="12" cy="10" r="3"></circle>
                                </svg>
                            </div>
                            <div class="location-card-content">
                                <h3 class="location-card-title">${location.name}</h3>
                            </div>
                        </div>
                    `;
                } else {
                    // Regular card without click
                    cardHTML = `
                        <div class="location-card">
                            <img src="${location.image}" alt="${location.name}" class="location-card-image">
                            <div class="location-card-content">
                                <h3 class="location-card-title">${location.name}</h3>
                            </div>
                        </div>
                    `;
                }

                return cardHTML;
            }).join('');
            console.log('🔵 loadExploreLocations completed! HTML generated.');
        }

        function scrollLocations(direction) {
            const container = document.getElementById('locationsContainer');
            const scrollAmount = 300;

            if (direction === 'prev') {
                container.scrollBy({ left: -scrollAmount, behavior: 'smooth' });
            } else {
                container.scrollBy({ left: scrollAmount, behavior: 'smooth' });
            }
        }

        function openLocationModal(name, location) {
            const modal = document.getElementById('locationMapModal');
            const modalContent = document.getElementById('locationModalContent');
            const iframe = document.getElementById('mapIframe');
            const title = document.getElementById('modalLocationTitle');

            // Set title
            title.textContent = name;

            // Create Google Maps embed URL with satellite view and proper zoom
            // Parameters: t=k (satellite), z=17 (zoom level), output=embed (embed mode)
            const embedUrl = `https://maps.google.com/maps?q=${encodeURIComponent(location)}&t=k&z=17&output=embed&iwloc=near`;
            iframe.src = embedUrl;

            // Show modal
            modal.style.display = 'flex';

            // Prevent body scroll
            document.body.style.overflow = 'hidden';

            // Trigger animation with slight delay for smooth transition
            setTimeout(() => {
                modal.style.background = 'rgba(0, 0, 0, 0.7)';
                modalContent.style.transform = 'scale(1) translateY(0)';
                modalContent.style.opacity = '1';
            }, 10);
        }

        function closeLocationModal() {
            const modal = document.getElementById('locationMapModal');
            const modalContent = document.getElementById('locationModalContent');
            const iframe = document.getElementById('mapIframe');

            // Animate out
            modal.style.background = 'rgba(0, 0, 0, 0)';
            modalContent.style.transform = 'scale(0.7) translateY(-30px)';
            modalContent.style.opacity = '0';

            // Hide modal after animation
            setTimeout(() => {
                modal.style.display = 'none';
                iframe.src = '';
            }, 300);

            // Restore body scroll
            document.body.style.overflow = '';
        }

        // Close modal when clicking outside
        document.addEventListener('DOMContentLoaded', function() {
            const modal = document.getElementById('locationMapModal');
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    closeLocationModal();
                }
            });
        });

        function scrollToDay(index) {
            const dayElement = document.getElementById(`content-${index}`);
            if (dayElement) {
                // Open the day if it's not already open
                const header = dayElement.previousElementSibling;
                const icon = document.getElementById(`icon-${index}`);

                if (!dayElement.classList.contains('active')) {
                    dayElement.classList.add('active');
                    icon.classList.add('rotated');
                    header.classList.add('active');
                }

                // Scroll to the day with offset for sticky header
                const yOffset = -100;
                const y = header.getBoundingClientRect().top + window.pageYOffset + yOffset;
                window.scrollTo({ top: y, behavior: 'smooth' });
            }
        }

        function initializeMap(tour) {
            // Remove existing map if any
            if (tourMap) {
                tourMap.remove();
            }

            // Default coordinates (Uzbekistan center)
            let lat = 41.3775;
            let lng = 64.5853;
            let zoomLevel = 6;

            // Get coordinates based on tour location/destination
            const location = (tour.destination || tour.location || '').toLowerCase();
            const title = (tour.title || tour.name || '').toLowerCase();
            const highlights = (tour.highlights || []).join(' ').toLowerCase();

            // Location detection keywords
            const locationKeywords = {
                samarkand: {
                    lat: 39.6542,
                    lng: 66.9597,
                    zoom: 14,
                    keywords: ['samarkand', 'registan', 'shah-i-zinda', 'bibi-khanym', 'gur-e-amir', 'ulugbek', 'afrosiyob']
                },
                bukhara: {
                    lat: 39.7747,
                    lng: 64.4286,
                    zoom: 14,
                    keywords: ['bukhara', 'ark fortress', 'lyabi-hauz', 'poi kalyan', 'kalyan minaret', 'bolo hauz', 'chor minor']
                },
                chimgan: {
                    lat: 41.5575,
                    lng: 70.0106,
                    zoom: 14,
                    keywords: ['chimgan', 'charvak', 'beldersay', 'amirsoy', 'ski resort']
                },
                tashkent: {
                    lat: 41.2995,
                    lng: 69.2401,
                    zoom: 13,
                    keywords: ['tashkent', 'chorsu', 'hazrati imam', 'amir timur', 'broadway', 'minor mosque']
                },
                khiva: {
                    lat: 41.3775,
                    lng: 60.3644,
                    zoom: 14,
                    keywords: ['khiva', 'ichan kala', 'kalta minor', 'kunya ark', 'juma mosque', 'tash hauli']
                },
                fergana: {
                    lat: 40.3864,
                    lng: 71.7864,
                    zoom: 13,
                    keywords: ['fergana', 'kokand', 'margilan', 'rishtan', 'silk road']
                },
                nukus: {
                    lat: 42.4531,
                    lng: 59.6103,
                    zoom: 13,
                    keywords: ['nukus', 'savitsky museum', 'karakalpakstan', 'aral sea']
                },
                termez: {
                    lat: 37.2242,
                    lng: 67.2783,
                    zoom: 13,
                    keywords: ['termez', 'fayaz tepe', 'kirk kiz', 'buddhist']
                }
            };

            // Check location and title first
            let locationFound = false;
            for (const [city, data] of Object.entries(locationKeywords)) {
                if (location.includes(city) || title.includes(city)) {
                    lat = data.lat;
                    lng = data.lng;
                    zoomLevel = data.zoom;
                    locationFound = true;
                    break;
                }
            }

            // If not found, check highlights for location keywords
            if (!locationFound && highlights) {
                for (const [city, data] of Object.entries(locationKeywords)) {
                    for (const keyword of data.keywords) {
                        if (highlights.includes(keyword)) {
                            lat = data.lat;
                            lng = data.lng;
                            zoomLevel = data.zoom;
                            locationFound = true;
                            break;
                        }
                    }
                    if (locationFound) break;
                }
            }

            // Initialize the map
            tourMap = L.map('tourMap', {
                zoomControl: true,
                attributionControl: true
            }).setView([lat, lng], zoomLevel);

            // Add Google Maps tiles (clear and high quality)
            L.tileLayer('https://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}', {
                maxZoom: 20,
                subdomains: ['mt0', 'mt1', 'mt2', 'mt3'],
                attribution: '&copy; <a href="https://maps.google.com">Google Maps</a>'
            }).addTo(tourMap);

            // Function to automatically fetch coordinates via backend proxy (no CORS issues)
            async function getAttractionCoordinates(attractionName, cityContext = '') {
                try {
                    // Use backend proxy to avoid CORS issues
                    const url = cityContext
                        ? `http://localhost:4000/api/geocoding/search?q=${encodeURIComponent(attractionName)}&city=${encodeURIComponent(cityContext)}`
                        : `http://localhost:4000/api/geocoding/search?q=${encodeURIComponent(attractionName)}`;

                    const response = await fetch(url);
                    const result = await response.json();

                    if (result.success && result.data) {
                        return result.data;
                    }
                    return null;
                } catch (error) {
                    console.error('Error fetching coordinates for:', attractionName, error);
                    return null;
                }
            }

            // Cache for attraction coordinates to avoid repeated API calls
            const attractionCache = {};

            // Array to store all markers for bounds calculation
            const markers = [];

            // Create custom icon
            const customIcon = L.divIcon({
                className: 'custom-marker',
                html: `<div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                              width: 40px; height: 40px; border-radius: 50% 50% 50% 0;
                              border: 3px solid white; box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                              transform: rotate(-45deg); display: flex; align-items: center; justify-content: center;">
                         <svg width="20" height="20" viewBox="0 0 24 24" fill="white" style="transform: rotate(45deg);">
                           <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
                         </svg>
                       </div>`,
                iconSize: [40, 40],
                iconAnchor: [20, 40],
                popupAnchor: [0, -40]
            });

            // Smaller icon for attractions
            const attractionIcon = L.divIcon({
                className: 'custom-marker',
                html: `<div style="background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
                              width: 32px; height: 32px; border-radius: 50% 50% 50% 0;
                              border: 2px solid white; box-shadow: 0 3px 8px rgba(0,0,0,0.3);
                              transform: rotate(-45deg); display: flex; align-items: center; justify-content: center;">
                         <svg width="16" height="16" viewBox="0 0 24 24" fill="white" style="transform: rotate(45deg);">
                           <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                         </svg>
                       </div>`,
                iconSize: [32, 32],
                iconAnchor: [16, 32],
                popupAnchor: [0, -32]
            });

            // Add main tour marker
            const mainMarker = L.marker([lat, lng], { icon: customIcon }).addTo(tourMap);
            mainMarker.bindPopup(`
                <div style="text-align: center; padding: 12px; min-width: 220px;">
                    <h4 style="margin: 0 0 10px 0; color: #667eea; font-size: 16px; font-weight: 600;">
                        ${tour.title || tour.name}
                    </h4>
                    <p style="margin: 0 0 10px 0; color: #6b7280; font-size: 14px;">
                        ${tour.destination || tour.location}
                    </p>
                    <p style="margin: 0 0 12px 0; font-weight: 600; color: #667eea; font-size: 18px;">
                        $${tour.discountPrice || tour.price}
                    </p>
                    <a href="https://www.google.com/maps?q=${lat},${lng}" target="_blank" style="
                        display: inline-flex;
                        align-items: center;
                        gap: 5px;
                        padding: 8px 16px;
                        background: #4285f4;
                        color: white;
                        text-decoration: none;
                        border-radius: 6px;
                        font-size: 13px;
                        font-weight: 500;
                        transition: all 0.3s;
                    " onmouseover="this.style.background='#3367d6'" onmouseout="this.style.background='#4285f4'">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
                        </svg>
                        Open in Google Maps
                    </a>
                </div>
            `).openPopup();
            markers.push(mainMarker);

            // Store route coordinates
            const routeCoordinates = [[lat, lng]];

            // Add markers for highlights - automatically fetch coordinates from OpenStreetMap
            if (tour.highlights && Array.isArray(tour.highlights) && tour.highlights.length > 0) {
                // Get city context from location for better search accuracy
                const cityContext = tour.destination || tour.location || '';

                // Create a loading indicator
                const loadingEl = document.createElement('div');
                loadingEl.className = 'text-center text-muted mt-3';
                loadingEl.innerHTML = '<small>Loading attraction locations...</small>';
                document.getElementById('tourMap').insertAdjacentElement('beforebegin', loadingEl);

                // Process highlights asynchronously
                const highlightPromises = tour.highlights.map(async (highlight, index) => {
                    // Check cache first
                    const cacheKey = highlight.toLowerCase();
                    let coords = attractionCache[cacheKey];

                    if (!coords) {
                        // Add small delay between requests to respect Nominatim usage policy (max 1 request per second)
                        await new Promise(resolve => setTimeout(resolve, index * 1100));
                        coords = await getAttractionCoordinates(highlight, cityContext);

                        if (coords) {
                            attractionCache[cacheKey] = coords; // Cache the result
                        }
                    }

                    if (coords) {
                        const attractionMarker = L.marker([coords.lat, coords.lng], { icon: attractionIcon }).addTo(tourMap);
                        attractionMarker.bindPopup(`
                            <div style="text-align: center; padding: 10px; min-width: 180px;">
                                <h5 style="margin: 0 0 8px 0; color: #3b82f6; font-size: 14px; font-weight: 600;">
                                    ${coords.name}
                                </h5>
                                <p style="margin: 0 0 10px 0; color: #6b7280; font-size: 12px;">
                                    ${highlight}
                                </p>
                                <a href="https://www.google.com/maps?q=${coords.lat},${coords.lng}" target="_blank" style="
                                    display: inline-flex;
                                    align-items: center;
                                    gap: 4px;
                                    padding: 6px 12px;
                                    background: #4285f4;
                                    color: white;
                                    text-decoration: none;
                                    border-radius: 5px;
                                    font-size: 11px;
                                    font-weight: 500;
                                    transition: all 0.3s;
                                " onmouseover="this.style.background='#3367d6'" onmouseout="this.style.background='#4285f4'">
                                    <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
                                    </svg>
                                    View on Google Maps
                                </a>
                            </div>
                        `);
                        markers.push(attractionMarker);
                        routeCoordinates.push([coords.lat, coords.lng]);
                        return coords;
                    }
                    return null;
                });

                // Wait for all highlights to be processed
                Promise.all(highlightPromises).then(() => {
                    // Remove loading indicator
                    loadingEl.remove();

                    // Fit map to show all markers after they're loaded
                    if (markers.length > 1) {
                        const group = L.featureGroup(markers);
                        tourMap.fitBounds(group.getBounds().pad(0.1));
                    }

                    // Draw the route after all markers are placed
                    drawRoute();
                }).catch(error => {
                    console.error('Error loading attractions:', error);
                    loadingEl.innerHTML = '<small class="text-danger">Some attractions could not be loaded</small>';
                });
            }

            // Function to draw animated route
            function drawRoute() {
                // Draw animated route connecting all markers
                if (routeCoordinates.length > 1) {
                    // Create the route polyline with dashed animation
                    const route = L.polyline(routeCoordinates, {
                        color: '#3b82f6',
                        weight: 4,
                        opacity: 0.7,
                        smoothFactor: 1,
                        className: 'animated-route',
                        dashArray: '10, 15',
                        lineCap: 'round',
                        lineJoin: 'round'
                    }).addTo(tourMap);

                    // Add a shadow/outline to the route
                    L.polyline(routeCoordinates, {
                        color: '#1e40af',
                        weight: 6,
                        opacity: 0.3,
                        smoothFactor: 1,
                        dashArray: '10, 15',
                        lineCap: 'round',
                        lineJoin: 'round'
                    }).addTo(tourMap);

                    // Add direction arrows on the route
                    routeCoordinates.forEach((coord, index) => {
                        if (index < routeCoordinates.length - 1) {
                            const nextCoord = routeCoordinates[index + 1];
                            const midLat = (coord[0] + nextCoord[0]) / 2;
                            const midLng = (coord[1] + nextCoord[1]) / 2;

                            // Calculate angle for arrow direction
                            const angle = Math.atan2(nextCoord[0] - coord[0], nextCoord[1] - coord[1]) * 180 / Math.PI;

                            const arrowIcon = L.divIcon({
                                html: `<div style="
                                    transform: rotate(${angle}deg);
                                    font-size: 20px;
                                    color: #3b82f6;
                                    text-shadow: 0 0 3px white, 0 0 5px white;
                                    font-weight: bold;
                                ">▶</div>`,
                                className: 'route-arrow',
                                iconSize: [20, 20],
                                iconAnchor: [10, 10]
                            });

                            L.marker([midLat, midLng], {
                                icon: arrowIcon,
                                interactive: false
                            }).addTo(tourMap);
                        }
                    });

                    // Add numbered waypoint markers
                    routeCoordinates.forEach((coord, index) => {
                        if (index > 0) { // Skip the first one as it's the main marker
                            const waypointIcon = L.divIcon({
                                html: `<div style="
                                    background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
                                    width: 28px;
                                    height: 28px;
                                    border-radius: 50%;
                                    border: 2px solid white;
                                    box-shadow: 0 2px 8px rgba(0,0,0,0.3);
                                    display: flex;
                                    align-items: center;
                                    justify-content: center;
                                    color: white;
                                    font-weight: bold;
                                    font-size: 12px;
                                ">${index}</div>`,
                                className: 'waypoint-marker',
                                iconSize: [28, 28],
                                iconAnchor: [14, 14]
                            });

                            L.marker(coord, {
                                icon: waypointIcon,
                                interactive: false
                            }).addTo(tourMap);
                        }
                    });
                }
            }
        }

        function setupPriceCalculator() {
            const travelersSelect = document.getElementById('travelers');
            travelersSelect.addEventListener('change', updateTotalPrice);
            updateTotalPrice();
        }

        function updateTotalPrice() {
            if (!currentTour) return;

            const travelers = parseInt(document.getElementById('travelers').value);
            const pricePerPerson = currentTour.discountPrice || currentTour.price;
            const total = pricePerPerson * travelers;

            document.getElementById('totalPrice').textContent = `$${total}`;
        }

        function setMinDate() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('tourDate').setAttribute('min', today);
        }

        function bookNow() {
            if (!currentTour) {
                alert('Tour information not loaded');
                return;
            }

            const travelers = document.getElementById('travelers').value;
            const date = document.getElementById('tourDate').value;

            if (!date) {
                alert('Please select a tour date');
                return;
            }

            const message = `Booking Request:\n\nTour: ${currentTour.title || currentTour.name}\nDate: ${date}\nTravelers: ${travelers}\nTotal: ${document.getElementById('totalPrice').textContent}`;

            alert(message + '\n\nThank you! We will contact you shortly to confirm your booking.');
        }

        // Itinerary accordion functions
        let allExpanded = false;

        function toggleItinerary(index) {
            const content = document.getElementById(`content-${index}`);
            const icon = document.getElementById(`icon-${index}`);
            const header = content.previousElementSibling;

            content.classList.toggle('active');
            icon.classList.toggle('rotated');
            header.classList.toggle('active');
        }

        function toggleItineraryDay(index) {
            const items = document.querySelectorAll('#itineraryDaysList .itinerary-item');
            const item = items[index];
            if (!item) return;

            const header = item.querySelector('.itinerary-header');
            const content = item.querySelector('.itinerary-content');
            const icon = item.querySelector('.expand-icon');

            content.classList.toggle('active');
            icon.classList.toggle('rotated');
            header.classList.toggle('active');
        }

        function toggleExpandAll() {
            const allContents = document.querySelectorAll('.itinerary-content');
            const allIcons = document.querySelectorAll('.expand-icon');
            const allHeaders = document.querySelectorAll('.itinerary-header');
            const expandAllText = document.getElementById('expandAllText');
            const expandAllIcon = document.getElementById('expandAllIcon');

            allExpanded = !allExpanded;

            if (allExpanded) {
                allContents.forEach(content => content.classList.add('active'));
                allIcons.forEach(icon => icon.classList.add('rotated'));
                allHeaders.forEach(header => header.classList.add('active'));
                expandAllText.textContent = 'Collapse All';
                expandAllIcon.classList.add('rotated');
            } else {
                allContents.forEach(content => content.classList.remove('active'));
                allIcons.forEach(icon => icon.classList.remove('rotated'));
                allHeaders.forEach(header => header.classList.remove('active'));
                expandAllText.textContent = 'Expand All';
                expandAllIcon.classList.remove('rotated');
            }
        }

        // Language selector functionality
        document.addEventListener('DOMContentLoaded', function() {
            const languageBtn = document.querySelector('.language-btn');
            const languageDropdown = document.querySelector('.language-dropdown');
            const langOptions = document.querySelectorAll('.lang-option');
            const currentLangSpan = document.getElementById('currentLang');

            if (languageBtn && languageDropdown) {
                languageBtn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    languageDropdown.style.display = languageDropdown.style.display === 'none' ? 'block' : 'none';
                });

                document.addEventListener('click', function() {
                    languageDropdown.style.display = 'none';
                });

                langOptions.forEach(option => {
                    option.addEventListener('click', function(e) {
                        e.preventDefault();
                        const selectedLang = this.getAttribute('data-lang');
                        const flagImg = this.querySelector('img').cloneNode(true);
                        const btn = document.querySelector('.language-btn');
                        const oldFlag = btn.querySelector('img');
                        btn.replaceChild(flagImg, oldFlag);
                        currentLangSpan.textContent = selectedLang;
                        languageDropdown.style.display = 'none';
                    });

                    option.addEventListener('mouseenter', function() {
                        this.style.background = 'linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%)';
                        this.style.color = 'white';
                    });

                    option.addEventListener('mouseleave', function() {
                        this.style.background = 'transparent';
                        this.style.color = '#1f2937';
                    });
                });

                languageBtn.addEventListener('mouseenter', function() {
                    this.style.background = 'rgba(99, 102, 241, 0.1)';
                });

                languageBtn.addEventListener('mouseleave', function() {
                    this.style.background = 'transparent';
                });
            }

            // Mobile language selector
            const languageBtnMobile = document.querySelector('.language-btn-mobile');
            const languageDropdownMobile = document.querySelector('.language-dropdown-mobile');
            const langOptionsMobile = document.querySelectorAll('.lang-option-mobile');
            const currentLangMobileSpan = document.getElementById('currentLangMobile');

            if (languageBtnMobile && languageDropdownMobile) {
                languageBtnMobile.addEventListener('click', function(e) {
                    e.stopPropagation();
                    languageDropdownMobile.style.display = languageDropdownMobile.style.display === 'none' ? 'block' : 'none';
                });

                document.addEventListener('click', function() {
                    languageDropdownMobile.style.display = 'none';
                });

                langOptionsMobile.forEach(option => {
                    option.addEventListener('click', function(e) {
                        e.preventDefault();
                        const selectedLang = this.getAttribute('data-lang');
                        currentLangMobileSpan.textContent = selectedLang;
                        languageDropdownMobile.style.display = 'none';
                    });

                    option.addEventListener('mouseenter', function() {
                        this.style.background = 'linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%)';
                        this.style.color = 'white';
                    });

                    option.addEventListener('mouseleave', function() {
                        this.style.background = 'transparent';
                        this.style.color = '#1f2937';
                    });
                });

                languageBtnMobile.addEventListener('mouseenter', function() {
                    this.style.background = 'rgba(99, 102, 241, 0.1)';
                });

                languageBtnMobile.addEventListener('mouseleave', function() {
                    this.style.background = 'transparent';
                });
            }
        });

        // ========== DYNAMIC CATEGORY MENU WITH DROPDOWN ==========

        // Load categories and populate menu with dropdowns
        async function loadCategoryMenu() {
            try {
                const response = await fetch('http://localhost:4000/api/categories?active=true');
                const result = await response.json();

                if (result.success && result.data.categories) {
                    const categories = result.data.categories;
                    const menuList = document.querySelector('.menu-list');

                    if (!menuList) return;

                    // Remove existing category items to prevent duplicates
                    menuList.querySelectorAll('.has-dropdown').forEach(item => item.remove());

                    // Find the "About" link to insert categories before it
                    const aboutLink = Array.from(menuList.querySelectorAll('a')).find(a => a.textContent.includes('About'));
                    const aboutLi = aboutLink ? aboutLink.parentElement : null;

                    if (!aboutLi) return;

                    // Load tours for each category and create dropdown
                    for (const category of categories.reverse()) {
                        // Fetch tours for this category
                        const categoryMap = {
                            'cultural-tours': 'cultural',
                            'adventure-tours': 'adventure',
                            'homestays-hiking': 'hiking',
                            'day-trips': 'day-trip'
                        };

                        const categoryValue = categoryMap[category.slug];
                        const toursResponse = await fetch(`http://localhost:4000/api/tours?category=${categoryValue}`);
                        const toursResult = await toursResponse.json();

                        const li = document.createElement('li');
                        li.className = 'has-dropdown';

                        const a = document.createElement('a');
                        a.href = `#${category.slug}`;
                        a.textContent = category.name;

                        // Add click event for mobile to toggle dropdown
                        a.addEventListener('click', function(e) {
                            // On mobile, toggle dropdown
                            if (window.innerWidth < 1200) {
                                e.preventDefault();
                                li.classList.toggle('open');
                            }
                        });

                        li.appendChild(a);

                        // Create dropdown submenu if tours exist
                        if (toursResult.success && toursResult.data.tours.length > 0) {
                            const submenu = document.createElement('ul');
                            submenu.className = 'submenu';

                            toursResult.data.tours.forEach(tour => {
                                const subLi = document.createElement('li');
                                const subA = document.createElement('a');
                                subA.href = `tour-details.html?id=${tour.id}`;
                                subA.textContent = tour.title;
                                subLi.appendChild(subA);
                                submenu.appendChild(subLi);
                            });

                            li.appendChild(submenu);
                        }

                        // Insert before "About" li
                        menuList.insertBefore(li, aboutLi);
                    }
                }
            } catch (error) {
                console.error('Error loading category menu:', error);
            }
        }

        // Load category menu when page loads
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', loadCategoryMenu);
        } else {
            loadCategoryMenu();
        }
    </script>
</body>
</html>
