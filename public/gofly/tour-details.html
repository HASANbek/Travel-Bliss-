<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="pageTitle">Tour Details - Travel Bliss</title>
    <link rel="icon" href="assets/img/fav-icon.svg" type="image/svg+xml">

    <!-- CSS Files -->
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css">
    <link rel="stylesheet" href="assets/css/swiper-bundle.min.css">
    <link rel="stylesheet" href="assets/css/slick.css">
    <link rel="stylesheet" href="assets/css/animate.min.css">
    <link rel="stylesheet" href="assets/css/jquery.fancybox.min.css">
    <link rel="stylesheet" href="assets/css/daterangepicker.css">
    <link rel="stylesheet" href="assets/css/jquery-ui.css">
    <link rel="stylesheet" href="assets/css/style.css?v=3">

    <style>
        :root {
            --travel-bliss-blue: #6366f1;
            --travel-bliss-blue-dark: #4f46e5;
            --travel-bliss-blue-light: #818cf8;
            --travel-bliss-gold: #f59e0b;
            --travel-bliss-gold-dark: #d97706;
            --text-primary: #333;
            --text-secondary: #767676;
            --bg-light: #FAFAFA;
            --border-color: #E0E0E0;
        }

        body {
            background: #FAFAFA;
            font-family: 'Trip Sans', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        /* Header Home Button Style */
        .menu-list li.active a {
            background: #6366f1 !important;
            color: white !important;
            padding: 12px 24px !important;
            border-radius: 8px !important;
        }

        /* Photo Grid Gallery */
        .photo-grid-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .photo-grid {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr;
            grid-template-rows: 1fr 1fr;
            gap: 8px;
            height: 500px;
            border-radius: 12px;
            overflow: hidden;
            position: relative;
        }

        .photo-grid-item {
            position: relative;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .photo-grid-item:hover {
            filter: brightness(0.9);
        }

        .photo-grid-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .photo-grid-item:first-child {
            grid-row: 1 / 3;
        }

        .show-all-photos {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: white;
            border: 1px solid #333;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
            z-index: 10;
        }

        .show-all-photos:hover {
            background: #f0f0f0;
        }

        /* Title Overlay */
        .title-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(to top, rgba(0,0,0,0.7) 0%, transparent 100%);
            padding: 40px 20px 20px;
            color: white;
        }

        .title-overlay h1 {
            font-size: 42px;
            font-weight: 700;
            margin: 0 0 10px 0;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .rating-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: rgba(255,255,255,0.95);
            padding: 8px 16px;
            border-radius: 20px;
            color: #333;
            font-weight: 600;
        }

        .stars {
            color: var(--travel-bliss-blue);
            font-size: 18px;
        }

        .review-count {
            color: #767676;
            font-size: 14px;
        }

        /* Action Buttons */
        .action-buttons {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
            z-index: 10;
        }

        .action-btn {
            background: white;
            border: none;
            padding: 10px 16px;
            border-radius: 25px;
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }

        .action-btn:hover {
            background: #f0f0f0;
        }

        /* Sticky Navigation */
        .sticky-nav {
            position: sticky;
            top: 0;
            background: white;
            border-bottom: 1px solid var(--border-color);
            z-index: 100;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .sticky-nav .container {
            max-width: 1400px;
        }

        .sticky-nav-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 20px;
        }

        .sticky-nav-content .nav-tabs {
            flex: 1;
            min-width: 0;
        }

        /* PDF Download Button */
        .btn-download-pdf {
            background: linear-gradient(135deg, var(--travel-bliss-blue), var(--travel-bliss-blue-dark));
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
            white-space: nowrap;
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
        }

        .btn-download-pdf:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(99, 102, 241, 0.4);
            background: linear-gradient(135deg, var(--travel-bliss-blue-dark), var(--travel-bliss-blue));
        }

        .btn-download-pdf i {
            font-size: 20px;
        }

        .btn-download-pdf:active {
            transform: translateY(0);
        }

        .nav-tabs {
            border: none;
            overflow-x: auto;
            white-space: nowrap;
            scrollbar-width: none;
        }

        .nav-tabs::-webkit-scrollbar {
            display: none;
        }

        .nav-tabs .nav-link {
            border: none;
            color: var(--text-secondary);
            padding: 20px 24px;
            font-weight: 600;
            font-size: 15px;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }

        .nav-tabs .nav-link:hover {
            color: var(--text-primary);
            border-color: #ddd;
        }

        .nav-tabs .nav-link.active {
            color: var(--text-primary);
            border-color: var(--travel-bliss-blue);
            background: none;
        }

        /* Main Content Area */
        .content-wrapper {
            max-width: 1400px;
            margin: 30px auto;
            padding: 0 20px;
            display: grid;
            grid-template-columns: 1fr 380px;
            gap: 30px;
            align-items: start;
        }

        .main-content {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        /* Sidebar Booking Card */
        .booking-sidebar {
            position: sticky;
            top: 90px;
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.12);
            border: 1px solid var(--border-color);
        }

        .price-section {
            margin-bottom: 20px;
        }

        .price-from {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 5px;
        }

        .price-amount {
            font-size: 36px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .price-amount small {
            font-size: 16px;
            font-weight: 400;
            color: var(--text-secondary);
        }

        .per-person {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .booking-form {
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .form-control {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 15px;
            transition: all 0.3s;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--travel-bliss-blue);
            box-shadow: 0 0 0 3px rgba(0, 170, 108, 0.1);
        }

        .check-availability-btn {
            width: 100%;
            background: var(--travel-bliss-blue);
            color: white;
            border: none;
            padding: 16px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 15px;
        }

        .check-availability-btn:hover {
            background: var(--travel-bliss-blue-dark);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 170, 108, 0.3);
        }

        .cancellation-badge {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px;
            background: #F0FFF8;
            border-radius: 8px;
            margin-bottom: 15px;
            color: var(--travel-bliss-blue);
            font-size: 14px;
            font-weight: 600;
        }

        .tripadvisor-rating {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 15px;
            background: #F7F7F7;
            border-radius: 8px;
        }

        .rating-bubble {
            width: 50px;
            height: 50px;
            background: var(--travel-bliss-blue);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 20px;
        }

        .rating-details {
            flex: 1;
        }

        .rating-details .rating-circles {
            color: var(--travel-bliss-blue);
            font-size: 16px;
            margin-bottom: 2px;
        }

        .rating-details .rating-text {
            font-size: 12px;
            color: var(--text-secondary);
        }

        /* Overview Section */
        .section-title {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--text-primary);
        }

        .highlights-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        .highlight-item {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            padding: 15px;
            background: #F9F9F9;
            border-radius: 8px;
        }

        .highlight-icon {
            width: 24px;
            height: 24px;
            color: var(--travel-bliss-blue);
            flex-shrink: 0;
        }

        .highlight-text {
            flex: 1;
        }

        .highlight-text strong {
            display: block;
            margin-bottom: 3px;
            color: var(--text-primary);
        }

        .highlight-text span {
            font-size: 14px;
            color: var(--text-secondary);
        }

        /* Timeline Itinerary */
        .timeline-itinerary {
            position: relative;
            padding-left: 80px;
        }

        .timeline-item {
            position: relative;
            margin-bottom: 5px;
            padding-bottom: 5px;
            border-bottom: 1px solid #f0f0f0;
        }

        .timeline-item:last-child {
            border-bottom: none;
        }

        .timeline-marker {
            position: absolute;
            left: -60px;
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, var(--travel-bliss-blue), var(--travel-bliss-blue-light));
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 11px;
            box-shadow: 0 3px 8px rgba(99, 102, 241, 0.25);
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -40px;
            top: 45px;
            bottom: -5px;
            width: 2px;
            background: linear-gradient(to bottom, var(--travel-bliss-blue-light), #E0E0E0);
        }

        .timeline-item:last-child::before {
            display: none;
        }

        .timeline-content h4 {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--text-primary);
        }

        .timeline-content p {
            color: var(--text-secondary);
            line-height: 1.5;
            margin-bottom: 5px;
        }

        .timeline-activities {
            list-style: none;
            padding: 0;
            margin: 5px 0 0 0;
        }

        .timeline-activities li {
            padding: 2px 0;
            padding-left: 20px;
            position: relative;
            color: var(--text-secondary);
            line-height: 1.4;
        }

        .timeline-activities li::before {
            content: '✓';
            position: absolute;
            left: 0;
            color: var(--travel-bliss-blue);
            font-weight: 700;
        }

        /* Expand/Collapse Buttons */
        .btn-toggle-all {
            background: white;
            border: 2px solid var(--travel-bliss-blue);
            color: var(--travel-bliss-blue);
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-left: 10px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-toggle-all:hover {
            background: var(--travel-bliss-blue);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
        }

        .btn-toggle-all i {
            font-size: 16px;
        }

        /* Collapsible Timeline Items */
        .timeline-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 0px;
            cursor: pointer;
            padding: 8px;
            margin: -8px -8px 0px -8px;
            border-radius: 8px;
            transition: background-color 0.2s ease;
        }

        .timeline-header:hover {
            background-color: rgba(99, 102, 241, 0.05);
        }

        .timeline-toggle-icon {
            color: var(--travel-bliss-blue);
            font-size: 20px;
            transition: transform 0.3s ease;
        }

        .timeline-item.collapsed .timeline-toggle-icon {
            transform: rotate(-90deg);
        }

        .timeline-body {
            overflow: hidden;
            transition: max-height 0.3s ease, opacity 0.3s ease;
            margin-top: 8px;
        }

        .timeline-body p {
            margin: 0 0 8px 0;
            line-height: 1.5;
        }

        .timeline-body ul {
            margin: 8px 0;
            padding-left: 20px;
        }

        .timeline-body ul li {
            margin: 3px 0;
            line-height: 1.4;
        }

        .timeline-item.collapsed .timeline-body {
            max-height: 0 !important;
            opacity: 0;
        }

        /* Included/Excluded Lists */
        .inclusion-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 20px 0;
        }

        .inclusion-section h4 {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 15px;
            color: var(--text-primary);
        }

        .inclusion-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .inclusion-list li {
            padding: 12px 0;
            display: flex;
            align-items: flex-start;
            gap: 12px;
            border-bottom: 1px solid #f0f0f0;
            color: var(--text-secondary);
        }

        .inclusion-list li:last-child {
            border-bottom: none;
        }

        .inclusion-list.included li::before {
            content: '✓';
            width: 24px;
            height: 24px;
            background: var(--travel-bliss-blue);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            flex-shrink: 0;
        }

        .inclusion-list.excluded li::before {
            content: '✕';
            width: 24px;
            height: 24px;
            background: #dc3545;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            flex-shrink: 0;
        }

        /* Reviews Section */
        .reviews-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border-color);
        }

        .reviews-summary {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .rating-score {
            width: 80px;
            height: 80px;
            background: var(--travel-bliss-blue);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 32px;
        }

        .rating-breakdown {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .review-card {
            padding: 25px;
            border: 1px solid var(--border-color);
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .review-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .reviewer-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--travel-bliss-blue);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 20px;
        }

        .reviewer-info h5 {
            font-size: 16px;
            font-weight: 700;
            margin: 0 0 5px 0;
        }

        .reviewer-info .review-date {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .review-rating {
            color: var(--travel-bliss-blue);
            font-size: 16px;
            margin-bottom: 10px;
        }

        .review-text {
            color: var(--text-secondary);
            line-height: 1.6;
        }

        /* Photo Gallery Section */
        .photo-gallery-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin: 20px 0;
        }

        .gallery-photo {
            aspect-ratio: 1;
            border-radius: 8px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s;
        }

        .gallery-photo:hover {
            transform: scale(1.05);
        }

        .gallery-photo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* FAQ Accordion */
        .faq-accordion .accordion-item {
            border: 1px solid var(--border-color);
            border-radius: 8px;
            margin-bottom: 15px;
            overflow: hidden;
        }

        .faq-accordion .accordion-button {
            font-weight: 600;
            font-size: 16px;
            padding: 20px 24px;
            background: white;
            color: var(--text-primary);
        }

        .faq-accordion .accordion-button:not(.collapsed) {
            background: #F9F9F9;
            color: var(--travel-bliss-blue);
            box-shadow: none;
        }

        .faq-accordion .accordion-button:focus {
            box-shadow: none;
            border-color: var(--border-color);
        }

        .faq-accordion .accordion-body {
            padding: 20px 24px;
            color: var(--text-secondary);
            line-height: 1.6;
        }

        /* Trust Badges */
        .trust-badges {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: #F9F9F9;
            border-radius: 8px;
            margin-top: 20px;
        }

        .trust-badge {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
            color: var(--text-secondary);
        }

        .trust-badge i {
            color: var(--travel-bliss-blue);
            font-size: 18px;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .content-wrapper {
                grid-template-columns: 1fr;
            }

            .booking-sidebar {
                position: static;
                margin-top: 30px;
            }

            .photo-grid {
                height: 400px;
                grid-template-columns: 1fr 1fr;
            }

            .highlights-grid {
                grid-template-columns: 1fr;
            }

            .inclusion-grid {
                grid-template-columns: 1fr;
            }

            .photo-gallery-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (max-width: 768px) {
            .photo-grid {
                height: 300px;
                grid-template-columns: 1fr;
                grid-template-rows: repeat(5, 1fr);
            }

            .photo-grid-item:first-child {
                grid-row: 1 / 3;
            }

            .title-overlay h1 {
                font-size: 28px;
            }

            .nav-tabs .nav-link {
                padding: 15px 16px;
                font-size: 14px;
            }

            /* Responsive itinerary controls */
            .itinerary-controls {
                display: flex;
                flex-direction: column;
                gap: 8px;
                width: 100%;
                margin-top: 15px;
            }

            .btn-toggle-all {
                width: 100%;
                justify-content: center;
                margin-left: 0;
            }

            #itinerary > div:first-child {
                flex-direction: column !important;
                align-items: flex-start !important;
            }

            .timeline-itinerary {
                padding-left: 50px;
            }

            .timeline-marker {
                left: -45px;
                width: 38px;
                height: 38px;
                font-size: 10px;
            }

            .timeline-item::before {
                left: -27px;
            }

            .main-content {
                padding: 20px;
            }

            /* Responsive sticky nav */
            .sticky-nav-content {
                flex-direction: column;
                align-items: stretch;
                gap: 10px;
                padding: 10px 0;
            }

            .btn-download-pdf {
                width: 100%;
                justify-content: center;
                order: -1; /* Put button on top on mobile */
            }

            .nav-tabs {
                justify-content: center;
            }

            .section-title {
                font-size: 24px;
            }

            .timeline-itinerary {
                padding-left: 50px;
            }

            .timeline-marker {
                left: -45px;
                width: 35px;
                height: 35px;
                font-size: 9px;
            }

            .timeline-item::before {
                left: -27px;
            }

            .photo-gallery-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* Loading State */
        .skeleton {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }

        @keyframes loading {
            0% {
                background-position: 200% 0;
            }
            100% {
                background-position: -200% 0;
            }
        }
    </style>

    <!-- jsPDF Library for PDF Generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>

<body class="tt-magic-cursor">

    <div id="magic-cursor">
        <div id="ball"></div>
    </div>

    <!-- Back To Top -->
    <div class="progress-wrap">
        <svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102">
            <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/>
        </svg>
        <svg class="arrow" width="22" height="25" viewBox="0 0 24 23" xmlns="http://www.w3.org/2000/svg">
            <path d="M0.556131 11.4439L11.8139 0.186067L13.9214 2.29352L13.9422 20.6852L9.70638 20.7061L9.76793 8.22168L3.6064 14.4941L0.556131 11.4439Z"/>
            <path d="M23.1276 11.4999L16.0288 4.40105L15.9991 10.4203L20.1031 14.5243L23.1276 11.4999Z"/>
        </svg>
    </div>

    <!-- Header Section Start -->
    <header class="header-area style-2 travel-agency3">
        <div class="container-fluid d-flex flex-nowrap align-items-center justify-content-between">
            <div class="logo-and-menu-area">
                <a href="travel-agency-03.html" class="header-logo">
                    <img src="assets/img/travel-bliss-logo.png" alt="Travel Bliss" style="height: 45px; width: auto; max-width: 200px; object-fit: contain;">
                </a>
                <div class="main-menu">
                    <div class="mobile-logo-area d-xl-none d-flex align-items-center justify-content-between">
                        <a href="travel-agency-03.html" class="mobile-logo-wrap">
                            <img src="assets/img/travel-bliss-logo.png" alt="Travel Bliss" style="height: 40px; width: auto; max-width: 60%; object-fit: contain;">
                        </a>
                        <div class="menu-close-btn">
                            <i class="bi bi-x"></i>
                        </div>
                    </div>
                    <ul class="menu-list">
                        <li class="active">
                            <a href="travel-agency-03.html">Home</a>
                        </li>
                        <li class="menu-item-has-children">
                            <a href="travel-agency-03.html#day-trips" class="drop-down">Day Trips<i class="bi bi-caret-down-fill"></i></a>
                            <i class="bi bi-plus dropdown-icon"></i>
                            <ul class="sub-menu">
                                <li><a href="tour-details.html?id=1">Samarkand City Tour</a></li>
                            </ul>
                        </li>
                        <li class="menu-item-has-children">
                            <a href="travel-agency-03.html#homestays" class="drop-down">Homestays & Hiking<i class="bi bi-caret-down-fill"></i></a>
                            <i class="bi bi-plus dropdown-icon"></i>
                            <ul class="sub-menu">
                                <li><a href="tour-details.html?id=3">Chimgan Mountains Adventure</a></li>
                            </ul>
                        </li>
                        <li class="menu-item-has-children">
                            <a href="travel-agency-03.html#adventure" class="drop-down">Adventure Tours<i class="bi bi-caret-down-fill"></i></a>
                            <i class="bi bi-plus dropdown-icon"></i>
                            <ul class="sub-menu">
                                <li><a href="tour-details.html?id=3">Chimgan Mountains Adventure</a></li>
                            </ul>
                        </li>
                        <li class="menu-item-has-children">
                            <a href="travel-agency-03.html#cultural" class="drop-down">Cultural Tours<i class="bi bi-caret-down-fill"></i></a>
                            <i class="bi bi-plus dropdown-icon"></i>
                            <ul class="sub-menu" id="culturalToursDropdown">
                                <!-- Tours will be loaded here dynamically -->
                                <li><a href="tour-details.html?id=1">Samarkand City Tour</a></li>
                                <li><a href="tour-details.html?id=2">Bukhara Historical Safari</a></li>
                                <li><a href="tour-details.html?id=4">10-Day Uzbekistan Grand Tour</a></li>
                            </ul>
                        </li>
                        <li>
                            <a href="about.html">About</a>
                        </li>
                        <li>
                            <a href="contact.html">Contact Us</a>
                        </li>
                    </ul>
                    <div class="contact-area d-xl-none d-flex" style="gap: 15px; align-items: center; flex-direction: column; padding: 15px 0;">
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <div class="icon">
                                <svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
                                    <g>
                                        <path d="M15.5646 11.7424L13.3317 9.50954C12.5343 8.7121 11.1786 9.03111 10.8596 10.0678C10.6204 10.7855 9.82296 11.1842 9.10526 11.0247C7.51037 10.626 5.35726 8.55261 4.95854 6.87797C4.71931 6.16024 5.19778 5.36279 5.91548 5.12359C6.95216 4.80461 7.27113 3.44895 6.47369 2.65151L4.24084 0.418659C3.60288 -0.139553 2.64595 -0.139553 2.08774 0.418659L0.572591 1.93381C-0.942555 3.5287 0.73208 7.75516 4.48007 11.5032C8.22807 15.2512 12.4545 17.0056 14.0494 15.4106L15.5646 13.8955C16.1228 13.2575 16.1228 12.3006 15.5646 11.7424Z"/>
                                    </g>
                                </svg>
                            </div>
                            <a href="tel:998901234567" style="color: #1f2937; font-weight: 600; text-decoration: none; font-size: 16px;">+998 90 123 45 67</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="nav-right">
                <div class="contact-and-search-area">
                    <div class="contact-area d-xl-flex d-none" style="gap: 20px; align-items: center;">
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <div class="icon">
                                <svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
                                    <g>
                                        <path d="M15.5646 11.7424L13.3317 9.50954C12.5343 8.7121 11.1786 9.03111 10.8596 10.0678C10.6204 10.7855 9.82296 11.1842 9.10526 11.0247C7.51037 10.626 5.35726 8.55261 4.95854 6.87797C4.71931 6.16024 5.19778 5.36279 5.91548 5.12359C6.95216 4.80461 7.27113 3.44895 6.47369 2.65151L4.24084 0.418659C3.60288 -0.139553 2.64595 -0.139553 2.08774 0.418659L0.572591 1.93381C-0.942555 3.5287 0.73208 7.75516 4.48007 11.5032C8.22807 15.2512 12.4545 17.0056 14.0494 15.4106L15.5646 13.8955C16.1228 13.2575 16.1228 12.3006 15.5646 11.7424Z"/>
                                    </g>
                                </svg>
                            </div>
                            <a href="tel:998901234567" style="color: #1f2937; font-weight: 600; text-decoration: none;">+998 90 123 45 67</a>
                        </div>
                        <div class="language-selector" style="position: relative;">
                            <button class="language-btn" style="background: transparent; border: none; cursor: pointer; display: flex; align-items: center; gap: 5px; font-weight: 600; color: #1f2937; padding: 5px 10px; border-radius: 6px; transition: all 0.3s;">
                                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50 30'%3E%3Cdefs%3E%3CclipPath id='a'%3E%3Crect width='50' height='30'/%3E%3C/clipPath%3E%3C/defs%3E%3Cg clip-path='url(%23a)'%3E%3Crect width='50' height='30' fill='%23012169'/%3E%3Cpath d='M0,0 L50,30 M50,0 L0,30' stroke='%23FFF' stroke-width='6'/%3E%3Cpath d='M0,0 L50,30 M50,0 L0,30' stroke='%23C8102E' stroke-width='4' clip-path='url(%23a)'/%3E%3Cpath d='M25,0 V30 M0,15 H50' stroke='%23FFF' stroke-width='10'/%3E%3Cpath d='M25,0 V30 M0,15 H50' stroke='%23C8102E' stroke-width='6'/%3E%3C/g%3E%3C/svg%3E" alt="UK Flag" width="24" height="16" style="border-radius: 2px; border: 1px solid rgba(0,0,0,0.1);">
                                <span id="currentLang">EN</span>
                                <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="6 9 12 15 18 9"></polyline>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
                <div class="sidebar-button mobile-menu-btn">
                    <svg width="20" height="18" viewBox="0 0 20 18" xmlns="http://www.w3.org/2000/svg">
                        <path d="M1.29445 2.8421H10.5237C11.2389 2.8421 11.8182 2.2062 11.8182 1.42105C11.8182 0.635903 11.2389 0 10.5237 0H1.29445C0.579249 0 0 0.635903 0 1.42105C0 2.2062 0.579249 2.8421 1.29445 2.8421Z"></path>
                        <path d="M1.23002 10.421H18.77C19.4496 10.421 20 9.78506 20 8.99991C20 8.21476 19.4496 7.57886 18.77 7.57886H1.23002C0.550421 7.57886 0 8.21476 0 8.99991C0 9.78506 0.550421 10.421 1.23002 10.421Z"></path>
                        <path d="M18.77 15.1579H9.54076C8.86116 15.1579 8.31074 15.7938 8.31074 16.579C8.31074 17.3641 8.86116 18 9.54076 18H18.77C19.4496 18 20 17.3641 20 16.579C20 15.7938 19.4496 15.1579 18.77 15.1579Z"></path>
                    </svg>
                </div>
            </div>
        </div>
    </header>
    <!-- Header Section End -->

    <!-- Photo Grid Gallery -->
    <div class="photo-grid-container">
        <div class="photo-grid" id="photoGrid">
            <div class="photo-grid-item">
                <img src="assets/img/home1/tour-package-img1.jpg" alt="Tour Photo 1" class="skeleton">
                <div class="title-overlay">
                    <h1 id="tourTitle">Loading...</h1>
                    <div class="rating-badge">
                        <span class="stars" id="tourStars">★★★★★</span>
                        <span id="tourRating">0.0</span>
                        <span class="review-count" id="reviewCount">(0 reviews)</span>
                    </div>
                </div>
            </div>
            <div class="photo-grid-item">
                <img src="assets/img/home1/tour-package-img2.jpg" alt="Tour Photo 2" class="skeleton">
            </div>
            <div class="photo-grid-item">
                <img src="assets/img/home1/tour-package-img3.jpg" alt="Tour Photo 3" class="skeleton">
            </div>
            <div class="photo-grid-item">
                <img src="assets/img/home1/tour-package-img4.jpg" alt="Tour Photo 4" class="skeleton">
            </div>
            <div class="photo-grid-item">
                <img src="assets/img/home1/tour-package-img5.jpg" alt="Tour Photo 5" class="skeleton">
            </div>
            <button class="show-all-photos">
                <i class="bi bi-grid-3x3-gap"></i>
                Show all photos
            </button>
        </div>
    </div>

    <!-- Sticky Navigation -->
    <div class="sticky-nav">
        <div class="container">
            <div class="sticky-nav-content">
                <ul class="nav nav-tabs" id="tourTabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="overview-tab" data-bs-toggle="tab" data-bs-target="#overview" type="button" role="tab">Overview</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="itinerary-tab" data-bs-toggle="tab" data-bs-target="#itinerary" type="button" role="tab">Itinerary</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="included-tab" data-bs-toggle="tab" data-bs-target="#included" type="button" role="tab">What's Included</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="reviews-tab" data-bs-toggle="tab" data-bs-target="#reviews" type="button" role="tab">Reviews</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="photos-tab" data-bs-toggle="tab" data-bs-target="#photos" type="button" role="tab">Photos</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="faq-tab" data-bs-toggle="tab" data-bs-target="#faq" type="button" role="tab">FAQ</button>
                    </li>
                </ul>
                <button class="btn-download-pdf" id="downloadPdfBtn">
                    <i class="bi bi-file-earmark-pdf"></i>
                    <span>Download PDF</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="content-wrapper">
        <!-- Main Content Area -->
        <div class="main-content">
            <div class="tab-content" id="tourTabContent">
                <!-- Overview Tab -->
                <div class="tab-pane fade show active" id="overview" role="tabpanel">
                    <h2 class="section-title">Tour Overview</h2>
                    <p id="tourDescription" style="color: var(--text-secondary); line-height: 1.8; font-size: 15px;">
                        Loading tour description...
                    </p>

                    <h3 class="section-title mt-5">Tour Highlights</h3>
                    <div class="highlights-grid" id="highlightsGrid">
                        <!-- Highlights will be loaded here -->
                    </div>

                    <div class="trust-badges">
                        <div class="trust-badge">
                            <i class="bi bi-shield-check"></i>
                            <span>Secure Payment</span>
                        </div>
                        <div class="trust-badge">
                            <i class="bi bi-clock-history"></i>
                            <span>Free Cancellation</span>
                        </div>
                        <div class="trust-badge">
                            <i class="bi bi-headset"></i>
                            <span>24/7 Support</span>
                        </div>
                        <div class="trust-badge">
                            <i class="bi bi-star-fill"></i>
                            <span>Best Price Guarantee</span>
                        </div>
                    </div>
                </div>

                <!-- Itinerary Tab -->
                <div class="tab-pane fade" id="itinerary" role="tabpanel">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                        <h2 class="section-title" style="margin-bottom: 0;">Tour Itinerary</h2>
                        <div class="itinerary-controls">
                            <button class="btn-toggle-all" id="expandAll">
                                <i class="bi bi-arrows-expand"></i> Expand All
                            </button>
                            <button class="btn-toggle-all" id="collapseAll">
                                <i class="bi bi-arrows-collapse"></i> Collapse All
                            </button>
                        </div>
                    </div>
                    <div class="timeline-itinerary" id="itineraryTimeline">
                        <!-- Timeline items will be loaded here -->
                    </div>
                </div>

                <!-- What's Included Tab -->
                <div class="tab-pane fade" id="included" role="tabpanel">
                    <h2 class="section-title">What's Included</h2>
                    <div class="inclusion-grid">
                        <div class="inclusion-section">
                            <h4>Included</h4>
                            <ul class="inclusion-list included" id="includedList">
                                <!-- Included items will be loaded here -->
                            </ul>
                        </div>
                        <div class="inclusion-section">
                            <h4>Not Included</h4>
                            <ul class="inclusion-list excluded" id="excludedList">
                                <!-- Excluded items will be loaded here -->
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Reviews Tab -->
                <div class="tab-pane fade" id="reviews" role="tabpanel">
                    <h2 class="section-title">Traveler Reviews</h2>

                    <!-- TripAdvisor Header -->
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 30px; padding: 20px; background: #fff; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">
                        <div style="display: flex; align-items: center; gap: 20px;">
                            <img src="https://www.tripadvisor.co.uk/img/cdsi/img2/branding/v2/Tripadvisor_lockup_horizontal_secondary_registered-18034-2.svg" alt="TripAdvisor" style="height: 30px;">
                            <div>
                                <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 5px;">
                                    <span style="font-size: 32px; font-weight: 700; color: #333;">4.9</span>
                                    <div>
                                        <svg width="20" height="20" viewBox="0 0 14 14" fill="#00AA6C" xmlns="http://www.w3.org/2000/svg" style="display: inline-block;">
                                            <path d="M7 0L8.5716 4.83688H13.6574L9.5429 7.82624L11.1145 12.6631L7 9.67376L2.8855 12.6631L4.4571 7.82624L0.342604 4.83688H5.4284L7 0Z"/>
                                        </svg>
                                        <svg width="20" height="20" viewBox="0 0 14 14" fill="#00AA6C" xmlns="http://www.w3.org/2000/svg" style="display: inline-block;">
                                            <path d="M7 0L8.5716 4.83688H13.6574L9.5429 7.82624L11.1145 12.6631L7 9.67376L2.8855 12.6631L4.4571 7.82624L0.342604 4.83688H5.4284L7 0Z"/>
                                        </svg>
                                        <svg width="20" height="20" viewBox="0 0 14 14" fill="#00AA6C" xmlns="http://www.w3.org/2000/svg" style="display: inline-block;">
                                            <path d="M7 0L8.5716 4.83688H13.6574L9.5429 7.82624L11.1145 12.6631L7 9.67376L2.8855 12.6631L4.4571 7.82624L0.342604 4.83688H5.4284L7 0Z"/>
                                        </svg>
                                        <svg width="20" height="20" viewBox="0 0 14 14" fill="#00AA6C" xmlns="http://www.w3.org/2000/svg" style="display: inline-block;">
                                            <path d="M7 0L8.5716 4.83688H13.6574L9.5429 7.82624L11.1145 12.6631L7 9.67376L2.8855 12.6631L4.4571 7.82624L0.342604 4.83688H5.4284L7 0Z"/>
                                        </svg>
                                        <svg width="20" height="20" viewBox="0 0 14 14" fill="#00AA6C" xmlns="http://www.w3.org/2000/svg" style="display: inline-block;">
                                            <path d="M7 0L8.5716 4.83688H13.6574L9.5429 7.82624L11.1145 12.6631L7 9.67376L2.8855 12.6631L4.4571 7.82624L0.342604 4.83688H5.4284L7 0Z"/>
                                        </svg>
                                    </div>
                                </div>
                                <div style="color: #666; font-size: 14px;">79 reviews</div>
                            </div>
                        </div>
                        <a href="https://www.tripadvisor.co.uk/Attraction_Review-g298068-d26852419-Reviews-Travel_Bliss-Samarkand_Samarqand_Province.html"
                           target="_blank"
                           style="background: #00AA6C; color: white; padding: 12px 24px; border-radius: 8px; text-decoration: none; font-weight: 600; font-size: 14px; transition: all 0.3s;"
                           onmouseover="this.style.background='#008c59'"
                           onmouseout="this.style.background='#00AA6C'">
                            View All Reviews
                        </a>
                    </div>

                    <!-- Review Cards -->
                    <div id="reviewCardsContainer">
                        <!-- Review cards will be loaded here -->
                    </div>
                </div>

                <!-- Photos Tab -->
                <div class="tab-pane fade" id="photos" role="tabpanel">
                    <h2 class="section-title">Photo Gallery</h2>
                    <div class="photo-gallery-grid" id="photoGallery">
                        <!-- Photos will be loaded here -->
                    </div>
                </div>

                <!-- FAQ Tab -->
                <div class="tab-pane fade" id="faq" role="tabpanel">
                    <h2 class="section-title">Frequently Asked Questions</h2>
                    <div class="accordion faq-accordion" id="faqAccordion">
                        <!-- FAQ items will be loaded here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Sidebar Booking Card -->
        <aside class="booking-sidebar">
            <div class="price-section">
                <div class="price-from">From</div>
                <div class="price-amount">
                    <small>$</small><span id="tourPrice">0</span>
                </div>
                <div class="per-person">per person</div>
            </div>

            <div class="tripadvisor-rating">
                <div class="rating-bubble" id="sidebarRating">0.0</div>
                <div class="rating-details">
                    <div class="rating-circles">●●●●●</div>
                    <div class="rating-text" id="sidebarReviews">0 reviews</div>
                </div>
            </div>

            <form class="booking-form">
                <div class="form-group">
                    <label for="checkInDate">Check-in</label>
                    <input type="date" class="form-control" id="checkInDate" required>
                </div>
                <div class="form-group">
                    <label for="guestCount">Guests</label>
                    <select class="form-control" id="guestCount" required>
                        <option value="1">1 Guest</option>
                        <option value="2" selected>2 Guests</option>
                        <option value="3">3 Guests</option>
                        <option value="4">4 Guests</option>
                        <option value="5">5 Guests</option>
                        <option value="6">6 Guests</option>
                        <option value="7">7 Guests</option>
                        <option value="8">8 Guests</option>
                        <option value="9">9 Guests</option>
                        <option value="10">10+ Guests</option>
                    </select>
                </div>
            </form>

            <button class="check-availability-btn" id="checkAvailabilityBtn" onclick="handleCheckAvailability()">Check Availability</button>

            <div class="cancellation-badge">
                <i class="bi bi-check-circle-fill"></i>
                <span>Free cancellation up to 24 hours before</span>
            </div>

            <div class="trust-badges" style="margin-top: 0; flex-direction: column; align-items: flex-start; gap: 10px;">
                <div class="trust-badge" style="font-size: 12px;">
                    <i class="bi bi-award"></i>
                    <span>Reserve now & pay later</span>
                </div>
                <div class="trust-badge" style="font-size: 12px;">
                    <i class="bi bi-lightning-charge"></i>
                    <span>Instant confirmation</span>
                </div>
            </div>
        </aside>
    </div>

    <!-- Footer Section Start -->
    <footer class="footer-section">
        <div class="container">
            <div class="footer-contact-wrap">
                <div class="inquiry-area">
                    <svg width="36" height="36" viewBox="0 0 36 36" xmlns="http://www.w3.org/2000/svg">
                        <g>
                            <path d="M35.8703 28.2548L33.7795 22.1697C34.7873 20.1094 35.3199 17.8181 35.3235 15.5126C35.3297 11.5039 33.7788 7.71355 30.9563 4.83988C28.1332 1.96565 24.3714 0.347686 20.3636 0.284193C16.2077 0.218522 12.3015 1.79929 9.36472 4.73596C6.53295 7.56766 4.96231 11.3008 4.9126 15.29C2.12162 17.3914 0.474267 20.6676 0.479681 24.167C0.482282 25.8045 0.850861 27.4323 1.54927 28.9043L0.109064 33.0955C-0.138507 33.816 0.0423371 34.5983 0.581071 35.1371C0.960196 35.5162 1.46005 35.7181 1.9741 35.7181C2.19038 35.7181 2.4092 35.6824 2.62259 35.6091L6.81385 34.1688C8.28584 34.8673 9.91365 35.2358 11.5512 35.2384H11.5687C15.1201 35.2383 18.4213 33.5485 20.515 30.6891C22.6938 30.6317 24.8495 30.1043 26.7983 29.1509L32.8835 31.2419C33.1314 31.3274 33.3918 31.3712 33.654 31.3715C34.2649 31.3715 34.8589 31.1316 35.3095 30.6809C35.9497 30.0407 36.1645 29.1111 35.8703 28.2548ZM11.5685 33.0956H11.5545C10.1051 33.0934 8.66574 32.7361 7.39231 32.0624C7.2628 31.9939 7.12062 31.9526 6.97456 31.9412C6.82849 31.9299 6.68164 31.9485 6.54308 31.9961L2.24537 33.4729L3.72214 29.1753C3.76974 29.0367 3.78843 28.8898 3.77703 28.7438C3.76564 28.5977 3.72442 28.4555 3.65591 28.326C2.98217 27.0525 2.62484 25.6132 2.62259 24.1637C2.61901 21.8322 3.52597 19.6224 5.11201 17.9676C5.63007 21.1258 7.13525 24.036 9.46836 26.3277C11.7842 28.6023 14.6953 30.0506 17.8363 30.5241C16.1778 32.1588 13.9421 33.0956 11.5685 33.0956ZM33.7942 29.1656C33.7332 29.2266 33.6609 29.2432 33.5796 29.2152L27.0653 26.9767C26.9268 26.9291 26.7799 26.9104 26.6339 26.9218C26.4878 26.9332 26.3456 26.9744 26.2162 27.043C24.3562 28.0269 22.2544 28.5488 20.1379 28.552H20.1176C13.0257 28.552 7.16774 22.791 7.05538 15.7008C6.99877 12.13 8.35707 8.77401 10.88 6.25112C13.4028 3.72824 16.7593 2.37044 20.3297 2.42669C27.4267 2.53926 33.1917 8.40803 33.1807 15.5092C33.1774 17.6258 32.6556 19.7276 31.6717 21.5875C31.6032 21.717 31.562 21.8592 31.5506 22.0052C31.5392 22.1513 31.5579 22.2981 31.6055 22.4367L33.8439 28.951C33.8718 29.0326 33.8551 29.1048 33.7942 29.1656Z"/>
                            <path d="M26.5002 9.80957H13.7343C13.1426 9.80957 12.6629 10.2893 12.6629 10.881C12.6629 11.4727 13.1426 11.9524 13.7343 11.9524H26.5002C27.092 11.9524 27.5717 11.4727 27.5717 10.881C27.5717 10.2893 27.092 9.80957 26.5002 9.80957ZM26.5002 14.2161H13.7343C13.1426 14.2161 12.6629 14.6959 12.6629 15.2875C12.6629 15.8792 13.1426 16.359 13.7343 16.359H26.5002C27.092 16.359 27.5717 15.8792 27.5717 15.2875C27.5717 14.6959 27.092 14.2161 26.5002 14.2161ZM21.5862 18.6225H13.7342C13.1425 18.6225 12.6628 19.1023 12.6628 19.694C12.6628 20.2857 13.1426 20.7654 13.7342 20.7654H21.5862C22.1779 20.7654 22.6576 20.2856 22.6576 19.694C22.6576 19.1023 22.178 18.6225 21.5862 18.6225Z"/>
                        </g>
                    </svg>
                    <div class="content">
                        <h6>To More Inquiry</h6>
                        <span>Don't hesitate Call to GoFly.</span>
                    </div>
                </div>
                <ul class="contact-area">
                    <li class="single-contact">
                        <div class="icon">
                            <img src="assets/img/home1/icon/whatsapp-icon2.svg" alt="">
                        </div>
                        <div class="content">
                            <span>WhatsApp</span>
                            <a href="https://wa.me/91345533865">+91 345 533 865</a>
                        </div>
                    </li>
                    <li class="single-contact">
                        <div class="icon">
                            <img src="assets/img/home1/icon/mail-icon2.svg" alt="">
                        </div>
                        <div class="content">
                            <span>Mail Us</span>
                            <a href="mailto:info@example.com">info@example.com</a>
                        </div>
                    </li>
                    <li class="single-contact">
                        <div class="icon">
                            <img src="assets/img/home1/icon/call-icon.svg" alt="">
                        </div>
                        <div class="content">
                            <span>Call Us</span>
                            <a href="tel:+91456453345">+91 456 453 345</a>
                        </div>
                    </li>
                </ul>
            </div>
            <svg class="divider" width="1320" height="6" viewBox="0 0 1320 6" xmlns="http://www.w3.org/2000/svg">
                <path d="M5 2.5L0 0.113249V5.88675L5 3.5V2.5ZM1315 3.5L1320 5.88675V0.113249L1315 2.5V3.5ZM4.5 3.5H1315.5V2.5H4.5V3.5Z"/>
            </svg>
            <div class="footer-menu-wrap">
                <div class="row gy-md-4 gy-5">
                    <div class="col-lg-3 col-md-4 col-sm-6">
                        <div class="footer-logo-and-addition-info">
                            <a href="index.html" class="footer-logo">
                                <img src="assets/img/footer-logo.svg" alt="">
                            </a>
                            <div class="address-area">
                                <span>GoFly Travel Agency</span>
                                <a href="#">Skyline Plaza, 5th Floor, 123 Main Street Los Angeles, CA 90001, USA</a>
                            </div>
                            <ul class="social-list">
                                <li><a href="https://www.facebook.com/"><i class="bx bxl-facebook"></i></a></li>
                                <li><a href="https://www.linkedin.com/"><i class="bx bxl-linkedin"></i></a></li>
                                <li><a href="https://www.youtube.com/"><i class="bx bxl-youtube"></i></a></li>
                                <li><a href="https://www.instagram.com/"><i class="bx bxl-instagram-alt"></i></a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-4 col-sm-6 d-flex justify-content-md-end">
                        <div class="footer-widget">
                            <div class="widget-title">
                                <h5>Top Destination</h5>
                            </div>
                            <ul class="widget-list">
                                <li><a href="travel-package-01.html">Maldives Tour</a></li>
                                <li><a href="travel-package-01.html">Bali, Indonesia Tour</a></li>
                                <li><a href="travel-package-01.html">Thailand Tour</a></li>
                                <li><a href="travel-package-01.html">Philippines Tour</a></li>
                                <li><a href="travel-package-01.html">Hawaii, USA Tour</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-4 col-sm-6 d-flex justify-content-md-end">
                        <div class="footer-widget">
                            <div class="widget-title">
                                <h5>Popular Search</h5>
                            </div>
                            <ul class="widget-list">
                                <li><a href="travel-package-02.html">Adventure</a></li>
                                <li><a href="travel-package-02.html">Hiking & Trekking</a></li>
                                <li><a href="travel-package-02.html">Holiday Packages</a></li>
                                <li><a href="travel-package-02.html">Honeymoon Trip</a></li>
                                <li><a href="travel-package-02.html">Desert Safari</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-lg-3 col-sm-6 d-flex justify-content-lg-end">
                        <div class="footer-widget">
                            <div class="widget-title">
                                <h5>Resources</h5>
                            </div>
                            <ul class="widget-list">
                                <li><a href="about.html">About GoFly</a></li>
                                <li><a href="visa.html">Visa Processing</a></li>
                                <li><a href="contact.html">Customize Tour</a></li>
                                <li><a href="#">Terms & Condition</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <div class="container">
                <div class="copyright-and-payment-method-area">
                    <p>Copyright 2025 <a href="https://www.egenslab.com/">Egens Lab</a> | All Right Reserved.</p>
                    <div class="payment-method-area">
                        <span>Accepted Payment Methods :</span>
                        <ul>
                            <li><img src="assets/img/home1/icon/mastar-card-icon.svg" alt=""></li>
                            <li><img src="assets/img/home1/icon/visa-icon.svg" alt=""></li>
                            <li><img src="assets/img/home1/icon/paypal-icon.svg" alt=""></li>
                            <li><img src="assets/img/home1/icon/gpay-icon.svg" alt=""></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!-- Footer Section End -->

    <!-- Main jQuery -->
    <script src="assets/js/jquery-3.7.1.min.js"></script>
    <script src="assets/js/jquery-ui.js"></script>
    <script src="assets/js/moment.min.js"></script>
    <script src="assets/js/daterangepicker.min.js"></script>

    <!-- Popper and Bootstrap JS -->
    <script src="assets/js/bootstrap.min.js"></script>
    <script src="assets/js/popper.min.js"></script>
    <!-- Swiper slider JS -->
    <script src="assets/js/swiper-bundle.min.js"></script>
    <script src="assets/js/slick.js"></script>
    <!-- Waypoints JS -->
    <script src="assets/js/waypoints.min.js"></script>
    <!-- Counterup JS -->
    <script src="assets/js/jquery.counterup.min.js"></script>
    <!-- Wow JS -->
    <script src="assets/js/wow.min.js"></script>
    <!-- Gsap JS -->
    <script src="assets/js/gsap.min.js"></script>
    <script src="assets/js/ScrollTrigger.min.js"></script>
    <script src="assets/js/jquery.fancybox.min.js"></script>
    <!-- Custom JS -->
    <script src="assets/js/select-dropdown.js"></script>
    <script src="assets/js/custom.js"></script>

    <!-- jsPDF for PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <!-- Tour Details Loading Script -->
    <script>
        const API_BASE = 'http://localhost:4000';

        // Get tour ID from URL
        const urlParams = new URLSearchParams(window.location.search);
        const tourId = urlParams.get('id');

        // Global variable to store current tour
        let currentTour = null;

        // Placeholder images for travel/tourism
        const PLACEHOLDER_IMAGES = [
            'https://images.unsplash.com/photo-1476514525535-07fb3b4ae5f1?w=800&h=500&fit=crop', // Travel
            'https://images.unsplash.com/photo-1469854523086-cc02fe5d8800?w=800&h=500&fit=crop', // Mountain
            'https://images.unsplash.com/photo-1488646953014-85cb44e25828?w=800&h=500&fit=crop', // Architecture
            'https://images.unsplash.com/photo-1613490493576-7fde63acd811?w=800&h=500&fit=crop', // Uzbekistan
            'https://images.unsplash.com/photo-1564507592333-c60657eea523?w=800&h=500&fit=crop', // Desert
            'https://images.unsplash.com/photo-1500530855697-b586d89ba3ee?w=800&h=500&fit=crop', // Tourism
        ];

        // Get placeholder image by index
        function getPlaceholder(index = 0) {
            return PLACEHOLDER_IMAGES[index % PLACEHOLDER_IMAGES.length];
        }

        // Load tour data
        async function loadTourData() {
            if (!tourId) {
                console.error('No tour ID provided');
                return;
            }

            try {
                const response = await fetch(`${API_BASE}/api/tours/${tourId}`);
                if (!response.ok) throw new Error('Failed to load tour');

                const result = await response.json();
                console.log('API Response:', result);

                // API returns data in result.data.tour format
                const tour = result.data && result.data.tour ? result.data.tour : result;
                console.log('Tour data:', tour);

                // Store in global variable for PDF download
                currentTour = tour;

                displayTourData(tour);
            } catch (error) {
                console.error('Error loading tour:', error);
                alert('Error loading tour data. Please try again.');
            }
        }

        function displayTourData(tour) {
            console.log('Displaying tour:', tour);

            // Safety check
            if (!tour) {
                console.error('Tour data is empty!');
                return;
            }

            // Update page title
            const pageTitle = document.getElementById('pageTitle');
            const tourTitle = document.getElementById('tourTitle');

            if (pageTitle) pageTitle.textContent = (tour.title || 'Tour') + ' - Travel Bliss';
            if (tourTitle) tourTitle.textContent = tour.title || 'Loading...';

            // Update rating
            const rating = tour.rating || 4.8;
            const reviewCount = tour.ratingsCount || tour.reviewCount || 127;
            const stars = '★'.repeat(Math.floor(rating)) + '☆'.repeat(5 - Math.floor(rating));

            const tourStars = document.getElementById('tourStars');
            const tourRatingEl = document.getElementById('tourRating');
            const reviewCountEl = document.getElementById('reviewCount');
            const tourPrice = document.getElementById('tourPrice');
            const sidebarRating = document.getElementById('sidebarRating');
            const sidebarReviews = document.getElementById('sidebarReviews');
            const avgRatingScore = document.getElementById('avgRatingScore');
            const totalReviewsText = document.getElementById('totalReviewsText');
            const tourDescription = document.getElementById('tourDescription');

            if (tourStars) tourStars.textContent = stars;
            if (tourRatingEl) tourRatingEl.textContent = rating.toFixed(1);
            if (reviewCountEl) reviewCountEl.textContent = `(${reviewCount} reviews)`;

            // Update sidebar
            if (tourPrice) tourPrice.textContent = tour.price || '0';
            if (sidebarRating) sidebarRating.textContent = rating.toFixed(1);
            if (sidebarReviews) sidebarReviews.textContent = `${reviewCount} reviews`;

            // Update reviews section
            if (avgRatingScore) avgRatingScore.textContent = rating.toFixed(1);
            if (totalReviewsText) totalReviewsText.textContent = `${reviewCount} reviews`;

            // Update description
            if (tourDescription) tourDescription.textContent = tour.description || 'Experience an unforgettable journey through stunning landscapes and rich culture.';

            // Load photo gallery
            loadPhotoGallery(tour);

            // Load highlights
            loadHighlights(tour);

            // Load itinerary
            loadItinerary(tour);

            // Load inclusions
            loadInclusions(tour);

            // Load reviews
            loadReviews(tour);

            // Load FAQ
            loadFAQ(tour);
        }

        function loadPhotoGallery(tour) {
            const gallery = document.getElementById('photoGallery');
            const photoGrid = document.getElementById('photoGrid');

            if (!gallery || !photoGrid) {
                console.error('Gallery elements not found');
                return;
            }

            // Get images from tour data
            let images = [];

            if (tour.images && Array.isArray(tour.images) && tour.images.length > 0) {
                // Map tour images to correct paths
                images = tour.images.map(img => getImagePath(img));

                // If less than 5 images, fill with related images
                while (images.length < 5) {
                    const tourNum = tour.id || '3';
                    const imgNum = images.length + 1;
                    images.push(`assets/img/home1/tour-package-img${tourNum}.jpg`);
                }
            } else if (tour.imageCover) {
                // Use cover image and add similar ones
                const coverImg = getImagePath(tour.imageCover);
                const tourNum = tour.id || '3';
                images = [
                    coverImg,
                    `assets/img/home1/tour-package-img${tourNum}.jpg`,
                    `assets/img/home1/tour-package-img1.jpg`,
                    `assets/img/home1/tour-package-img2.jpg`,
                    `assets/img/home1/tour-package-img4.jpg`
                ];
            } else {
                // Default fallback images
                images = [
                    'assets/img/home1/tour-package-img1.jpg',
                    'assets/img/home1/tour-package-img2.jpg',
                    'assets/img/home1/tour-package-img3.jpg',
                    'assets/img/home1/tour-package-img4.jpg',
                    'assets/img/home1/tour-package-img5.jpg'
                ];
            }

            console.log('Gallery images:', images);

            // Update photo grid - safely
            const gridItems = photoGrid.querySelectorAll('.photo-grid-item img');
            if (gridItems && gridItems.length > 0) {
                images.slice(0, 5).forEach((img, index) => {
                    if (gridItems[index]) {
                        gridItems[index].src = img;
                        gridItems[index].classList.remove('skeleton');
                        gridItems[index].onerror = function() {
                            // If image fails to load, use placeholder
                            this.src = getPlaceholder(index);
                            this.onerror = null; // Prevent infinite loop
                        };
                    }
                });
            }

            // Load photo gallery section
            if (gallery) {
                gallery.innerHTML = images.map((img, index) => `
                    <div class="gallery-photo">
                        <img src="${img}" alt="Tour Photo" onerror="this.src=getPlaceholder(${index}); this.onerror=null;">
                    </div>
                `).join('');
            }
        }

        // Helper function to get correct image path
        function getImagePath(imageName) {
            if (!imageName) return 'assets/img/home1/tour-package-img1.jpg';

            // If already a full URL, return as is
            if (imageName.startsWith('http://') || imageName.startsWith('https://')) {
                return imageName;
            }

            // If relative path starting with assets, return as is
            if (imageName.startsWith('assets/')) {
                return imageName;
            }

            // Otherwise, prepend the assets path (images are in home1 folder)
            return `assets/img/home1/${imageName}`;
        }

        function loadHighlights(tour) {
            const container = document.getElementById('highlightsGrid');

            // Format duration
            const duration = tour.duration && tour.nights !== undefined
                ? `${tour.duration} Days / ${tour.nights} Nights`
                : (tour.duration ? `${tour.duration} Days` : '7 Days');

            // Format group size
            const groupSize = tour.maxGroupSize
                ? `Max ${tour.maxGroupSize} people`
                : 'Max 15 people';

            // Format languages
            const languages = Array.isArray(tour.languages)
                ? tour.languages.join(', ')
                : (tour.languages || 'English');

            const highlights = [
                {
                    icon: 'bi-clock',
                    title: 'Duration',
                    text: duration
                },
                {
                    icon: 'bi-people',
                    title: 'Group Size',
                    text: groupSize
                },
                {
                    icon: 'bi-calendar-check',
                    title: 'Availability',
                    text: tour.season || 'Year Round'
                },
                {
                    icon: 'bi-translate',
                    title: 'Languages',
                    text: languages
                },
                {
                    icon: 'bi-geo-alt',
                    title: 'Destination',
                    text: tour.destination || 'Uzbekistan'
                },
                {
                    icon: 'bi-award',
                    title: 'Difficulty',
                    text: tour.difficulty || 'Moderate'
                }
            ];

            container.innerHTML = highlights.map(h => `
                <div class="highlight-item">
                    <i class="bi ${h.icon} highlight-icon"></i>
                    <div class="highlight-text">
                        <strong>${h.title}</strong>
                        <span>${h.text}</span>
                    </div>
                </div>
            `).join('');
        }

        function loadItinerary(tour) {
            const container = document.getElementById('itineraryTimeline');
            const itinerary = tour.itinerary || [
                {
                    day: 1,
                    title: 'Arrival & City Tour',
                    description: 'Arrive at the destination and meet your tour guide. Begin with a comprehensive city tour covering major landmarks.',
                    activities: ['Airport pickup', 'Hotel check-in', 'Welcome dinner', 'Evening city walk']
                },
                {
                    day: 2,
                    title: 'Cultural Exploration',
                    description: 'Dive deep into the local culture with visits to museums, temples, and traditional markets.',
                    activities: ['Morning temple visit', 'Local market tour', 'Traditional lunch', 'Cultural show']
                },
                {
                    day: 3,
                    title: 'Adventure Day',
                    description: 'Experience thrilling outdoor activities and natural wonders.',
                    activities: ['Mountain hiking', 'Scenic viewpoints', 'Picnic lunch', 'Nature photography']
                }
            ];

            container.innerHTML = itinerary.map((item, index) => `
                <div class="timeline-item" data-day="${item.day}">
                    <div class="timeline-marker">Day ${item.day}</div>
                    <div class="timeline-content">
                        <div class="timeline-header">
                            <h4 style="margin-bottom: 0;">${item.title}</h4>
                            <i class="bi bi-chevron-down timeline-toggle-icon"></i>
                        </div>
                        <div class="timeline-body">
                            ${item.image ? `
                                <div class="day-image-container" style="position: relative; margin-bottom: 10px; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                                    <img src="${item.image}" alt="${item.imageCaption || item.title}"
                                         onerror="this.src=getPlaceholder(${item.day - 1}); this.onerror=null;"
                                         style="width: 100%; height: 250px; object-fit: cover; display: block;">
                                    ${item.imageCaption ? `
                                        <div class="image-caption-overlay" style="
                                            position: absolute;
                                            bottom: 0;
                                            left: 0;
                                            right: 0;
                                            background: linear-gradient(to top, rgba(0,0,0,0.8) 0%, rgba(0,0,0,0.5) 50%, transparent 100%);
                                            padding: 30px 20px 15px;
                                            color: white;
                                            font-size: 18px;
                                            font-weight: 600;
                                            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
                                        ">
                                            ${item.imageCaption}
                                        </div>
                                    ` : ''}
                                </div>
                            ` : ''}
                            <p>${item.description}</p>
                            ${item.activities ? `
                                <ul class="timeline-activities">
                                    ${item.activities.map(activity => `<li>${activity}</li>`).join('')}
                                </ul>
                            ` : ''}
                            ${item.city || item.accommodation || item.meals ? `
                                <div style="display: flex; gap: 12px; margin-top: 8px; padding: 8px; background: #f8f9fa; border-radius: 6px; border-left: 3px solid #667eea; flex-wrap: wrap;">
                                    ${item.city ? `<span style="color: #495057; font-size: 13px;"><strong>📍</strong> ${item.city}</span>` : ''}
                                    ${item.accommodation && item.accommodation.trim() && item.accommodation !== 'N/A' ? `<span style="color: #495057; font-size: 13px;"><strong>🏨</strong> ${item.accommodation} <span style="color: #6c757d; font-style: italic;">or similar</span></span>` : ''}
                                    ${item.meals ? `<span style="color: #495057; font-size: 13px;"><strong>🍽️</strong> ${item.meals === 'BB' ? 'Bed & Breakfast' : item.meals === 'HB' ? 'Half Board' : item.meals === 'FB' ? 'Full Board' : item.meals === 'AI' ? 'All Inclusive' : item.meals}</span>` : ''}
                                </div>
                            ` : ''}
                        </div>
                    </div>
                </div>
            `).join('');

            // Add click handlers for individual items (only on header)
            document.querySelectorAll('.timeline-item').forEach(item => {
                const header = item.querySelector('.timeline-header');
                const body = item.querySelector('.timeline-body');

                // Set initial max-height for animation
                body.style.maxHeight = body.scrollHeight + 'px';

                header.addEventListener('click', function(e) {
                    e.stopPropagation();
                    item.classList.toggle('collapsed');

                    // Animate max-height
                    if (item.classList.contains('collapsed')) {
                        body.style.maxHeight = '0px';
                    } else {
                        body.style.maxHeight = body.scrollHeight + 'px';
                    }
                });
            });

            // Add expand/collapse all functionality
            const expandAllBtn = document.getElementById('expandAll');
            const collapseAllBtn = document.getElementById('collapseAll');

            if (expandAllBtn) {
                expandAllBtn.addEventListener('click', function() {
                    document.querySelectorAll('.timeline-item').forEach(item => {
                        item.classList.remove('collapsed');
                        const body = item.querySelector('.timeline-body');
                        body.style.maxHeight = body.scrollHeight + 'px';
                    });
                });
            }

            if (collapseAllBtn) {
                collapseAllBtn.addEventListener('click', function() {
                    document.querySelectorAll('.timeline-item').forEach(item => {
                        item.classList.add('collapsed');
                        const body = item.querySelector('.timeline-body');
                        body.style.maxHeight = '0px';
                    });
                });
            }
        }

        function loadInclusions(tour) {
            const includedList = document.getElementById('includedList');
            const excludedList = document.getElementById('excludedList');

            if (!includedList || !excludedList) {
                console.error('Inclusions containers not found');
                return;
            }

            // Ensure arrays
            let included = tour.included || [
                'Professional tour guide',
                'All entrance fees',
                'Daily breakfast',
                'Airport transfers',
                'Accommodation in 4-star hotels',
                'Transportation in air-conditioned vehicle'
            ];

            let excluded = tour.excluded || [
                'International flights',
                'Travel insurance',
                'Personal expenses',
                'Optional activities',
                'Tips and gratuities',
                'Meals not mentioned'
            ];

            // Convert to array if not already
            if (!Array.isArray(included)) included = [included];
            if (!Array.isArray(excluded)) excluded = [excluded];

            includedList.innerHTML = included.map(item => `<li>${item}</li>`).join('');
            excludedList.innerHTML = excluded.map(item => `<li>${item}</li>`).join('');
        }

        function loadReviews(tour) {
            const container = document.getElementById('reviewCardsContainer');

            // All available reviews
            const allReviews = {
                // Tour 1: Samarkand City Tour reviews
                '1': [
                {
                    name: 'Jennifer_M',
                    location: 'New York, USA',
                    avatar: 'https://i.pravatar.cc/150?img=1',
                    rating: 5,
                    date: 'Nov 2025',
                    title: 'Unforgettable journey through Uzbekistan!',
                    text: 'Travel Bliss made our trip to Uzbekistan absolutely magical. Our guide was incredibly knowledgeable about the history and culture. The organization was flawless, hotels were beautiful, and the experiences were once in a lifetime. Highly recommend!',
                    helpful: 12
                },
                {
                    name: 'David_Thompson',
                    location: 'London, UK',
                    avatar: 'https://i.pravatar.cc/150?img=12',
                    rating: 5,
                    date: 'Oct 2025',
                    title: 'Best tour company we\'ve used!',
                    text: 'We\'ve traveled extensively but Travel Bliss exceeded all our expectations. The attention to detail, the genuine care for their guests, and the expertly crafted itinerary made this our best vacation ever. The Silk Road came alive through their tours.',
                    helpful: 8
                },
                {
                    name: 'Sarah_Martinez',
                    location: 'Barcelona, Spain',
                    avatar: 'https://i.pravatar.cc/150?img=5',
                    rating: 5,
                    date: 'Oct 2025',
                    title: 'Exceptional service and stunning destinations',
                    text: 'From the moment we arrived, everything was perfectly arranged. The historical sites were breathtaking, the local food experiences were amazing, and our guide was both professional and friendly. Travel Bliss really knows how to create memorable experiences.',
                    helpful: 15
                },
                {
                    name: 'Michael_K',
                    location: 'Sydney, Australia',
                    avatar: 'https://i.pravatar.cc/150?img=13',
                    rating: 5,
                    date: 'Sep 2025',
                    title: 'A must-do experience!',
                    text: 'Samarkand, Bukhara, and Khiva were spectacular. Travel Bliss arranged everything perfectly - comfortable transport, excellent hotels, and fascinating tours. Our guide\'s passion for Uzbek history was infectious. Can\'t wait to return!',
                    helpful: 6
                },
                {
                    name: 'Emma_Wilson',
                    location: 'Toronto, Canada',
                    avatar: 'https://i.pravatar.cc/150?img=9',
                    rating: 5,
                    date: 'Sep 2025',
                    title: 'Outstanding tour operator',
                    text: 'Travel Bliss is simply the best. Professional, responsive, and genuinely caring. They went above and beyond to make our trip special, even celebrating my birthday with a surprise cake at Registan Square. Unforgettable memories!',
                    helpful: 10
                },
                {
                    name: 'Robert_Chen',
                    location: 'Singapore',
                    avatar: 'https://i.pravatar.cc/150?img=8',
                    rating: 4,
                    date: 'Aug 2025',
                    title: 'Great experience overall',
                    text: 'Very well organized tour with knowledgeable guides. The historical sites were magnificent and the pace was just right. Food was delicious and hotels were comfortable. Only minor issue was some wait times, but overall highly recommend Travel Bliss.',
                    helpful: 4
                },
                {
                    name: 'Lisa_Anderson',
                    location: 'Los Angeles, USA',
                    avatar: 'https://i.pravatar.cc/150?img=3',
                    rating: 5,
                    date: 'Aug 2025',
                    title: 'Exceeded expectations',
                    text: 'I was hesitant about traveling to Central Asia, but Travel Bliss made everything easy and comfortable. The blend of history, culture, and hospitality was incredible. Our group became like family. Thank you for an amazing journey!',
                    helpful: 9
                },
                {
                    name: 'James_Brown',
                    location: 'Dublin, Ireland',
                    avatar: 'https://i.pravatar.cc/150?img=14',
                    rating: 5,
                    date: 'Jul 2025',
                    title: 'Highly professional and fun',
                    text: 'Travel Bliss strikes the perfect balance between structured tours and free time. The guides are amazing storytellers who bring history to life. Accommodations were excellent and the whole experience felt authentic and genuine.',
                    helpful: 7
                },
                {
                    name: 'Maria_Garcia',
                    location: 'Madrid, Spain',
                    avatar: 'https://i.pravatar.cc/150?img=10',
                    rating: 5,
                    date: 'Jul 2025',
                    title: 'Simply wonderful',
                    text: 'From booking to farewell, Travel Bliss was exceptional. The attention to detail, the cultural insights, and the warm hospitality made this trip extraordinary. Uzbekistan is stunning and Travel Bliss is the perfect way to experience it.',
                    helpful: 11
                },
                {
                    name: 'Thomas_Schmidt',
                    location: 'Berlin, Germany',
                    avatar: 'https://i.pravatar.cc/150?img=15',
                    rating: 5,
                    date: 'Jun 2025',
                    title: 'Fantastic adventure!',
                    text: 'Best organized tour I\'ve ever been on. Travel Bliss handled everything seamlessly - transport, hotels, meals, and tours. Our guide was wonderful and patient with all our questions. The Silk Road cities are absolutely magnificent!',
                    helpful: 5
                }
            ],
            // Tour 2: Bukhara Heritage Tour reviews (different reviews)
            '2': [
                {
                    name: 'Alex_Rodriguez',
                    location: 'Miami, USA',
                    avatar: 'https://i.pravatar.cc/150?img=7',
                    rating: 5,
                    date: 'Nov 2025',
                    title: 'Bukhara is magical!',
                    text: 'The old city of Bukhara is like stepping back in time. Travel Bliss showed us hidden gems that most tourists never see. Our guide was passionate about the history and made every story come alive. Absolutely worth every penny!',
                    helpful: 18
                },
                {
                    name: 'Sophie_Laurent',
                    location: 'Paris, France',
                    avatar: 'https://i.pravatar.cc/150?img=2',
                    rating: 5,
                    date: 'Oct 2025',
                    title: 'Incredible historical experience',
                    text: 'As a history teacher, I was amazed by the depth of knowledge our guide had. The Ark fortress, trading domes, and madrasahs were stunning. Travel Bliss organized everything perfectly. Highly recommend for culture lovers!',
                    helpful: 14
                },
                {
                    name: 'Hans_Mueller',
                    location: 'Munich, Germany',
                    avatar: 'https://i.pravatar.cc/150?img=11',
                    rating: 4,
                    date: 'Sep 2025',
                    title: 'Very good tour',
                    text: 'Great tour with excellent organization. The hotels were comfortable and the food was delicious. Only minor issue was the pace felt a bit rushed at times. But overall a wonderful experience in beautiful Bukhara.',
                    helpful: 7
                }
            ],
            // Tour 3: Chimgan Mountain Day Trip reviews
            '3': [
                {
                    name: 'Chris_Walker',
                    location: 'Denver, USA',
                    avatar: 'https://i.pravatar.cc/150?img=6',
                    rating: 5,
                    date: 'Oct 2025',
                    title: 'Perfect day trip from Tashkent!',
                    text: 'Amazing escape from the city! The mountains were beautiful, the cable car ride was thrilling, and lunch was delicious. Our guide was friendly and made sure everyone was safe and having fun. Great value for money!',
                    helpful: 9
                },
                {
                    name: 'Anna_Kowalski',
                    location: 'Warsaw, Poland',
                    avatar: 'https://i.pravatar.cc/150?img=4',
                    rating: 5,
                    date: 'Sep 2025',
                    title: 'Beautiful nature!',
                    text: 'Loved every minute! The scenery was breathtaking and the fresh mountain air was wonderful. Travel Bliss picked us up right on time and everything went smoothly. Highly recommend if you want to see Uzbekistan\'s natural beauty.',
                    helpful: 11
                },
                {
                    name: 'Mohammed_Ali',
                    location: 'Dubai, UAE',
                    avatar: 'https://i.pravatar.cc/150?img=16',
                    rating: 4,
                    date: 'Aug 2025',
                    title: 'Nice day out',
                    text: 'Good day trip with nice views. The cable car and ski resort area were interesting. Guide was helpful. Would have liked a bit more time at the top but overall a pleasant experience.',
                    helpful: 5
                }
            ],
            // Tour 4: Grand Uzbekistan Tour reviews
            '4': [
                {
                    name: 'Patricia_Johnson',
                    location: 'Chicago, USA',
                    avatar: 'https://i.pravatar.cc/150?img=18',
                    rating: 5,
                    date: 'Nov 2025',
                    title: 'Trip of a lifetime!',
                    text: 'This 10-day tour covered everything! Tashkent, Samarkand, Bukhara, Khiva - each city was unique and fascinating. Travel Bliss took care of every detail. The high-speed train was a highlight. Our guide became like family. Cannot recommend enough!',
                    helpful: 22
                },
                {
                    name: 'Marco_Rossi',
                    location: 'Rome, Italy',
                    avatar: 'https://i.pravatar.cc/150?img=17',
                    rating: 5,
                    date: 'Oct 2025',
                    title: 'Comprehensive and well-paced',
                    text: 'As someone who has traveled extensively, this was one of the best organized tours I\'ve experienced. Perfect balance of guided tours and free time. Hotels were excellent, food was amazing, and the itinerary covered all the major sites without feeling rushed.',
                    helpful: 16
                },
                {
                    name: 'Yuki_Tanaka',
                    location: 'Tokyo, Japan',
                    avatar: 'https://i.pravatar.cc/150?img=19',
                    rating: 5,
                    date: 'Sep 2025',
                    title: 'Amazing Silk Road adventure',
                    text: 'Every day brought new wonders! The architecture, the markets, the people - everything was incredible. Travel Bliss guides were knowledgeable and patient with all our questions. The traditional dinners were delicious. Worth every moment!',
                    helpful: 13
                }
            ],
            // Default reviews for new tours (general Travel Bliss reviews)
            'default': [
                {
                    name: 'Jennifer_M',
                    location: 'New York, USA',
                    avatar: 'https://i.pravatar.cc/150?img=1',
                    rating: 5,
                    date: 'Nov 2025',
                    title: 'Unforgettable journey through Uzbekistan!',
                    text: 'Travel Bliss made our trip to Uzbekistan absolutely magical. Our guide was incredibly knowledgeable about the history and culture. The organization was flawless, hotels were beautiful, and the experiences were once in a lifetime. Highly recommend!',
                    helpful: 12
                },
                {
                    name: 'David_Thompson',
                    location: 'London, UK',
                    avatar: 'https://i.pravatar.cc/150?img=12',
                    rating: 5,
                    date: 'Oct 2025',
                    title: 'Best tour company we\'ve used!',
                    text: 'We\'ve traveled extensively but Travel Bliss exceeded all our expectations. The attention to detail, the genuine care for their guests, and the expertly crafted itinerary made this our best vacation ever. The Silk Road came alive through their tours.',
                    helpful: 8
                },
                {
                    name: 'Sarah_Martinez',
                    location: 'Barcelona, Spain',
                    avatar: 'https://i.pravatar.cc/150?img=5',
                    rating: 5,
                    date: 'Oct 2025',
                    title: 'Exceptional service and stunning destinations',
                    text: 'From the moment we arrived, everything was perfectly arranged. The historical sites were breathtaking, the local food experiences were amazing, and our guide was both professional and friendly. Travel Bliss really knows how to create memorable experiences.',
                    helpful: 15
                }
            ]
        };

            // Get reviews for current tour, or use default reviews
            const reviews = allReviews[tour.id] || allReviews['default'];

            if (!container) {
                console.error('Review cards container not found');
                return;
            }

            container.innerHTML = reviews.map(review => {
                // Generate star rating SVGs (TripAdvisor green color)
                const fullStars = Math.floor(review.rating);
                const hasHalfStar = review.rating % 1 !== 0;

                const starsSVG = Array.from({length: 5}).map((_, i) => {
                    if (i < fullStars) {
                        return `<svg width="16" height="16" viewBox="0 0 14 14" fill="#00AA6C" xmlns="http://www.w3.org/2000/svg" style="display: inline-block; margin-right: 2px;">
                            <path d="M7 0L8.5716 4.83688H13.6574L9.5429 7.82624L11.1145 12.6631L7 9.67376L2.8855 12.6631L4.4571 7.82624L0.342604 4.83688H5.4284L7 0Z"/>
                        </svg>`;
                    } else if (i === fullStars && hasHalfStar) {
                        return `<svg width="16" height="16" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg" style="display: inline-block; margin-right: 2px;">
                            <defs>
                                <linearGradient id="half-grad-review-${i}">
                                    <stop offset="50%" stop-color="#00AA6C"/>
                                    <stop offset="50%" stop-color="#E0E0E0"/>
                                </linearGradient>
                            </defs>
                            <path d="M7 0L8.5716 4.83688H13.6574L9.5429 7.82624L11.1145 12.6631L7 9.67376L2.8855 12.6631L4.4571 7.82624L0.342604 4.83688H5.4284L7 0Z" fill="url(#half-grad-review-${i})"/>
                        </svg>`;
                    } else {
                        return `<svg width="16" height="16" viewBox="0 0 14 14" fill="#E0E0E0" xmlns="http://www.w3.org/2000/svg" style="display: inline-block; margin-right: 2px;">
                            <path d="M7 0L8.5716 4.83688H13.6574L9.5429 7.82624L11.1145 12.6631L7 9.67376L2.8855 12.6631L4.4571 7.82624L0.342604 4.83688H5.4284L7 0Z"/>
                        </svg>`;
                    }
                }).join('');

                return `
                    <div style="background: white; border-radius: 12px; padding: 24px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); transition: all 0.3s;"
                         onmouseover="this.style.boxShadow='0 4px 16px rgba(0,0,0,0.12)'"
                         onmouseout="this.style.boxShadow='0 2px 8px rgba(0,0,0,0.08)'">
                        <div style="display: flex; gap: 16px; margin-bottom: 16px;">
                            <img src="${review.avatar}"
                                 alt="${review.name}"
                                 style="width: 48px; height: 48px; border-radius: 50%; object-fit: cover; flex-shrink: 0;">
                            <div style="flex: 1;">
                                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 4px;">
                                    <h5 style="margin: 0; font-size: 16px; font-weight: 700; color: #333;">${review.name}</h5>
                                    <span style="color: #999; font-size: 13px;">${review.date}</span>
                                </div>
                                <div style="color: #666; font-size: 13px; margin-bottom: 8px;">${review.location}</div>
                                <div style="display: flex; align-items: center; gap: 4px;">
                                    ${starsSVG}
                                </div>
                            </div>
                        </div>

                        <h6 style="font-size: 16px; font-weight: 600; color: #333; margin-bottom: 12px;">${review.title}</h6>
                        <p style="color: #666; line-height: 1.6; margin-bottom: 16px; font-size: 14px;">${review.text}</p>

                        <div style="display: flex; align-items: center; gap: 6px; padding-top: 12px; border-top: 1px solid #f0f0f0;">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#666" stroke-width="2" xmlns="http://www.w3.org/2000/svg">
                                <path d="M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"/>
                            </svg>
                            <span style="color: #666; font-size: 13px;">Helpful (${review.helpful})</span>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function loadFAQ(tour) {
            const container = document.getElementById('faqAccordion');
            const faqs = [
                {
                    question: 'What is your cancellation policy?',
                    answer: 'We offer free cancellation up to 24 hours before the tour starts. For cancellations made less than 24 hours before departure, a 50% fee applies.'
                },
                {
                    question: 'Are meals included in the tour?',
                    answer: 'Daily breakfast is included at your hotel. Some lunches and dinners are included as specified in the itinerary. All included meals are clearly marked in the day-by-day breakdown.'
                },
                {
                    question: 'What should I bring?',
                    answer: 'Comfortable walking shoes, sunscreen, hat, camera, and appropriate clothing for the season. A detailed packing list will be sent after booking.'
                },
                {
                    question: 'Is travel insurance required?',
                    answer: 'While not mandatory, we strongly recommend travel insurance to cover unexpected events, medical emergencies, and trip cancellations.'
                },
                {
                    question: 'Can dietary requirements be accommodated?',
                    answer: 'Yes! Please inform us of any dietary restrictions or allergies at the time of booking, and we will make the necessary arrangements.'
                }
            ];

            container.innerHTML = faqs.map((faq, index) => `
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button ${index === 0 ? '' : 'collapsed'}" type="button" data-bs-toggle="collapse" data-bs-target="#faq${index}">
                            ${faq.question}
                        </button>
                    </h2>
                    <div id="faq${index}" class="accordion-collapse collapse ${index === 0 ? 'show' : ''}" data-bs-parent="#faqAccordion">
                        <div class="accordion-body">
                            ${faq.answer}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Smooth scroll for navigation tabs
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', () => {
                setTimeout(() => {
                    window.scrollTo({
                        top: document.querySelector('.content-wrapper').offsetTop - 100,
                        behavior: 'smooth'
                    });
                }, 100);
            });
        });

        // Set minimum date for check-in
        const today = new Date().toISOString().split('T')[0];
        document.getElementById('checkInDate').setAttribute('min', today);
        document.getElementById('checkInDate').value = today;

        // Set minimum date for check-in (today)
        function setMinDate() {
            const dateInput = document.getElementById('checkInDate');
            if (dateInput) {
                const today = new Date();
                const tomorrow = new Date(today);
                tomorrow.setDate(tomorrow.getDate() + 1);
                const minDate = tomorrow.toISOString().split('T')[0];
                dateInput.min = minDate;
                dateInput.value = minDate; // Set default to tomorrow
            }
        }

        // Load data when page loads
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => {
                setMinDate();
                loadTourData();
            });
        } else {
            setMinDate();
            loadTourData();
        }

        // Handle anchor navigation to reviews section
        window.addEventListener('load', function() {
            console.log('Page loaded, checking hash:', window.location.hash);
            if (window.location.hash === '#reviews') {
                console.log('Reviews hash detected, will navigate to reviews tab');
                // Wait a bit for the page to fully load
                setTimeout(() => {
                    // Find the reviews tab button (it's a button, not an anchor!)
                    const reviewsTabBtn = document.getElementById('reviews-tab');
                    console.log('Found reviews tab button:', reviewsTabBtn);

                    if (reviewsTabBtn) {
                        // Click the tab to activate it
                        console.log('Clicking reviews tab button');
                        reviewsTabBtn.click();

                        // Wait for tab content to load, then scroll
                        setTimeout(() => {
                            // Find the tab navigation container
                            const tabNav = document.getElementById('tourTabs');
                            console.log('Found tab navigation:', tabNav);

                            if (tabNav) {
                                // Scroll to tab navigation with some space above
                                const yOffset = -20;
                                const y = tabNav.getBoundingClientRect().top + window.pageYOffset + yOffset;
                                console.log('Scrolling to tab navigation at position:', y);
                                window.scrollTo({ top: y, behavior: 'smooth' });
                            }
                        }, 600);
                    }
                }, 500);
            }
        });

        // PDF Download Functionality
        function initPDFDownload() {
            const pdfBtn = document.getElementById('downloadPdfBtn');
            if (!pdfBtn) return;

            pdfBtn.addEventListener('click', async function() {
            const button = this;
            const originalText = button.innerHTML;

            // Show loading state
            button.innerHTML = '<i class="bi bi-hourglass-split"></i><span>Generating PDF (with images)...</span>';
            button.disabled = true;

            try {
                // Check if tour data is loaded
                if (!currentTour) {
                    throw new Error('Tour data not loaded yet. Please wait...');
                }

                // Generate and download PDF
                await generatePDF(currentTour);

                // Success state
                button.innerHTML = '<i class="bi bi-check-circle"></i><span>Downloaded!</span>';
                setTimeout(() => {
                    button.innerHTML = originalText;
                    button.disabled = false;
                }, 2000);
            } catch (error) {
                console.error('PDF generation error:', error);
                button.innerHTML = '<i class="bi bi-x-circle"></i><span>Error</span>';
                setTimeout(() => {
                    button.innerHTML = originalText;
                    button.disabled = false;
                }, 2000);
            }
            });
        }

        async function generatePDF(tour) {
            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF();

            // Helper function to load image and convert to data URL
            async function loadImage(url) {
                try {
                    const response = await fetch(url);
                    const blob = await response.blob();
                    return new Promise((resolve, reject) => {
                        const reader = new FileReader();
                        reader.onloadend = () => resolve(reader.result);
                        reader.onerror = reject;
                        reader.readAsDataURL(blob);
                    });
                } catch (error) {
                    console.error('Failed to load image:', url, error);
                    return null;
                }
            }

            let yPos = 20;
            const pageWidth = pdf.internal.pageSize.getWidth();
            const pageHeight = pdf.internal.pageSize.getHeight();
            const margin = 20;
            const maxWidth = pageWidth - 2 * margin;

            // Helper function to add new page if needed
            function checkPageBreak(height = 10) {
                if (yPos + height > pageHeight - 20) {
                    pdf.addPage();
                    yPos = 20;
                    return true;
                }
                return false;
            }

            // Header with white background
            pdf.setFillColor(255, 255, 255);
            pdf.rect(0, 0, pageWidth, 50, 'F');

            // Blue accent line at top
            pdf.setFillColor(99, 102, 241);
            pdf.rect(0, 0, pageWidth, 3, 'F');

            // Try to load and add logo
            try {
                const logoUrl = '/assets/img/logo.png';
                const logoImg = await loadImage(logoUrl);
                if (logoImg) {
                    // Add logo image on the left (optimal size - not stretched)
                    pdf.addImage(logoImg, 'PNG', 15, 10, 30, 30);
                } else {
                    throw new Error('Logo not found');
                }
            } catch (error) {
                // Fallback: Draw TB logo (optimal size)
                // Blue circle background
                pdf.setFillColor(99, 102, 241);
                pdf.circle(30, 25, 15, 'F');

                pdf.setFontSize(22);
                pdf.setFont('helvetica', 'bold');
                pdf.setTextColor(255, 255, 255);
                pdf.text('TB', 21, 29);
            }

            // Tour Title - Center
            pdf.setFontSize(18);
            pdf.setFont('helvetica', 'bold');
            pdf.setTextColor(30, 30, 30);
            const titleLines = pdf.splitTextToSize(tour.title || 'Tour Package', pageWidth - 100);
            const titleY = titleLines.length > 1 ? 18 : 22;
            pdf.text(titleLines, pageWidth / 2, titleY, { align: 'center' });

            // Tagline
            pdf.setFontSize(9);
            pdf.setFont('helvetica', 'italic');
            pdf.setTextColor(99, 102, 241);
            const taglineY = titleLines.length > 1 ? 30 : 32;
            pdf.text('Your Journey, Our Passion', pageWidth / 2, taglineY, { align: 'center' });

            // Date below tagline
            pdf.setFontSize(8);
            pdf.setFont('helvetica', 'normal');
            pdf.setTextColor(120, 120, 120);
            const dateY = titleLines.length > 1 ? 38 : 40;
            pdf.text(new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' }), pageWidth / 2, dateY, { align: 'center' });

            // Price box on the right
            if (tour.price) {
                const priceBoxX = pageWidth - 45;
                const priceBoxY = 15;
                const priceBoxWidth = 35;
                const priceBoxHeight = 25;

                // Light blue background box
                pdf.setFillColor(240, 242, 255);
                pdf.roundedRect(priceBoxX, priceBoxY, priceBoxWidth, priceBoxHeight, 3, 3, 'F');

                // Border
                pdf.setDrawColor(99, 102, 241);
                pdf.setLineWidth(0.5);
                pdf.roundedRect(priceBoxX, priceBoxY, priceBoxWidth, priceBoxHeight, 3, 3, 'S');

                // Price
                pdf.setFontSize(18);
                pdf.setFont('helvetica', 'bold');
                pdf.setTextColor(99, 102, 241);
                const priceText = tour.discountPrice ? `$${tour.discountPrice}` : `$${tour.price}`;
                pdf.text(priceText, priceBoxX + priceBoxWidth / 2, priceBoxY + 12, { align: 'center' });

                // "per person" text
                pdf.setFontSize(7);
                pdf.setFont('helvetica', 'normal');
                pdf.setTextColor(80, 80, 80);
                pdf.text('per person', priceBoxX + priceBoxWidth / 2, priceBoxY + 19, { align: 'center' });

                // Old price if discount exists
                if (tour.discountPrice) {
                    pdf.setFontSize(9);
                    pdf.setTextColor(150, 150, 150);
                    pdf.setFont('helvetica', 'normal');
                    // Strikethrough
                    pdf.text(`$${tour.price}`, priceBoxX + priceBoxWidth / 2, priceBoxY + 26, { align: 'center' });
                    pdf.setDrawColor(150, 150, 150);
                    pdf.setLineWidth(0.3);
                    const oldPriceWidth = pdf.getTextWidth(`$${tour.price}`);
                    pdf.line(priceBoxX + (priceBoxWidth - oldPriceWidth) / 2, priceBoxY + 24,
                             priceBoxX + (priceBoxWidth + oldPriceWidth) / 2, priceBoxY + 24);
                }
            }

            // Bottom border line
            pdf.setDrawColor(220, 220, 220);
            pdf.setLineWidth(0.5);
            pdf.line(0, 50, pageWidth, 50);

            yPos = 60;
            pdf.setTextColor(0, 0, 0);

            // Tour Overview
            pdf.setFontSize(14);
            pdf.setFont('helvetica', 'bold');
            pdf.setTextColor(99, 102, 241);
            pdf.text('Tour Overview', margin, yPos);
            yPos += 8;

            pdf.setFontSize(10);
            pdf.setFont('helvetica', 'normal');
            pdf.setTextColor(0, 0, 0);

            const description = tour.description || 'No description available';
            const descLines = pdf.splitTextToSize(description, maxWidth);
            pdf.text(descLines, margin, yPos);
            yPos += descLines.length * 5 + 10;

            checkPageBreak();

            // Tour Details Box
            pdf.setFillColor(250, 250, 250);
            pdf.rect(margin, yPos, maxWidth, 35, 'F');
            pdf.setDrawColor(99, 102, 241);
            pdf.rect(margin, yPos, maxWidth, 35, 'S');

            yPos += 8;
            pdf.setFontSize(10);
            pdf.text(`Duration: ${tour.duration} Days / ${tour.nights || 0} Nights`, margin + 5, yPos);
            yPos += 6;
            pdf.text(`Price: $${tour.price} per person`, margin + 5, yPos);
            yPos += 6;
            pdf.text(`Difficulty: ${tour.difficulty || 'Moderate'}`, margin + 5, yPos);
            yPos += 6;
            pdf.text(`Max Group: ${tour.maxGroupSize || 15} people`, margin + 5, yPos);
            yPos += 6;
            const langs = Array.isArray(tour.languages) ? tour.languages.join(', ') : (tour.languages || 'English');
            pdf.text(`Languages: ${langs}`, margin + 5, yPos);
            yPos += 15;

            // Daily Itinerary
            if (tour.itinerary && tour.itinerary.length > 0) {
                checkPageBreak(15);

                pdf.setFontSize(14);
                pdf.setFont('helvetica', 'bold');
                pdf.setTextColor(99, 102, 241);
                pdf.text('Daily Itinerary', margin, yPos);
                yPos += 10;

                for (const day of tour.itinerary) {
                    checkPageBreak(20);

                    // Day header
                    pdf.setFillColor(99, 102, 241);
                    pdf.circle(margin + 5, yPos - 2, 4, 'F');
                    pdf.setFontSize(11);
                    pdf.setFont('helvetica', 'bold');
                    pdf.setTextColor(0, 0, 0);
                    pdf.text(`Day ${day.day}: ${day.title}`, margin + 12, yPos);
                    yPos += 7;

                    // Add day image or image placeholder (ALWAYS show for each day)
                    checkPageBreak(50);

                    const imgWidth = maxWidth - 12;
                    const imgHeight = 50;

                    // Try to load image
                    let imageLoaded = false;
                    if (day.image) {
                        try {
                            console.log(`Trying to load image for Day ${day.day}:`, day.image);
                            const imageData = await loadImage(day.image);
                            if (imageData) {
                                pdf.setDrawColor(99, 102, 241);
                                pdf.setLineWidth(0.5);
                                pdf.rect(margin + 12, yPos, imgWidth, imgHeight);
                                pdf.addImage(imageData, 'JPEG', margin + 12, yPos, imgWidth, imgHeight);
                                imageLoaded = true;
                                console.log(`✓ Image loaded for Day ${day.day}`);
                            }
                        } catch (error) {
                            console.log(`✗ Could not load image for Day ${day.day}:`, error);
                        }
                    }

                    // If image not loaded, show styled placeholder
                    if (!imageLoaded) {
                        // Gradient background
                        pdf.setFillColor(240, 242, 255);
                        pdf.rect(margin + 12, yPos, imgWidth, imgHeight, 'F');

                        // Border
                        pdf.setDrawColor(99, 102, 241);
                        pdf.setLineWidth(0.5);
                        pdf.rect(margin + 12, yPos, imgWidth, imgHeight);

                        // Draw camera icon using shapes (larger size)
                        const centerX = margin + 12 + imgWidth / 2;
                        const centerY = yPos + imgHeight / 2 - 8;

                        // Camera body (larger)
                        pdf.setFillColor(99, 102, 241);
                        pdf.roundedRect(centerX - 12, centerY, 24, 16, 2, 2, 'F');

                        // Camera lens (larger)
                        pdf.setFillColor(255, 255, 255);
                        pdf.circle(centerX, centerY + 8, 6, 'F');

                        // Camera lens inner circle
                        pdf.setFillColor(200, 200, 255);
                        pdf.circle(centerX, centerY + 8, 4, 'F');

                        // Camera top (larger)
                        pdf.setFillColor(99, 102, 241);
                        pdf.rect(centerX - 6, centerY - 4, 12, 4, 'F');

                        // Camera viewfinder
                        pdf.setFillColor(150, 150, 200);
                        pdf.rect(centerX - 2, centerY - 3, 4, 2, 'F');

                        // Text below camera
                        pdf.setFontSize(10);
                        pdf.setFont('helvetica', 'bold');
                        pdf.setTextColor(99, 102, 241);
                        if (day.imageCaption) {
                            const captionLines = pdf.splitTextToSize(day.imageCaption, imgWidth - 10);
                            pdf.text(captionLines, centerX, centerY + 22, { align: 'center' });
                        } else {
                            pdf.text(`Day ${day.day} Photo`, centerX, centerY + 22, { align: 'center' });
                        }
                    }

                    yPos += imgHeight + 5;

                    // Day description
                    pdf.setFontSize(9);
                    pdf.setFont('helvetica', 'normal');
                    pdf.setTextColor(60, 60, 60);
                    const dayDescLines = pdf.splitTextToSize(day.description, maxWidth - 12);
                    pdf.text(dayDescLines, margin + 12, yPos);
                    yPos += dayDescLines.length * 4 + 3;

                    // City and accommodation info
                    if (day.city || day.accommodation || day.meals) {
                        checkPageBreak(10);
                        pdf.setFillColor(248, 249, 250);
                        pdf.rect(margin + 12, yPos - 3, maxWidth - 12, 10, 'F');
                        pdf.setDrawColor(99, 102, 241);
                        pdf.rect(margin + 12, yPos - 3, maxWidth - 12, 10, 'S');

                        pdf.setFontSize(8);
                        pdf.setFont('helvetica', 'normal');
                        pdf.setTextColor(60, 60, 60);

                        let xOffset = margin + 15;

                        if (day.city) {
                            pdf.setFont('helvetica', 'bold');
                            pdf.text('Location:', xOffset, yPos + 2);
                            pdf.setFont('helvetica', 'normal');
                            pdf.text(day.city, xOffset + 18, yPos + 2);
                            xOffset += 45;
                        }

                        if (day.accommodation) {
                            pdf.setFont('helvetica', 'bold');
                            pdf.text('Hotel:', xOffset, yPos + 2);
                            pdf.setFont('helvetica', 'normal');
                            pdf.text(day.accommodation, xOffset + 12, yPos + 2);
                        }

                        if (day.meals) {
                            const mealText = day.meals === 'BB' ? 'B&B' :
                                           day.meals === 'HB' ? 'Half Board' :
                                           day.meals === 'FB' ? 'Full Board' :
                                           day.meals === 'AI' ? 'All-Inclusive' : day.meals;
                            pdf.setFont('helvetica', 'bold');
                            pdf.text('Meals:', xOffset, yPos + 6);
                            pdf.setFont('helvetica', 'normal');
                            pdf.text(mealText, xOffset + 12, yPos + 6);
                        }

                        yPos += 12;
                    }

                    // Activities
                    if (day.activities && day.activities.length > 0) {
                        checkPageBreak(10);
                        pdf.setFontSize(9);
                        pdf.setFont('helvetica', 'italic');
                        pdf.text('Activities:', margin + 12, yPos);
                        yPos += 5;

                        day.activities.forEach(activity => {
                            checkPageBreak(5);
                            pdf.setFont('helvetica', 'normal');
                            pdf.text('•', margin + 14, yPos);
                            const activityLines = pdf.splitTextToSize(activity, maxWidth - 20);
                            pdf.text(activityLines, margin + 18, yPos);
                            yPos += activityLines.length * 4 + 1;
                        });
                    }
                    yPos += 8;
                }
            }

            // What's Included
            if (tour.included && tour.included.length > 0) {
                checkPageBreak(15);

                pdf.setFontSize(14);
                pdf.setFont('helvetica', 'bold');
                pdf.setTextColor(99, 102, 241);
                pdf.text("What's Included", margin, yPos);
                yPos += 8;

                pdf.setFontSize(9);
                pdf.setFont('helvetica', 'normal');
                pdf.setTextColor(0, 0, 0);

                tour.included.forEach(item => {
                    checkPageBreak(5);

                    // Draw green checkmark (no circle, just checkmark)
                    pdf.setDrawColor(34, 197, 94);
                    pdf.setLineWidth(0.6);
                    pdf.line(margin + 2, yPos - 1, margin + 3, yPos + 0.3);
                    pdf.line(margin + 3, yPos + 0.3, margin + 5, yPos - 1.8);

                    pdf.setTextColor(0, 0, 0);
                    const itemLines = pdf.splitTextToSize(item, maxWidth - 10);
                    pdf.text(itemLines, margin + 8, yPos);
                    yPos += itemLines.length * 4 + 2;
                });
                yPos += 5;
            }

            // What's Not Included
            if (tour.excluded && tour.excluded.length > 0) {
                checkPageBreak(15);

                pdf.setFontSize(14);
                pdf.setFont('helvetica', 'bold');
                pdf.setTextColor(99, 102, 241);
                pdf.text("What's Not Included", margin, yPos);
                yPos += 8;

                pdf.setFontSize(9);
                pdf.setFont('helvetica', 'normal');

                tour.excluded.forEach(item => {
                    checkPageBreak(5);

                    // Draw red X (no circle, just X)
                    pdf.setDrawColor(239, 68, 68);
                    pdf.setLineWidth(0.6);
                    pdf.line(margin + 2, yPos - 2, margin + 4.5, yPos + 0.5);
                    pdf.line(margin + 2, yPos + 0.5, margin + 4.5, yPos - 2);

                    pdf.setTextColor(0, 0, 0);
                    const itemLines = pdf.splitTextToSize(item, maxWidth - 10);
                    pdf.text(itemLines, margin + 8, yPos);
                    yPos += itemLines.length * 4 + 2;
                });
                yPos += 5;
            }

            // Footer on last page
            const finalPageHeight = pdf.internal.pageSize.getHeight();
            pdf.setFillColor(99, 102, 241);
            pdf.rect(0, finalPageHeight - 35, pageWidth, 35, 'F');

            pdf.setTextColor(255, 255, 255);
            pdf.setFontSize(12);
            pdf.setFont('helvetica', 'bold');
            pdf.text('Contact Us', pageWidth / 2, finalPageHeight - 25, { align: 'center' });

            pdf.setFontSize(9);
            pdf.setFont('helvetica', 'normal');
            pdf.text('Travel Bliss Tourism Agency of Uzbekistan', pageWidth / 2, finalPageHeight - 18, { align: 'center' });
            pdf.text('Phone: +998 93 224 43 33  |  Email: info@travel-bliss.uz', pageWidth / 2, finalPageHeight - 13, { align: 'center' });
            pdf.text('Web: travel-bliss.uz', pageWidth / 2, finalPageHeight - 8, { align: 'center' });

            // Save PDF
            const filename = `${tour.title.replace(/\s+/g, '-')}-Itinerary.pdf`;
            pdf.save(filename);
        }

        // Initialize PDF download after DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initPDFDownload);
        } else {
            initPDFDownload();
        }

        // Booking functionality
        // currentTour is already declared above, no need to redeclare

        // Handle check availability button click
        function handleCheckAvailability() {
            if (!currentTour) {
                alert('Tour ma\'lumotlari yuklanmoqda. Iltimos, kuting...');
                return;
            }

            const tourId = currentTour.id || currentTour._id;
            const tourName = currentTour.title;
            const pricePerPerson = currentTour.price || 0;

            openBookingModal(tourId, tourName, pricePerPerson);
        }

        // Store tour data when loaded
        const originalDisplayTourData = window.displayTourData || function() {};
        window.displayTourData = function(tour) {
            currentTour = tour;
            if (originalDisplayTourData) {
                originalDisplayTourData(tour);
            }
        };
    </script>

    <!-- Include Booking Widget -->
    <script src="booking-widget.js"></script>
    <link rel="stylesheet" href="booking-widget.css">

</body>
</html>
